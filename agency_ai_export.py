#!/usr/bin/env python3
"""
Agency AI â€” Single-file export. Copy anywhere and run.
  python agency_ai_export.py              -> start Streamlit dashboard
  python agency_ai_export.py extract      -> extract to ./agency_ai_extracted/
  python agency_ai_export.py --init-db
  python agency_ai_export.py ctc --city "Phoenix AZ"
"""
import base64
import os
import subprocess
import sys
from pathlib import Path

BUNDLE = {
    "config.py": 'IiIiClNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIGNvbmZpZ3VyYXRpb24uCkV2ZXJ5dGhpbmcgaW1wb3J0cyBmcm9tIGhlcmUuIE5vIGhhcmRjb2RlZCBrZXlzLgoiIiIKCmltcG9ydCBvcwpmcm9tIHBhdGhsaWIgaW1wb3J0IFBhdGgKCmZyb20gZG90ZW52IGltcG9ydCBsb2FkX2RvdGVudgoKbG9hZF9kb3RlbnYoKQoKIyDilIDilIDilIAgUmVxdWlyZWQgQVBJIGtleXMgKGZhaWwgbG91ZGx5IGlmIG1pc3NpbmcpIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgApSRVFVSVJFRF9LRVlTID0gWyJUQVZJTFlfQVBJX0tFWSIsICJGSVJFQ1JBV0xfQVBJX0tFWSIsICJBTlRIUk9QSUNfQVBJX0tFWSJdCgoKZGVmIF92YWxpZGF0ZV9yZXF1aXJlZCgpOgogICAgZm9yIGtleSBpbiBSRVFVSVJFRF9LRVlTOgogICAgICAgIHZhbCA9IG9zLmdldGVudihrZXksICIiKS5zdHJpcCgpCiAgICAgICAgaWYgbm90IHZhbDoKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKAogICAgICAgICAgICAgICAgZiJNaXNzaW5nIHJlcXVpcmVkIGNvbmZpZzoge2tleX0uIFNldCBpdCBpbiAuZW52LiBTZWUgLmVudi5leGFtcGxlLiIKICAgICAgICAgICAgKQoKCiMgVmFsaWRhdGUgb24gaW1wb3J0IOKAlCBmYWlsIGxvdWRseQpfdmFsaWRhdGVfcmVxdWlyZWQoKQoKVEFWSUxZX0FQSV9LRVkgPSBvcy5nZXRlbnYoIlRBVklMWV9BUElfS0VZIiwgIiIpLnN0cmlwKCkKRklSRUNSQVdMX0FQSV9LRVkgPSBvcy5nZXRlbnYoIkZJUkVDUkFXTF9BUElfS0VZIiwgIiIpLnN0cmlwKCkKQU5USFJPUElDX0FQSV9LRVkgPSBvcy5nZXRlbnYoIkFOVEhST1BJQ19BUElfS0VZIiwgIiIpLnN0cmlwKCkKCiMg4pSA4pSA4pSAIE9wdGlvbmFsIC8gd2l0aCBkZWZhdWx0cyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKREFUQUJBU0VfVVJMID0gb3MuZ2V0ZW52KCJEQVRBQkFTRV9VUkwiLCAic3FsaXRlOi8vLy4vYWdlbmN5X2FpLmRiIikKCk9MTEFNQV9NT0RFTCA9IG9zLmdldGVudigiT0xMQU1BX01PREVMIiwgImxsYW1hMy4xOjhiIikKT0xMQU1BX1VSTCA9IG9zLmdldGVudigiT0xMQU1BX1VSTCIsICJodHRwOi8vbG9jYWxob3N0OjExNDM0IikKREVGQVVMVF9OSUNIRSA9IG9zLmdldGVudigiREVGQVVMVF9OSUNIRSIsICJKdW5rIFJlbW92YWwiKQpTRUFSQ0hfUkVTVUxUU19MSU1JVCA9IGludChvcy5nZXRlbnYoIlNFQVJDSF9SRVNVTFRTX0xJTUlUIiwgIjUiKSkKCkFOVEhST1BJQ19NT0RFTCA9IG9zLmdldGVudigiQU5USFJPUElDX01PREVMIiwgImNsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyIikKQU5USFJPUElDX1VSTCA9ICJodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzIgpNSU5fQ09ORklERU5DRV9GT1JfU1RSQVRFR0lTVCA9IGludChvcy5nZXRlbnYoIk1JTl9DT05GSURFTkNFX0ZPUl9TVFJBVEVHSVNUIiwgIjUwIikpCgojIOKUgOKUgOKUgCBQcm9qZWN0IHBhdGhzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgApQUk9KRUNUX1JPT1QgPSBQYXRoKF9fZmlsZV9fKS5yZXNvbHZlKCkucGFyZW50CkxPR1NfRElSID0gUFJPSkVDVF9ST09UIC8gImxvZ3MiCkxPR1NfRElSLm1rZGlyKGV4aXN0X29rPVRydWUpCgpSRVNFQVJDSEVSX0xPRyA9IHN0cihMT0dTX0RJUiAvICJyZXNlYXJjaGVyLmxvZyIpClNUUkFURUdJU1RfTE9HID0gc3RyKExPR1NfRElSIC8gInN0cmF0ZWdpc3QubG9nIikKT1BQT1JUVU5JVFlfTE9HID0gc3RyKExPR1NfRElSIC8gIm9wcG9ydHVuaXR5X3Njb3Jlci5sb2ciKQpLRVlXT1JEX0NMQVNTSUZJRVJfTE9HID0gc3RyKExPR1NfRElSIC8gImtleXdvcmRfY2xhc3NpZmllci5sb2ciKQoKIyDilIDilIDilIAgQ29zdCArIExhdGVuY3kgR3VhcmRzIChub24tbmVnb3RpYWJsZSkg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAClRBVklMWV9NQVhfUkVTVUxUUyA9IDUKVEFWSUxZX1NFQVJDSF9ERVBUSCA9ICJiYXNpYyIKVEFWSUxZX1JFVklFV1NfTUFYX1JFU1VMVFMgPSAyCkZJUkVDUkFXTF9USU1FT1VUID0gMzAKT0xMQU1BX1RJTUVPVVQgPSA0NQpPTExBTUFfU1RSRUFNID0gRmFsc2UKU0xFRVBfQkVUV0VFTl9DT01QRVRJVE9SUyA9IDIK',
    "database.py": 'IiIiClNRTEFsY2hlbXkgbW9kZWxzIGFuZCBpbml0LgpEYXRhYmFzZSBpcyB0aGUgZ2x1ZSDigJQgYWdlbnRzIHJlYWQvd3JpdGUgaGVyZSwgbmV2ZXIgdGFsayB0byBlYWNoIG90aGVyLgoiIiIKCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmZyb20gdHlwaW5nIGltcG9ydCBPcHRpb25hbAoKZnJvbSBzcWxhbGNoZW15IGltcG9ydCBKU09OLCBDb2x1bW4sIERhdGVUaW1lLCBGb3JlaWduS2V5LCBJbnRlZ2VyLCBTdHJpbmcsIFRleHQsIFVuaXF1ZUNvbnN0cmFpbnQsIGNyZWF0ZV9lbmdpbmUKZnJvbSBzcWxhbGNoZW15Lm9ybSBpbXBvcnQgRGVjbGFyYXRpdmVCYXNlLCByZWxhdGlvbnNoaXAsIHNlc3Npb25tYWtlcgoKZnJvbSBjb25maWcgaW1wb3J0IERBVEFCQVNFX1VSTAoKCmNsYXNzIEJhc2UoRGVjbGFyYXRpdmVCYXNlKToKICAgIHBhc3MKCgpjbGFzcyBDbGllbnQoQmFzZSk6CiAgICAiIiJDbGllbnQgcHJvZmlsZSDigJQgZnJvbSBvbmJvYXJkaW5nLiBTaW5nbGUgc291cmNlIG9mIHRydXRoLiIiIgoKICAgIF9fdGFibGVuYW1lX18gPSAiY2xpZW50cyIKCiAgICBpZCA9IENvbHVtbihJbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlLCBhdXRvaW5jcmVtZW50PVRydWUpCiAgICBjbGllbnRfaWQgPSBDb2x1bW4oU3RyaW5nKDEwMCksIHVuaXF1ZT1UcnVlLCBudWxsYWJsZT1GYWxzZSwgaW5kZXg9VHJ1ZSkKICAgIGJ1c2luZXNzX25hbWUgPSBDb2x1bW4oU3RyaW5nKDI1NSksIG51bGxhYmxlPUZhbHNlKQogICAgd2Vic2l0ZV91cmwgPSBDb2x1bW4oU3RyaW5nKDUwMCkpCiAgICBnb29nbGVfYnVzaW5lc3NfcHJvZmlsZV91cmwgPSBDb2x1bW4oU3RyaW5nKDUwMCkpCiAgICBwaG9uZV9udW1iZXIgPSBDb2x1bW4oU3RyaW5nKDUwKSkKICAgIHNlcnZpY2VzX29mZmVyZWQgPSBDb2x1bW4oSlNPTiwgZGVmYXVsdD1saXN0KSAgIyBsaXN0W3N0cl0KICAgIGNpdGllc19zZXJ2ZWQgPSBDb2x1bW4oSlNPTiwgZGVmYXVsdD1saXN0KQogICAgemlwX2NvZGVzX3NlcnZlZCA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpCiAgICBpZGVhbF9jdXN0b21lcl90eXBlcyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpCiAgICBicmFuZF90b25lID0gQ29sdW1uKFN0cmluZyg1MCksIGRlZmF1bHQ9ImZyaWVuZGx5IikKICAgIGRpZmZlcmVudGlhdG9ycyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpCiAgICBzZWFzb25hbGl0eV9ub3RlcyA9IENvbHVtbihUZXh0KQogICAgYXNzZXRfbGlua3MgPSBDb2x1bW4oSlNPTiwgZGVmYXVsdD1kaWN0KQogICAgY3JlYXRlZF9hdCA9IENvbHVtbihEYXRlVGltZSwgZGVmYXVsdD1kYXRldGltZS51dGNub3cpCiAgICB1cGRhdGVkX2F0ID0gQ29sdW1uKERhdGVUaW1lLCBkZWZhdWx0PWRhdGV0aW1lLnV0Y25vdywgb251cGRhdGU9ZGF0ZXRpbWUudXRjbm93KQoKCmNsYXNzIFJlc2VhcmNoTG9nKEJhc2UpOgogICAgIiIiCiAgICBSYXcgcmVzZWFyY2ggZW50cmllcyBmcm9tIFJlc2VhcmNoZXIgYWdlbnQuCiAgICBIdW1hbiBjYW4gcmV2aWV3L292ZXJyaWRlIGJlZm9yZSBTdHJhdGVnaXN0IHJ1bnMuCiAgICAiIiIKCiAgICBfX3RhYmxlbmFtZV9fID0gInJlc2VhcmNoX2xvZ3MiCgogICAgaWQgPSBDb2x1bW4oSW50ZWdlciwgcHJpbWFyeV9rZXk9VHJ1ZSwgYXV0b2luY3JlbWVudD1UcnVlKQogICAgY2xpZW50X2lkID0gQ29sdW1uKFN0cmluZygxMDApLCBGb3JlaWduS2V5KCJjbGllbnRzLmNsaWVudF9pZCIpLCBudWxsYWJsZT1GYWxzZSwgaW5kZXg9VHJ1ZSkKICAgIGNvbXBldGl0b3JfbmFtZSA9IENvbHVtbihTdHJpbmcoMjU1KSwgbnVsbGFibGU9RmFsc2UpCiAgICBzb3VyY2VfdHlwZSA9IENvbHVtbihTdHJpbmcoNTApLCBudWxsYWJsZT1GYWxzZSkgICMgJ3dlYnNpdGUnIHwgJ3Jldmlld3MnCiAgICByYXdfdGV4dCA9IENvbHVtbihUZXh0LCBudWxsYWJsZT1GYWxzZSkKICAgIGV4dHJhY3RlZF9zZXJ2aWNlcyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpICAjIGxpc3Rbc3RyXQogICAgcHJpY2luZ19tZW50aW9ucyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpICAjIGxpc3Rbc3RyXQogICAgY29tcGxhaW50cyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpICAjIGxpc3Rbc3RyXQogICAgbWlzc2VkX29wcG9ydHVuaXRpZXMgPSBDb2x1bW4oSlNPTiwgZGVmYXVsdD1saXN0KSAgIyBsaXN0W3N0cl0KICAgIGNvbmZpZGVuY2Vfc2NvcmUgPSBDb2x1bW4oSW50ZWdlciwgZGVmYXVsdD0wKSAgIyAwLTEwMAogICAgY2l0eSA9IENvbHVtbihTdHJpbmcoMTAwKSkgICMgcmVzZWFyY2ggY29udGV4dAogICAgY3JlYXRlZF9hdCA9IENvbHVtbihEYXRlVGltZSwgZGVmYXVsdD1kYXRldGltZS51dGNub3cpCgoKY2xhc3MgTWFya2V0U25hcHNob3QoQmFzZSk6CiAgICAiIiIKICAgIEFnZ3JlZ2F0ZWQgcmVzZWFyY2gg4oCUIGJ1aWx0IGZyb20gcmVzZWFyY2hfbG9ncyBhZnRlciBodW1hbiByZXZpZXcuCiAgICBTdHJhdGVnaXN0IHJlYWRzIHRoaXM7IG5ldmVyIFJlc2VhcmNoTG9nIGRpcmVjdGx5IHVubGVzcyBjb25maWd1cmVkLgogICAgIiIiCgogICAgX190YWJsZW5hbWVfXyA9ICJtYXJrZXRfc25hcHNob3RzIgoKICAgIGlkID0gQ29sdW1uKEludGVnZXIsIHByaW1hcnlfa2V5PVRydWUsIGF1dG9pbmNyZW1lbnQ9VHJ1ZSkKICAgIGNsaWVudF9pZCA9IENvbHVtbihTdHJpbmcoMTAwKSwgRm9yZWlnbktleSgiY2xpZW50cy5jbGllbnRfaWQiKSwgbnVsbGFibGU9RmFsc2UsIGluZGV4PVRydWUpCiAgICBzbmFwc2hvdF9pZCA9IENvbHVtbihTdHJpbmcoMTAwKSwgdW5pcXVlPVRydWUsIG51bGxhYmxlPUZhbHNlLCBpbmRleD1UcnVlKQogICAgY2l0eSA9IENvbHVtbihTdHJpbmcoMTAwKSwgbnVsbGFibGU9RmFsc2UpCiAgICBwcmltYXJ5X3NlcnZpY2UgPSBDb2x1bW4oU3RyaW5nKDEwMCksIGRlZmF1bHQ9Imp1bmsgcmVtb3ZhbCIpCiAgICBzZWNvbmRhcnlfc2VydmljZXMgPSBDb2x1bW4oSlNPTiwgZGVmYXVsdD1saXN0KQogICAgcXVlcmllc19leGVjdXRlZCA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpCiAgICByZXN1bHRfc2V0cyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpCiAgICBzdHJvbmdfY29tcGV0aXRvcnMgPSBDb2x1bW4oSlNPTiwgZGVmYXVsdD1saXN0KQogICAgd2Vha19jb21wZXRpdG9ycyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpCiAgICBjb21tb25fbWVzc2FnaW5nX3RoZW1lcyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpCiAgICBjb250ZW50X2dhcHMgPSBDb2x1bW4oSlNPTiwgZGVmYXVsdD1saXN0KQogICAgc25hcHNob3RfZGF0ZSA9IENvbHVtbihTdHJpbmcoMjApKQogICAgY3JlYXRlZF9hdCA9IENvbHVtbihEYXRlVGltZSwgZGVmYXVsdD1kYXRldGltZS51dGNub3cpCgoKY2xhc3MgT3Bwb3J0dW5pdHlTY29yZShCYXNlKToKICAgICIiIlRvcGljIHNjb3Jpbmcg4oCUIGZyb20gU3RyYXRlZ2lzdCBhZ2VudC4iIiIKCiAgICBfX3RhYmxlbmFtZV9fID0gIm9wcG9ydHVuaXR5X3Njb3JlcyIKCiAgICBpZCA9IENvbHVtbihJbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlLCBhdXRvaW5jcmVtZW50PVRydWUpCiAgICBjbGllbnRfaWQgPSBDb2x1bW4oU3RyaW5nKDEwMCksIEZvcmVpZ25LZXkoImNsaWVudHMuY2xpZW50X2lkIiksIG51bGxhYmxlPUZhbHNlLCBpbmRleD1UcnVlKQogICAgc25hcHNob3RfaWQgPSBDb2x1bW4oU3RyaW5nKDEwMCksIG51bGxhYmxlPUZhbHNlLCBpbmRleD1UcnVlKQogICAgY3VycmVudF9zZWFzb24gPSBDb2x1bW4oU3RyaW5nKDUwKSwgbnVsbGFibGU9RmFsc2UpCiAgICByZXN1bHRfaWQgPSBDb2x1bW4oU3RyaW5nKDE1MCksIHVuaXF1ZT1UcnVlLCBpbmRleD1UcnVlKQogICAgdGllcl8xX3RvcGljcyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpCiAgICB0aWVyXzJfdG9waWNzID0gQ29sdW1uKEpTT04sIGRlZmF1bHQ9bGlzdCkKICAgIHRpZXJfM190b3BpY3MgPSBDb2x1bW4oSlNPTiwgZGVmYXVsdD1saXN0KQogICAgZXhjbHVkZWRfdG9waWNzID0gQ29sdW1uKEpTT04sIGRlZmF1bHQ9bGlzdCkKICAgIGNyZWF0ZWRfYXQgPSBDb2x1bW4oRGF0ZVRpbWUsIGRlZmF1bHQ9ZGF0ZXRpbWUudXRjbm93KQoKCmNsYXNzIEtleXdvcmRJbnRlbGxpZ2VuY2UoQmFzZSk6CiAgICAiIiIKICAgIEtleXdvcmQgaW50ZWxsaWdlbmNlIHN0b3JlIOKAlCBleHRyYWN0ZWQgZnJvbSBjb21wZXRpdG9yIHNpdGVzLCBibG9ncywgR0JQLgogICAgVHJhY2tzIGtleXdvcmQsIHR5cGUsIHJlZ2lvbiwgc291cmNlLCBmcmVxdWVuY3ksIGZpcnN0L2xhc3Qgc2Vlbi4KICAgICIiIgoKICAgIF9fdGFibGVuYW1lX18gPSAia2V5d29yZF9pbnRlbGxpZ2VuY2UiCiAgICBfX3RhYmxlX2FyZ3NfXyA9IChVbmlxdWVDb25zdHJhaW50KCJrZXl3b3JkIiwgInJlZ2lvbiIsIG5hbWU9InVxX2tleXdvcmRfcmVnaW9uIiksKQoKICAgIGlkID0gQ29sdW1uKEludGVnZXIsIHByaW1hcnlfa2V5PVRydWUsIGF1dG9pbmNyZW1lbnQ9VHJ1ZSkKICAgIGtleXdvcmQgPSBDb2x1bW4oU3RyaW5nKDI1NSksIG51bGxhYmxlPUZhbHNlLCBpbmRleD1UcnVlKQogICAga2V5d29yZF90eXBlID0gQ29sdW1uKFN0cmluZyg1MCkpICAjIHNlcnZpY2UgfCBnZW8gfCBtb2RpZmllciB8IGxvbmdfdGFpbCB8IGJyYW5kCiAgICByZWdpb24gPSBDb2x1bW4oU3RyaW5nKDEwMCksIG51bGxhYmxlPUZhbHNlLCBpbmRleD1UcnVlKQogICAgc291cmNlID0gQ29sdW1uKFN0cmluZyg1MCksIG51bGxhYmxlPUZhbHNlKSAgIyBjb21wZXRpdG9yIHwgY2xpZW50IHwgcGxhdGZvcm0KICAgIGNsaWVudF9pZCA9IENvbHVtbihTdHJpbmcoMTAwKSwgRm9yZWlnbktleSgiY2xpZW50cy5jbGllbnRfaWQiKSwgaW5kZXg9VHJ1ZSkKICAgIGZyZXF1ZW5jeSA9IENvbHVtbihJbnRlZ2VyLCBkZWZhdWx0PTEpCiAgICBmaXJzdF9zZWVuID0gQ29sdW1uKERhdGVUaW1lLCBkZWZhdWx0PWRhdGV0aW1lLnV0Y25vdykKICAgIGxhc3Rfc2VlbiA9IENvbHVtbihEYXRlVGltZSwgZGVmYXVsdD1kYXRldGltZS51dGNub3csIG9udXBkYXRlPWRhdGV0aW1lLnV0Y25vdykKCgpjbGFzcyBDb250ZW50U3RyYXRlZ3koQmFzZSk6CiAgICAiIiJBY3Rpb24gcGxhbiDigJQgY2xlYXIgaW5zdHJ1Y3Rpb25zIHRoZSBjbGllbnQgY2FuIGFjdCBvbi4iIiIKCiAgICBfX3RhYmxlbmFtZV9fID0gImNvbnRlbnRfc3RyYXRlZ2llcyIKCiAgICBpZCA9IENvbHVtbihJbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlLCBhdXRvaW5jcmVtZW50PVRydWUpCiAgICBjbGllbnRfaWQgPSBDb2x1bW4oU3RyaW5nKDEwMCksIEZvcmVpZ25LZXkoImNsaWVudHMuY2xpZW50X2lkIiksIG51bGxhYmxlPUZhbHNlLCBpbmRleD1UcnVlKQogICAgdG9waWMgPSBDb2x1bW4oU3RyaW5nKDI1NSksIG51bGxhYmxlPUZhbHNlKQogICAgcmVjb21tZW5kZWRfYWN0aW9ucyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpICAjIGxpc3Rbc3RyXQogICAgcHJpb3JpdHlfc2NvcmUgPSBDb2x1bW4oSW50ZWdlciwgZGVmYXVsdD0wKQogICAgY3JlYXRlZF9hdCA9IENvbHVtbihEYXRlVGltZSwgZGVmYXVsdD1kYXRldGltZS51dGNub3cpCgoKY2xhc3MgQ29udGVudERyYWZ0KEJhc2UpOgogICAgIiIiRHJhZnRlZCBjb250ZW50IOKAlCBmcm9tIFN0cmF0ZWdpc3QgYWdlbnQuIiIiCgogICAgX190YWJsZW5hbWVfXyA9ICJjb250ZW50X2RyYWZ0cyIKCiAgICBpZCA9IENvbHVtbihJbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlLCBhdXRvaW5jcmVtZW50PVRydWUpCiAgICBjbGllbnRfaWQgPSBDb2x1bW4oU3RyaW5nKDEwMCksIEZvcmVpZ25LZXkoImNsaWVudHMuY2xpZW50X2lkIiksIG51bGxhYmxlPUZhbHNlLCBpbmRleD1UcnVlKQogICAgdG9waWMgPSBDb2x1bW4oU3RyaW5nKDI1NSksIG51bGxhYmxlPUZhbHNlKQogICAgY29udGVudF90eXBlID0gQ29sdW1uKFN0cmluZyg1MCksIG51bGxhYmxlPUZhbHNlKSAgIyBzb2NpYWwsIGdvb2dsZV9idXNpbmVzcywgYmxvZwogICAgcGxhdGZvcm0gPSBDb2x1bW4oU3RyaW5nKDUwKSwgbnVsbGFibGU9RmFsc2UpCiAgICB0aXRsZSA9IENvbHVtbihTdHJpbmcoNTAwKSkKICAgIGJvZHkgPSBDb2x1bW4oVGV4dCwgbnVsbGFibGU9RmFsc2UpCiAgICBib2R5X3JlZmluZWQgPSBDb2x1bW4oVGV4dCkgICMgQWZ0ZXIgZGlmZmVyZW50aWF0aW9uCiAgICB3b3JkX2NvdW50ID0gQ29sdW1uKEludGVnZXIsIGRlZmF1bHQ9MCkKICAgIGNoYW5nZV9ub3RlcyA9IENvbHVtbihKU09OLCBkZWZhdWx0PWxpc3QpCiAgICBzdGF0dXMgPSBDb2x1bW4oU3RyaW5nKDMwKSwgZGVmYXVsdD0iZHJhZnQiKSAgIyBkcmFmdCwgYXBwcm92ZWQsIHB1Ymxpc2hlZAogICAgY3JlYXRlZF9hdCA9IENvbHVtbihEYXRlVGltZSwgZGVmYXVsdD1kYXRldGltZS51dGNub3cpCgoKY2xhc3MgQ29udGVudExvZyhCYXNlKToKICAgICIiIlB1Ymxpc2hlZCBjb250ZW50IGxvZyDigJQgZm9yIFB1Ymxpc2hpbmcgYWdlbnQgKGxhdGVyKS4iIiIKCiAgICBfX3RhYmxlbmFtZV9fID0gImNvbnRlbnRfbG9nIgoKICAgIGlkID0gQ29sdW1uKEludGVnZXIsIHByaW1hcnlfa2V5PVRydWUsIGF1dG9pbmNyZW1lbnQ9VHJ1ZSkKICAgIGNsaWVudF9pZCA9IENvbHVtbihTdHJpbmcoMTAwKSwgRm9yZWlnbktleSgiY2xpZW50cy5jbGllbnRfaWQiKSwgbnVsbGFibGU9RmFsc2UsIGluZGV4PVRydWUpCiAgICBwbGF0Zm9ybSA9IENvbHVtbihTdHJpbmcoNTApLCBudWxsYWJsZT1GYWxzZSkKICAgIHRvcGljID0gQ29sdW1uKFN0cmluZygyNTUpLCBudWxsYWJsZT1GYWxzZSkKICAgIHB1Ymxpc2hlZF9kYXRlID0gQ29sdW1uKFN0cmluZygyMCksIG51bGxhYmxlPUZhbHNlKQogICAgY29udGVudF90eXBlID0gQ29sdW1uKFN0cmluZyg1MCkpCiAgICB1cmwgPSBDb2x1bW4oU3RyaW5nKDUwMCkpCiAgICBjcmVhdGVkX2F0ID0gQ29sdW1uKERhdGVUaW1lLCBkZWZhdWx0PWRhdGV0aW1lLnV0Y25vdykKCgojIEVuZ2luZSBhbmQgc2Vzc2lvbgplbmdpbmUgPSBjcmVhdGVfZW5naW5lKERBVEFCQVNFX1VSTCkKU2Vzc2lvbkxvY2FsID0gc2Vzc2lvbm1ha2VyKGF1dG9jb21taXQ9RmFsc2UsIGF1dG9mbHVzaD1GYWxzZSwgYmluZD1lbmdpbmUpCgoKZGVmIGluaXRfZGIoKToKICAgICIiIkNyZWF0ZSBhbGwgdGFibGVzLiIiIgogICAgQmFzZS5tZXRhZGF0YS5jcmVhdGVfYWxsKGJpbmQ9ZW5naW5lKQoKCmRlZiBnZXRfZGIoKToKICAgICIiIkRlcGVuZGVuY3kgZm9yIERCIHNlc3Npb24uIiIiCiAgICBkYiA9IFNlc3Npb25Mb2NhbCgpCiAgICB0cnk6CiAgICAgICAgeWllbGQgZGIKICAgIGZpbmFsbHk6CiAgICAgICAgZGIuY2xvc2UoKQo=',
    "main.py": 'IiIiCkFnZW5jeSBBSSBQaXBlbGluZSDigJQgc2ltcGxlLCByZWFkYWJsZSBvcmNoZXN0cmF0aW9uLgpUYWtlIGNsaWVudF9pZCDihpIgcnVuIGFnZW50cyBpbiBvcmRlciDihpIgc3RvcCBpZiBzb21ldGhpbmcgZmFpbHMuClJlcGxhY2VzIG44biBmb3IgdjEuCiIiIgoKaW1wb3J0IGFyZ3BhcnNlCmltcG9ydCBzeXMKZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmZyb20gdHlwaW5nIGltcG9ydCBPcHRpb25hbAoKc3lzLnBhdGguaW5zZXJ0KDAsIHN0cihQYXRoKF9fZmlsZV9fKS5yZXNvbHZlKCkucGFyZW50KSkKCmZyb20gc3FsYWxjaGVteSBpbXBvcnQgZnVuYwoKZnJvbSBkYXRhYmFzZSBpbXBvcnQgQ2xpZW50LCBSZXNlYXJjaExvZywgU2Vzc2lvbkxvY2FsLCBpbml0X2RiCgoKZGVmIF9yZXNvbHZlX2NsaWVudF9pZChjbGllbnRfaWQ6IHN0cikgLT4gT3B0aW9uYWxbc3RyXToKICAgICIiIlJlc29sdmUgY2xpZW50X2lkIChjYXNlLWluc2Vuc2l0aXZlKSB0byBhY3R1YWwgc3RvcmVkIHZhbHVlLiIiIgogICAgZGIgPSBTZXNzaW9uTG9jYWwoKQogICAgdHJ5OgogICAgICAgIGNsaWVudCA9IGRiLnF1ZXJ5KENsaWVudCkuZmlsdGVyKGZ1bmMubG93ZXIoQ2xpZW50LmNsaWVudF9pZCkgPT0gY2xpZW50X2lkLmxvd2VyKCkpLmZpcnN0KCkKICAgICAgICByZXR1cm4gY2xpZW50LmNsaWVudF9pZCBpZiBjbGllbnQgZWxzZSBOb25lCiAgICBmaW5hbGx5OgogICAgICAgIGRiLmNsb3NlKCkKCgpkZWYgcnVuX3Jlc2VhcmNoZXIoY2xpZW50X2lkOiBzdHIsIGNpdHk6IHN0ciA9IE5vbmUpIC0+IHR1cGxlW2Jvb2wsIHN0cl06CiAgICAiIiJSdW4gUmVzZWFyY2hlciBvbmx5LiBSZXR1cm5zIChzdWNjZXNzLCBtZXNzYWdlKS4iIiIKICAgIHRyeToKICAgICAgICByZXNvbHZlZCA9IF9yZXNvbHZlX2NsaWVudF9pZChjbGllbnRfaWQpCiAgICAgICAgaWYgbm90IHJlc29sdmVkOgogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGYiQ2xpZW50ICd7Y2xpZW50X2lkfScgbm90IGZvdW5kLiBDaGVjayBjbGllbnQgSUQgKGNhc2UtaW5zZW5zaXRpdmUpLiIKICAgICAgICBmcm9tIGFnZW50cy5yZXNlYXJjaGVyIGltcG9ydCBnYXRoZXJfaW50ZWxsaWdlbmNlCiAgICAgICAgcnVuX2lkID0gZ2F0aGVyX2ludGVsbGlnZW5jZShjbGllbnRfaWQ9cmVzb2x2ZWQsIGNpdHk9Y2l0eSkKICAgICAgICBpZiBub3QgcnVuX2lkOgogICAgICAgICAgICByZXR1cm4gRmFsc2UsICJSZXNlYXJjaGVyIHJldHVybmVkIG5vIHJ1bl9pZCAoY2xpZW50IG5vdCBmb3VuZD8pLiIKICAgICAgICBkYiA9IFNlc3Npb25Mb2NhbCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjb3VudCA9IGRiLnF1ZXJ5KFJlc2VhcmNoTG9nKS5maWx0ZXIoUmVzZWFyY2hMb2cuY2xpZW50X2lkID09IHJlc29sdmVkKS5jb3VudCgpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgZGIuY2xvc2UoKQogICAgICAgIGlmIGNvdW50ID09IDA6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgIk5vIHJlc2VhcmNoIHNhdmVkLiBDaGVjayBUYXZpbHkgQVBJIGtleSwgZW5zdXJlIGNsaWVudCBoYXMgY2l0aWVzX3NlcnZlZCwgYW5kIHNlZSBsb2dzL3Jlc2VhcmNoZXIubG9nIgogICAgICAgIHJldHVybiBUcnVlLCBmIlJlc2VhcmNoIGNvbXBsZXRlICh7Y291bnR9IGVudHJpZXMpLiBSZXZpZXcgbG9ncywgdGhlbiBydW4gU3RyYXRlZ2lzdC4iCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKCgpkZWYgcnVuX2tleXdvcmRfY2xhc3NpZmllcihyZWdpb246IHN0ciwgY2xpZW50X2lkOiBzdHIgPSBOb25lKSAtPiB0dXBsZVtib29sLCBzdHJdOgogICAgIiIiUnVuIExMTSBrZXl3b3JkIGNsYXNzaWZpY2F0aW9uIGZvciBhIHJlZ2lvbi4gT3B0aW9uYWwg4oCUIG9uY2UgcGVyIGJhdGNoL2NpdHkvd2Vlay4iIiIKICAgIGZyb20gYWdlbnRzLmtleXdvcmRfY2xhc3NpZmllciBpbXBvcnQgcnVuX2NsYXNzaWZpZXIKICAgIHJldHVybiBydW5fY2xhc3NpZmllcihyZWdpb24sIGNsaWVudF9pZCkKCgpkZWYgcnVuX3N0cmF0ZWdpc3QoY2xpZW50X2lkOiBzdHIpIC0+IHR1cGxlW2Jvb2wsIHN0cl06CiAgICAiIiJSdW4gU3RyYXRlZ2lzdCBvbmx5IChyZWFkcyByZXNlYXJjaF9sb2dzKS4gUmV0dXJucyAoc3VjY2VzcywgbWVzc2FnZSkuIiIiCiAgICByZXNvbHZlZCA9IF9yZXNvbHZlX2NsaWVudF9pZChjbGllbnRfaWQpCiAgICBpZiBub3QgcmVzb2x2ZWQ6CiAgICAgICAgcmV0dXJuIEZhbHNlLCBmIkNsaWVudCAne2NsaWVudF9pZH0nIG5vdCBmb3VuZC4gQ2hlY2sgY2xpZW50IElEIChjYXNlLWluc2Vuc2l0aXZlKS4iCiAgICBkYiA9IFNlc3Npb25Mb2NhbCgpCiAgICB0cnk6CiAgICAgICAgY291bnQgPSBkYi5xdWVyeShSZXNlYXJjaExvZykuZmlsdGVyKFJlc2VhcmNoTG9nLmNsaWVudF9pZCA9PSByZXNvbHZlZCkuY291bnQoKQogICAgICAgIGlmIGNvdW50ID09IDA6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgIk5vIHJlc2VhcmNoIGxvZ3MuIFJ1biBSZXNlYXJjaGVyIGZpcnN0LCB0aGVuIHJldmlldyAmIG92ZXJyaWRlLiIKICAgIGZpbmFsbHk6CiAgICAgICAgZGIuY2xvc2UoKQogICAgdHJ5OgogICAgICAgIGZyb20gYWdlbnRzLnN0cmF0ZWdpc3QgaW1wb3J0IGdlbmVyYXRlX3N0cmF0ZWd5CiAgICAgICAgcmVzdWx0ID0gZ2VuZXJhdGVfc3RyYXRlZ3koY2xpZW50X2lkPXJlc29sdmVkKQogICAgICAgIGlmIG5vdCByZXN1bHQgb3Igbm90IHJlc3VsdC5nZXQoImRyYWZ0X2lkcyIpOgogICAgICAgICAgICByZXR1cm4gRmFsc2UsICJTdHJhdGVnaXN0IHJldHVybmVkIG5vIGRyYWZ0cyIKICAgICAgICByZXR1cm4gVHJ1ZSwgZiJ7bGVuKHJlc3VsdFsnZHJhZnRfaWRzJ10pfSBkcmFmdHMgc2F2ZWQuIgogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHJldHVybiBGYWxzZSwgc3RyKGUpCgoKZGVmIHJ1bl9waXBlbGluZShjbGllbnRfaWQ6IHN0ciwgY2l0eTogc3RyID0gTm9uZSkgLT4gdHVwbGVbYm9vbCwgc3RyXToKICAgICIiIlJ1biBSZXNlYXJjaGVyIOKGkiBTdHJhdGVnaXN0IChza2lwcyByZXZpZXcgc3RlcCkuIEZvciBDTEkgY29udmVuaWVuY2UuIiIiCiAgICBvaywgbXNnID0gcnVuX3Jlc2VhcmNoZXIoY2xpZW50X2lkLCBjaXR5KQogICAgaWYgbm90IG9rOgogICAgICAgIHJldHVybiBGYWxzZSwgbXNnCiAgICByZXR1cm4gcnVuX3N0cmF0ZWdpc3QoY2xpZW50X2lkKQoKCmRlZiBtYWluKCk6CiAgICBwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcigKICAgICAgICBkZXNjcmlwdGlvbj0iQWdlbmN5IEFJIHBpcGVsaW5lIOKAlCBydW4gUmVzZWFyY2hlciDihpIgU3RyYXRlZ2lzdCBmb3IgYSBjbGllbnQiLAogICAgKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiY2xpZW50X2lkIiwgdHlwZT1zdHIsIG5hcmdzPSI/IiwgaGVscD0iQ2xpZW50IElEIHRvIHByb2Nlc3MiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1jaXR5IiwgdHlwZT1zdHIsIGhlbHA9IkNpdHkgZm9yIFJlc2VhcmNoZXIgKG9wdGlvbmFsIGlmIGNsaWVudCBoYXMgY2l0aWVzX3NlcnZlZCkiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1pbml0LWRiIiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iSW5pdGlhbGl6ZSBkYXRhYmFzZSB0YWJsZXMiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1yZXNlYXJjaGVyLW9ubHkiLCBhY3Rpb249InN0b3JlX3RydWUiLCBoZWxwPSJSdW4gb25seSBSZXNlYXJjaGVyIikKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tc3RyYXRlZ2lzdC1vbmx5IiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iUnVuIG9ubHkgU3RyYXRlZ2lzdCIpCiAgICBhcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQoKICAgIGlmIGFyZ3MuaW5pdF9kYjoKICAgICAgICBpbml0X2RiKCkKICAgICAgICBwcmludCgiRGF0YWJhc2UgaW5pdGlhbGl6ZWQuIikKICAgICAgICBwcmludCgiTmV4dDogc3RyZWFtbGl0IHJ1biBhcHAucHkgZm9yIG9uYm9hcmRpbmcgJiByZXZpZXciKQogICAgICAgIHJldHVybiAwCgogICAgaWYgYXJncy5yZXNlYXJjaGVyX29ubHk6CiAgICAgICAgaWYgbm90IGFyZ3MuY2xpZW50X2lkOgogICAgICAgICAgICBwcmludCgiRXJyb3I6IGNsaWVudF9pZCByZXF1aXJlZCIpCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgcmVzb2x2ZWQgPSBfcmVzb2x2ZV9jbGllbnRfaWQoYXJncy5jbGllbnRfaWQpCiAgICAgICAgaWYgbm90IHJlc29sdmVkOgogICAgICAgICAgICBwcmludChmIkVycm9yOiBDbGllbnQgJ3thcmdzLmNsaWVudF9pZH0nIG5vdCBmb3VuZCIpCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZnJvbSBhZ2VudHMucmVzZWFyY2hlciBpbXBvcnQgZ2F0aGVyX2ludGVsbGlnZW5jZQogICAgICAgIHJ1bl9pZCA9IGdhdGhlcl9pbnRlbGxpZ2VuY2UoY2xpZW50X2lkPXJlc29sdmVkLCBjaXR5PWFyZ3MuY2l0eSkKICAgICAgICBwcmludChmIlJlc2VhcmNoZXIgZG9uZS4gcnVuX2lkPXtydW5faWR9IikKICAgICAgICByZXR1cm4gMCBpZiBydW5faWQgZWxzZSAxCgogICAgaWYgYXJncy5zdHJhdGVnaXN0X29ubHk6CiAgICAgICAgaWYgbm90IGFyZ3MuY2xpZW50X2lkOgogICAgICAgICAgICBwcmludCgiRXJyb3I6IGNsaWVudF9pZCByZXF1aXJlZCIpCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgcmVzb2x2ZWQgPSBfcmVzb2x2ZV9jbGllbnRfaWQoYXJncy5jbGllbnRfaWQpCiAgICAgICAgaWYgbm90IHJlc29sdmVkOgogICAgICAgICAgICBwcmludChmIkVycm9yOiBDbGllbnQgJ3thcmdzLmNsaWVudF9pZH0nIG5vdCBmb3VuZCIpCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZnJvbSBhZ2VudHMuc3RyYXRlZ2lzdCBpbXBvcnQgZ2VuZXJhdGVfc3RyYXRlZ3kKICAgICAgICByZXN1bHQgPSBnZW5lcmF0ZV9zdHJhdGVneShjbGllbnRfaWQ9cmVzb2x2ZWQpCiAgICAgICAgcHJpbnQoZiJTdHJhdGVnaXN0IGRvbmUuIHtyZXN1bHR9IikKICAgICAgICByZXR1cm4gMCBpZiByZXN1bHQuZ2V0KCJkcmFmdF9pZHMiKSBlbHNlIDEKCiAgICAjIEZ1bGwgcGlwZWxpbmUKICAgIGlmIG5vdCBhcmdzLmNsaWVudF9pZDoKICAgICAgICBwYXJzZXIucHJpbnRfaGVscCgpCiAgICAgICAgcHJpbnQoIlxuRXhhbXBsZTogcHl0aG9uIG1haW4ucHkganVuay1hd2F5LXBob2VuaXggLS1jaXR5ICdPc2hrb3NoIFdJJyIpCiAgICAgICAgcmV0dXJuIDEKCiAgICBzdWNjZXNzLCBfID0gcnVuX3BpcGVsaW5lKGNsaWVudF9pZD1hcmdzLmNsaWVudF9pZCwgY2l0eT1hcmdzLmNpdHkpCiAgICByZXR1cm4gMCBpZiBzdWNjZXNzIGVsc2UgMQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBzeXMuZXhpdChtYWluKCkpCg==',
    "app.py": 'IiIiCkFnZW5jeSBBSSBEYXNoYm9hcmQg4oCUIE91dGNvbWVzIG92ZXIgYWN0aXZpdHkuIFNpbXBsZSwgY2FsbSwgdHJ1c3R3b3J0aHkuCiIiIgoKaW1wb3J0IHN0cmVhbWxpdCBhcyBzdAppbXBvcnQgc3lzCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aAoKc3lzLnBhdGguaW5zZXJ0KDAsIHN0cihQYXRoKF9fZmlsZV9fKS5yZXNvbHZlKCkucGFyZW50KSkKCmZyb20gZGF0YWJhc2UgaW1wb3J0IGluaXRfZGIsIFNlc3Npb25Mb2NhbCwgQ2xpZW50LCBDb250ZW50U3RyYXRlZ3ksIEtleXdvcmRJbnRlbGxpZ2VuY2UsIE1hcmtldFNuYXBzaG90LCBPcHBvcnR1bml0eVNjb3JlLCBDb250ZW50RHJhZnQsIFJlc2VhcmNoTG9nCmZyb20gbWFpbiBpbXBvcnQgcnVuX2tleXdvcmRfY2xhc3NpZmllciwgcnVuX3Jlc2VhcmNoZXIsIHJ1bl9zdHJhdGVnaXN0CmZyb20gYWdlbnRzLmtleXdvcmRfZXh0cmFjdG9yIGltcG9ydCBzdG9yZV9rZXl3b3Jkcwpmcm9tIHNxbGFsY2hlbXkgaW1wb3J0IG9yXwoKc3Quc2V0X3BhZ2VfY29uZmlnKHBhZ2VfdGl0bGU9IkFnZW5jeSBBSSIsIHBhZ2VfaWNvbj0i8J+TiyIsIGxheW91dD0id2lkZSIpCmluaXRfZGIoKQoKIyDilIDilIDilIAgTGF5b3V0IEhlbHBlcnMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgpkZWYgZ2V0X2NsaWVudF9jb250ZXh0KGNsaWVudHMpOgogICAgIiIiQ2xpZW50IHNlbGVjdG9yLiBSZXR1cm5zIChjbGllbnRfaWQsIGNsaWVudCkuIEVuc3VyZXMgc2VsZWN0aW9uIGlzIHZhbGlkLiIiIgogICAgaWYgbm90IGNsaWVudHM6CiAgICAgICAgcmV0dXJuIE5vbmUsIE5vbmUKICAgIG9wdGlvbnMgPSBbYy5jbGllbnRfaWQgZm9yIGMgaW4gY2xpZW50c10KICAgICMgSWYgc3RvcmVkIHNlbGVjdGlvbiBpcyBpbnZhbGlkIChlLmcuIGNsaWVudCByZW1vdmVkKSwgcmVzZXQgdG8gZmlyc3QKICAgIHN0b3JlZCA9IHN0LnNlc3Npb25fc3RhdGUuZ2V0KCJjbGllbnRfc2VsZWN0IikKICAgIGlmIHN0b3JlZCBub3QgaW4gb3B0aW9uczoKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlWyJjbGllbnRfc2VsZWN0Il0gPSBvcHRpb25zWzBdCiAgICBjbGllbnRfaWQgPSBzdC5zaWRlYmFyLnNlbGVjdGJveCgKICAgICAgICAiQ2xpZW50IiwKICAgICAgICBvcHRpb25zLAogICAgICAgIGtleT0iY2xpZW50X3NlbGVjdCIsCiAgICAgICAgZm9ybWF0X2Z1bmM9bGFtYmRhIHg6IG5leHQoKGMuYnVzaW5lc3NfbmFtZSBvciB4IGZvciBjIGluIGNsaWVudHMgaWYgYy5jbGllbnRfaWQgPT0geCksIHgpLAogICAgKQogICAgY2xpZW50ID0gbmV4dCgoYyBmb3IgYyBpbiBjbGllbnRzIGlmIGMuY2xpZW50X2lkID09IGNsaWVudF9pZCksIE5vbmUpCiAgICByZXR1cm4gY2xpZW50X2lkLCBjbGllbnQKCgpkZWYgcmVuZGVyX3N0YXR1c19yaWJib24oY2xpZW50LCBjaXR5KToKICAgICIiIlRvcCBzdGF0dXMgcmliYm9uOiBDbGllbnQgTmFtZSB8IENpdHkgfCBTdGF0dXMuIiIiCiAgICBzdGF0dXMgPSAi8J+foiBBY3RpdmUiIGlmIF9oYXNfcmVjZW50X2FjdGl2aXR5KGNsaWVudCkgZWxzZSAi8J+foSBOZWVkcyBSZXZpZXciCiAgICBjb2wxLCBjb2wyLCBjb2wzID0gc3QuY29sdW1ucyhbMiwgMSwgMV0pCiAgICB3aXRoIGNvbDE6CiAgICAgICAgc3QubWFya2Rvd24oZiIjIyMge2NsaWVudC5idXNpbmVzc19uYW1lIG9yIGNsaWVudC5jbGllbnRfaWR9IikKICAgIHdpdGggY29sMjoKICAgICAgICBzdC5tYXJrZG93bihmIioqe2NpdHkgb3IgJ+KAlCd9KioiKQogICAgd2l0aCBjb2wzOgogICAgICAgIHN0LnN1Y2Nlc3Moc3RhdHVzKQogICAgc3QuZGl2aWRlcigpCgoKZGVmIF9oYXNfcmVjZW50X2FjdGl2aXR5KGNsaWVudCk6CiAgICAiIiJUcnVlIGlmIGNsaWVudCBoYXMgcmVjZW50IHJlc2VhcmNoL2RyYWZ0cy4iIiIKICAgIGRiID0gU2Vzc2lvbkxvY2FsKCkKICAgIHRyeToKICAgICAgICBoYXNfcmVzZWFyY2ggPSBkYi5xdWVyeShSZXNlYXJjaExvZykuZmlsdGVyKFJlc2VhcmNoTG9nLmNsaWVudF9pZCA9PSBjbGllbnQuY2xpZW50X2lkKS5maXJzdCgpCiAgICAgICAgaGFzX2RyYWZ0cyA9IGRiLnF1ZXJ5KENvbnRlbnREcmFmdCkuZmlsdGVyKENvbnRlbnREcmFmdC5jbGllbnRfaWQgPT0gY2xpZW50LmNsaWVudF9pZCkuZmlyc3QoKQogICAgICAgIHJldHVybiBib29sKGhhc19yZXNlYXJjaCBvciBoYXNfZHJhZnRzKQogICAgZmluYWxseToKICAgICAgICBkYi5jbG9zZSgpCgoKIyDilIDilIDilIAgT3ZlcnZpZXcg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgpkZWYgcGFnZV9vdmVydmlldyhjbGllbnRfaWQsIGNsaWVudCwgZGIpOgogICAgIiIiUHJvdmUgdmFsdWUgaW4gdW5kZXIgMTAgc2Vjb25kcy4iIiIKICAgIGNpdHkgPSAoY2xpZW50LmNpdGllc19zZXJ2ZWQgb3IgWyIiXSlbMF0gaWYgY2xpZW50LmNpdGllc19zZXJ2ZWQgZWxzZSAi4oCUIgogICAgcmVuZGVyX3N0YXR1c19yaWJib24oY2xpZW50LCBjaXR5KQoKICAgICMgUnVuIFJlc2VhcmNoIC8gU3RyYXRlZ2lzdCBidXR0b25zCiAgICBzdC5tYXJrZG93bigiKipHZXQgc3RhcnRlZCoqIikKICAgIGNpdHlfaW4gPSBzdC50ZXh0X2lucHV0KCJDaXR5IGZvciByZXNlYXJjaCIsIHZhbHVlPWNpdHkgaWYgY2l0eSAhPSAi4oCUIiBlbHNlICIiLCBwbGFjZWhvbGRlcj0iZS5nLiBQaG9lbml4IEFaIiwga2V5PWYib3ZlcnZpZXdfY2l0eV97Y2xpZW50X2lkfSIpCiAgICByMSwgcjIsIF8gPSBzdC5jb2x1bW5zKFsxLCAxLCA0XSkKICAgIHdpdGggcjE6CiAgICAgICAgaWYgc3QuYnV0dG9uKCLilrYgUnVuIFJlc2VhcmNoIiwgdHlwZT0icHJpbWFyeSIpOgogICAgICAgICAgICBjID0gKGNpdHlfaW4gb3IgIiIpLnN0cmlwKCkgb3IgY2l0eQogICAgICAgICAgICBpZiBjIGFuZCBjICE9ICLigJQiOgogICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZVsicnVuX3Jlc2VhcmNoZXIiXSA9IChjbGllbnRfaWQsIGMpCiAgICAgICAgICAgICAgICBzdC5yZXJ1bigpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzdC5lcnJvcigiRW50ZXIgYSBjaXR5IGZvciByZXNlYXJjaC4iKQogICAgd2l0aCByMjoKICAgICAgICBpZiBzdC5idXR0b24oIuKWtiBGaW5kIE9wcG9ydHVuaXRpZXMiKToKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZVsicnVuX3N0cmF0ZWdpc3QiXSA9IGNsaWVudF9pZAogICAgICAgICAgICBzdC5yZXJ1bigpCiAgICBzdC5kaXZpZGVyKCkKCiAgICAjIEtQSSBDYXJkcyAoNCBvbmx5KQogICAgc3RyYXRlZ2llcyA9IGRiLnF1ZXJ5KENvbnRlbnRTdHJhdGVneSkuZmlsdGVyKENvbnRlbnRTdHJhdGVneS5jbGllbnRfaWQgPT0gY2xpZW50X2lkKS5vcmRlcl9ieShDb250ZW50U3RyYXRlZ3kucHJpb3JpdHlfc2NvcmUuZGVzYygpKS5hbGwoKQogICAgZHJhZnRzID0gZGIucXVlcnkoQ29udGVudERyYWZ0KS5maWx0ZXIoQ29udGVudERyYWZ0LmNsaWVudF9pZCA9PSBjbGllbnRfaWQpLmFsbCgpCiAgICBwZW5kaW5nID0gW2QgZm9yIGQgaW4gZHJhZnRzIGlmIGQuc3RhdHVzIGluICgiZHJhZnQiLCAiUEVORElORyIsIE5vbmUpXQogICAgcmVnaW9ucyA9IF9nZXRfcmVnaW9ucyhjbGllbnQsIGRiLCBjbGllbnRfaWQpCiAgICBrd3MgPSBfZ2V0X2tleXdvcmRzKGRiLCBjbGllbnRfaWQsIHJlZ2lvbnMpCiAgICBzbmFwc2hvdCA9IGRiLnF1ZXJ5KE1hcmtldFNuYXBzaG90KS5maWx0ZXIoTWFya2V0U25hcHNob3QuY2xpZW50X2lkID09IGNsaWVudF9pZCkub3JkZXJfYnkoTWFya2V0U25hcHNob3QuY3JlYXRlZF9hdC5kZXNjKCkpLmZpcnN0KCkKICAgIGdhcHMgPSAoc25hcHNob3QuY29udGVudF9nYXBzIG9yIFtdKSBpZiBzbmFwc2hvdCBlbHNlIFtdCgogICAgY29sMSwgY29sMiwgY29sMywgY29sNCA9IHN0LmNvbHVtbnMoNCkKICAgIHdpdGggY29sMToKICAgICAgICBzdC5tZXRyaWMoIk9wcG9ydHVuaXRpZXMgRm91bmQiLCBsZW4oc3RyYXRlZ2llcyksICJMb3ctY29tcGV0aXRpb24gd2lucyBpZGVudGlmaWVkIikKICAgIHdpdGggY29sMjoKICAgICAgICBzdC5tZXRyaWMoIkNvbnRlbnQgUmVhZHkiLCBsZW4ocGVuZGluZyksICJQb3N0cyBwZW5kaW5nIGFwcHJvdmFsIikKICAgIHdpdGggY29sMzoKICAgICAgICBzdC5tZXRyaWMoIktleXdvcmQgQ292ZXJhZ2UiLCBsZW4oa3dzKSwgIktleXdvcmRzIG1vbml0b3JlZCIpCiAgICB3aXRoIGNvbDQ6CiAgICAgICAgc3QubWV0cmljKCJNYXJrZXQgR2FwcyBJZGVudGlmaWVkIiwgbGVuKGdhcHMpLCAiU2VydmljZXMgY29tcGV0aXRvcnMgaWdub3JlIikKCiAgICBzdC5kaXZpZGVyKCkKICAgIHN0LnN1YmhlYWRlcigiV2hhdCBXZSBEaWQgRm9yIFlvdSIpCiAgICB0aW1lbGluZSA9IF9idWlsZF90aW1lbGluZShjbGllbnRfaWQsIGRiKQogICAgZm9yIGl0ZW0gaW4gdGltZWxpbmU6CiAgICAgICAgc3QubWFya2Rvd24oZiItIHtpdGVtfSIpCgoKZGVmIF9idWlsZF90aW1lbGluZShjbGllbnRfaWQsIGRiKToKICAgICIiIlBsYWluIEVuZ2xpc2ggZmVlZCBvZiBhZ2VudCBhY3Rpb25zLiIiIgogICAgdGltZWxpbmUgPSBbXQogICAgbG9ncyA9IGRiLnF1ZXJ5KFJlc2VhcmNoTG9nKS5maWx0ZXIoUmVzZWFyY2hMb2cuY2xpZW50X2lkID09IGNsaWVudF9pZCkuYWxsKCkKICAgIG5fY29tcGV0aXRvcnMgPSBsZW4oc2V0KHJsLmNvbXBldGl0b3JfbmFtZSBmb3IgcmwgaW4gbG9ncykpCiAgICBpZiBuX2NvbXBldGl0b3JzOgogICAgICAgIHRpbWVsaW5lLmFwcGVuZChmIlNjYW5uZWQge25fY29tcGV0aXRvcnN9IGNvbXBldGl0b3JzIGluIHlvdXIgbWFya2V0IikKICAgIHNjb3JlcyA9IGRiLnF1ZXJ5KE9wcG9ydHVuaXR5U2NvcmUpLmZpbHRlcihPcHBvcnR1bml0eVNjb3JlLmNsaWVudF9pZCA9PSBjbGllbnRfaWQpLmFsbCgpCiAgICBmb3Igc2MgaW4gc2NvcmVzOgogICAgICAgIGZvciB0IGluIChzYy50aWVyXzFfdG9waWNzIG9yIFtdKVs6Ml06CiAgICAgICAgICAgIHRpbWVsaW5lLmFwcGVuZChmIklkZW50aWZpZWQgKip7dH0qKiBhcyBhbiB1bmRlcnVzZWQgb3Bwb3J0dW5pdHkiKQogICAgZHJhZnRzID0gZGIucXVlcnkoQ29udGVudERyYWZ0KS5maWx0ZXIoQ29udGVudERyYWZ0LmNsaWVudF9pZCA9PSBjbGllbnRfaWQpLmFsbCgpCiAgICBmb3IgZCBpbiBkcmFmdHNbOjNdOgogICAgICAgIHRpbWVsaW5lLmFwcGVuZChmIkRyYWZ0ZWQge2QucGxhdGZvcm19IHBvc3Q6ICp7ZC50b3BpY30qIikKICAgIGt3cyA9IGRiLnF1ZXJ5KEtleXdvcmRJbnRlbGxpZ2VuY2UpLmZpbHRlcihLZXl3b3JkSW50ZWxsaWdlbmNlLmNsaWVudF9pZCA9PSBjbGllbnRfaWQpLmNvdW50KCkKICAgIGlmIGt3czoKICAgICAgICB0aW1lbGluZS5hcHBlbmQoZiJTYXZlZCB7a3dzfSByZWdpb25hbCBrZXl3b3JkIHZhcmlhdGlvbnMiKQogICAgaWYgbm90IHRpbWVsaW5lOgogICAgICAgIHRpbWVsaW5lLmFwcGVuZCgiUnVuIHJlc2VhcmNoIGFuZCBzdHJhdGVnaXN0IHRvIHNlZSB5b3VyIGFjdGl2aXR5IGhlcmUiKQogICAgcmV0dXJuIHRpbWVsaW5lCgoKIyDilIDilIDilIAgTWFya2V0IEludGVsbGlnZW5jZSDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKCmRlZiBwYWdlX21hcmtldF9pbnRlbGxpZ2VuY2UoY2xpZW50X2lkLCBjbGllbnQsIGRiKToKICAgICIiIkNvbXBldGl0aXZlIGFkdmFudGFnZSB3aXRob3V0IHJhdyBzY3JhcGluZy4iIiIKICAgIGNpdHkgPSAoY2xpZW50LmNpdGllc19zZXJ2ZWQgb3IgWyIiXSlbMF0gaWYgY2xpZW50LmNpdGllc19zZXJ2ZWQgZWxzZSAi4oCUIgogICAgcmVuZGVyX3N0YXR1c19yaWJib24oY2xpZW50LCBjaXR5KQoKICAgIHN0LnN1YmhlYWRlcigiTWFya2V0IEludGVsbGlnZW5jZSIpCiAgICBsb2dzID0gZGIucXVlcnkoUmVzZWFyY2hMb2cpLmZpbHRlcihSZXNlYXJjaExvZy5jbGllbnRfaWQgPT0gY2xpZW50X2lkKS5vcmRlcl9ieShSZXNlYXJjaExvZy5jb25maWRlbmNlX3Njb3JlLmRlc2MoKSkuYWxsKCkKCiAgICBpZiBub3QgbG9nczoKICAgICAgICBzdC5pbmZvKCJObyBtYXJrZXQgZGF0YSB5ZXQuIFJlZnJlc2ggbWFya2V0IGRhdGEgZnJvbSBPdmVydmlldyBvciBTZXR0aW5ncy4iKQogICAgICAgIHJldHVybgoKICAgIGZvciBybCBpbiBsb2dzOgogICAgICAgIHByZXNlbmNlID0gIldlYnNpdGUiIGlmIHJsLnNvdXJjZV90eXBlID09ICJ3ZWJzaXRlIiBlbHNlICJHb29nbGUgT25seSIKICAgICAgICBzZXJ2aWNlcyA9ICIsICIuam9pbigocmwuZXh0cmFjdGVkX3NlcnZpY2VzIG9yIFtdKVs6NV0pIG9yICJHZW5lcmFsIHNlcnZpY2VzIgogICAgICAgIHdlYWtuZXNzID0gIiwgIi5qb2luKHJsLm1pc3NlZF9vcHBvcnR1bml0aWVzIG9yIHJsLmNvbXBsYWludHMgb3IgWyLigJQiXSlbOjYwXSBvciAi4oCUIgogICAgICAgIGNvbmYgPSAiSGlnaCIgaWYgcmwuY29uZmlkZW5jZV9zY29yZSA+PSA3MCBlbHNlICgiTWVkaXVtIiBpZiBybC5jb25maWRlbmNlX3Njb3JlID49IDUwIGVsc2UgIkxvdyIpCiAgICAgICAgd2l0aCBzdC5leHBhbmRlcihmIioqe3JsLmNvbXBldGl0b3JfbmFtZX0qKiB8IHtwcmVzZW5jZX0gfCB7Y29uZn0iKToKICAgICAgICAgICAgc3QubWFya2Rvd24oIioqU2VydmljZXMgbWVudGlvbmVkKiogwrcgIiArIHNlcnZpY2VzKQogICAgICAgICAgICBzdC5tYXJrZG93bigiKipXZWFrbmVzcyAvIGdhcCoqIMK3ICIgKyB3ZWFrbmVzcykKICAgICAgICAgICAgaWYgcmwuY29tcGxhaW50czoKICAgICAgICAgICAgICAgIHN0LmNhcHRpb24oIkN1c3RvbWVyIGZlZWRiYWNrOiAiICsgIiwgIi5qb2luKHJsLmNvbXBsYWludHNbOjNdKSkKCgojIOKUgOKUgOKUgCBPcHBvcnR1bml0aWVzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgAoKZGVmIHBhZ2Vfb3Bwb3J0dW5pdGllcyhjbGllbnRfaWQsIGNsaWVudCwgZGIpOgogICAgIiIiRWFzeSB3aW5zIGVuZ2luZS4iIiIKICAgIGNpdHkgPSAoY2xpZW50LmNpdGllc19zZXJ2ZWQgb3IgWyIiXSlbMF0gaWYgY2xpZW50LmNpdGllc19zZXJ2ZWQgZWxzZSAiIgogICAgcmVuZGVyX3N0YXR1c19yaWJib24oY2xpZW50LCBjaXR5KQoKICAgIHN0LnN1YmhlYWRlcigiT3Bwb3J0dW5pdGllcyIpCiAgICBzdHJhdGVnaWVzID0gZGIucXVlcnkoQ29udGVudFN0cmF0ZWd5KS5maWx0ZXIoQ29udGVudFN0cmF0ZWd5LmNsaWVudF9pZCA9PSBjbGllbnRfaWQpLm9yZGVyX2J5KENvbnRlbnRTdHJhdGVneS5wcmlvcml0eV9zY29yZS5kZXNjKCkpLmFsbCgpCgogICAgaWYgbm90IHN0cmF0ZWdpZXM6CiAgICAgICAgc3QuaW5mbygiTm8gb3Bwb3J0dW5pdGllcyB5ZXQuIFJ1biBTdHJhdGVnaXN0IHRvIGlkZW50aWZ5IGVhc3kgd2lucy4iKQogICAgICAgIHJldHVybgoKICAgIGZvciBzIGluIHN0cmF0ZWdpZXM6CiAgICAgICAgd2l0aCBzdC5jb250YWluZXIoKToKICAgICAgICAgICAgc3QubWFya2Rvd24oZiIjIyMge3MudG9waWN9IiArIChmIiDigJQge2NpdHl9IiBpZiBjaXR5IGVsc2UgIiIpKQogICAgICAgICAgICBzdC5jYXB0aW9uKGYiU2NvcmU6IHtzLnByaW9yaXR5X3Njb3JlfSIpCiAgICAgICAgICAgIHN0Lm1hcmtkb3duKCIqKldoeSBpdCdzIGVhc3kqKiDCtyBMb3cgY29tcGV0aXRpb24gwrcgSGlnaCBzZWFyY2ggaW50ZW50IikKICAgICAgICAgICAgc3QubWFya2Rvd24oIioqU3VnZ2VzdGVkIGFjdGlvbioqIikKICAgICAgICAgICAgZm9yIGEgaW4gKHMucmVjb21tZW5kZWRfYWN0aW9ucyBvciBbXSk6CiAgICAgICAgICAgICAgICBzdC5tYXJrZG93bihmIi0ge2F9IikKICAgICAgICAgICAgc3QuZGl2aWRlcigpCgoKIyDilIDilIDilIAgQ29udGVudCBTdHVkaW8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgpkZWYgcGFnZV9jb250ZW50X3N0dWRpbyhjbGllbnRfaWQsIGNsaWVudCwgZGIpOgogICAgIiIiSHVtYW4taW4tdGhlLWxvb3AgYXBwcm92YWwgem9uZS4iIiIKICAgIGNpdHkgPSAoY2xpZW50LmNpdGllc19zZXJ2ZWQgb3IgWyIiXSlbMF0gaWYgY2xpZW50LmNpdGllc19zZXJ2ZWQgZWxzZSAi4oCUIgogICAgcmVuZGVyX3N0YXR1c19yaWJib24oY2xpZW50LCBjaXR5KQoKICAgIHN0LnN1YmhlYWRlcigiQ29udGVudCBTdHVkaW8iKQogICAgZHJhZnRzID0gZGIucXVlcnkoQ29udGVudERyYWZ0KS5maWx0ZXIoQ29udGVudERyYWZ0LmNsaWVudF9pZCA9PSBjbGllbnRfaWQpLm9yZGVyX2J5KENvbnRlbnREcmFmdC5jcmVhdGVkX2F0LmRlc2MoKSkuYWxsKCkKCiAgICBpZiBub3QgZHJhZnRzOgogICAgICAgIHN0LmluZm8oIk5vIGNvbnRlbnQgeWV0LiBSdW4gU3RyYXRlZ2lzdCB0byBnZW5lcmF0ZSBkcmFmdHMuIikKICAgICAgICByZXR1cm4KCiAgICBmb3IgZCBpbiBkcmFmdHM6CiAgICAgICAgc3RhdHVzID0gIkRyYWZ0IiBpZiBkLnN0YXR1cyBpbiAoImRyYWZ0IiwgIlBFTkRJTkciLCBOb25lKSBlbHNlICgiQXBwcm92ZWQiIGlmIGQuc3RhdHVzID09ICJhcHByb3ZlZCIgZWxzZSBkLnN0YXR1cykKICAgICAgICB3aXRoIHN0LmV4cGFuZGVyKGYiKip7ZC5wbGF0Zm9ybX0qKiDigJQge2QudG9waWN9IFt7c3RhdHVzfV0iKToKICAgICAgICAgICAgZWRpdGVkID0gc3QudGV4dF9hcmVhKCJFZGl0IGNvbnRlbnQiLCB2YWx1ZT1kLmJvZHlfcmVmaW5lZCBvciBkLmJvZHksIGhlaWdodD0xNjAsIGtleT1mImRyYWZ0LXtkLmlkfSIpCiAgICAgICAgICAgIHN0LmNhcHRpb24oIldoeSB0aGlzIHdvcmtzOiBUYXJnZXRzIHlvdXIgb3Bwb3J0dW5pdHkgwrcgTWF0Y2hlcyBsb2NhbCBpbnRlbnQiKQogICAgICAgICAgICBjMSwgYzIsIGMzLCBfID0gc3QuY29sdW1ucyhbMSwgMSwgMSwgNF0pCiAgICAgICAgICAgIHdpdGggYzE6CiAgICAgICAgICAgICAgICBpZiBzdC5idXR0b24oIuKchSBBcHByb3ZlIiwga2V5PWYiYXBwcm92ZS17ZC5pZH0iKSBhbmQgZC5zdGF0dXMgIT0gImFwcHJvdmVkIjoKICAgICAgICAgICAgICAgICAgICBkLnN0YXR1cyA9ICJhcHByb3ZlZCIKICAgICAgICAgICAgICAgICAgICBkLmJvZHlfcmVmaW5lZCA9IGVkaXRlZCBvciBkLmJvZHkKICAgICAgICAgICAgICAgICAgICBkLndvcmRfY291bnQgPSBsZW4oKGVkaXRlZCBvciBkLmJvZHkpLnNwbGl0KCkpCiAgICAgICAgICAgICAgICAgICAgZGIuY29tbWl0KCkKICAgICAgICAgICAgICAgICAgICBzdC5zdWNjZXNzKCJBcHByb3ZlZC4iKQogICAgICAgICAgICAgICAgICAgIHN0LnJlcnVuKCkKICAgICAgICAgICAgd2l0aCBjMjoKICAgICAgICAgICAgICAgIGlmIHN0LmJ1dHRvbigi4pyP77iPIFNhdmUgZWRpdHMiLCBrZXk9ZiJzYXZlLXtkLmlkfSIpOgogICAgICAgICAgICAgICAgICAgIGQuYm9keV9yZWZpbmVkID0gZWRpdGVkIG9yIGQuYm9keQogICAgICAgICAgICAgICAgICAgIGQud29yZF9jb3VudCA9IGxlbigoZWRpdGVkIG9yIGQuYm9keSkuc3BsaXQoKSkKICAgICAgICAgICAgICAgICAgICBkYi5jb21taXQoKQogICAgICAgICAgICAgICAgICAgIHN0LnN1Y2Nlc3MoIlNhdmVkLiIpCiAgICAgICAgICAgICAgICAgICAgc3QucmVydW4oKQogICAgICAgICAgICB3aXRoIGMzOgogICAgICAgICAgICAgICAgaWYgc3QuYnV0dG9uKCLwn5SEIFJlZ2VuZXJhdGUiLCBrZXk9ZiJyZWdlbi17ZC5pZH0iKToKICAgICAgICAgICAgICAgICAgICBzdC5pbmZvKCJSZWdlbmVyYXRlIGNvbWluZyBzb29uLiBFZGl0IGZvciBub3cuIikKCgojIOKUgOKUgOKUgCBTRU8gJiBLZXl3b3JkcyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKCmRlZiBwYWdlX3Nlb19rZXl3b3JkcyhjbGllbnRfaWQsIGNsaWVudCwgZGIpOgogICAgIiIiUHJvcHJpZXRhcnkgaW50ZWxsaWdlbmNlIHdpdGhvdXQgb3ZlcndoZWxtaW5nLiIiIgogICAgY2l0eSA9IChjbGllbnQuY2l0aWVzX3NlcnZlZCBvciBbIiJdKVswXSBpZiBjbGllbnQuY2l0aWVzX3NlcnZlZCBlbHNlICLigJQiCiAgICByZW5kZXJfc3RhdHVzX3JpYmJvbihjbGllbnQsIGNpdHkpCgogICAgc3Quc3ViaGVhZGVyKCJTRU8gJiBLZXl3b3JkcyIpCiAgICByZWdpb25zID0gX2dldF9yZWdpb25zKGNsaWVudCwgZGIsIGNsaWVudF9pZCkKICAgIGt3cyA9IF9nZXRfa2V5d29yZHMoZGIsIGNsaWVudF9pZCwgcmVnaW9ucykKCiAgICAjIFN1bW1hcnkKICAgIHVzZWQgPSBsZW4oW2sgZm9yIGsgaW4ga3dzIGlmIGsua2V5d29yZF90eXBlXSkgICMgc2ltcGxpZmllZDogdHlwZWQgPSB1c2VkIGZvciBub3cKICAgIGNvbDEsIGNvbDIsIGNvbDMgPSBzdC5jb2x1bW5zKDMpCiAgICB3aXRoIGNvbDE6CiAgICAgICAgc3QubWV0cmljKCJUb3RhbCBrZXl3b3JkcyIsIGxlbihrd3MpLCAiY29sbGVjdGVkIikKICAgIHdpdGggY29sMjoKICAgICAgICBzdC5tZXRyaWMoIlJlZ2lvbmFsIHZhcmlhdGlvbnMiLCBsZW4oc2V0KChrLmtleXdvcmQsIGsucmVnaW9uKSBmb3IgayBpbiBrd3MpKSkKICAgIHdpdGggY29sMzoKICAgICAgICBzdC5tZXRyaWMoIkhpZ2gtcG90ZW50aWFsIHVudXNlZCIsIGxlbihbayBmb3IgayBpbiBrd3MgaWYgay5mcmVxdWVuY3kgPCAzIGFuZCAoay5rZXl3b3JkX3R5cGUgb3IgIiIpXSksICJsb3cgY29tcGV0aXRpb24iKQoKICAgICMgQ2xhc3NpZnkga2V5d29yZHMgKExMTSkKICAgIGlmIHJlZ2lvbnM6CiAgICAgICAgaWYgc3QuYnV0dG9uKCLwn4+377iPIENsYXNzaWZ5IGtleXdvcmRzIik6CiAgICAgICAgICAgIHdpdGggc3Quc3RhdHVzKCJDbGFzc2lmeWluZ+KApiIpOgogICAgICAgICAgICAgICAgb2ssIG1zZyA9IHJ1bl9rZXl3b3JkX2NsYXNzaWZpZXIocmVnaW9uc1swXSwgY2xpZW50X2lkKQogICAgICAgICAgICAgICAgc3Quc3VjY2Vzcyhtc2cpIGlmIG9rIGVsc2Ugc3QuZXJyb3IobXNnKQogICAgICAgICAgICBzdC5yZXJ1bigpCgogICAgIyBBZGQga2V5d29yZHMKICAgIHdpdGggc3QuZXhwYW5kZXIoIuKelSBBZGQga2V5d29yZHMiKToKICAgICAgICB3aXRoIHN0LmZvcm0oImFkZF9rdyIpOgogICAgICAgICAgICBrd19pbiA9IHN0LnRleHRfaW5wdXQoIktleXdvcmRzIChjb21tYS1zZXBhcmF0ZWQpIiwgcGxhY2Vob2xkZXI9ImFwcGxpYW5jZSByZW1vdmFsLCBoYXVsIGF3YXkiKQogICAgICAgICAgICByZWdfaW4gPSBzdC50ZXh0X2lucHV0KCJSZWdpb24iLCB2YWx1ZT1yZWdpb25zWzBdIGlmIHJlZ2lvbnMgZWxzZSAiIiwgcGxhY2Vob2xkZXI9IlBob2VuaXgiKQogICAgICAgICAgICB0eXBfaW4gPSBzdC5zZWxlY3Rib3goIlR5cGUiLCBbIiIsICJzZXJ2aWNlIiwgImdlbyIsICJtb2RpZmllciIsICJsb25nX3RhaWwiLCAiYnJhbmQiXSkKICAgICAgICAgICAgaWYgc3QuZm9ybV9zdWJtaXRfYnV0dG9uKCJBZGQiKToKICAgICAgICAgICAgICAgIGtsaXN0ID0gW2suc3RyaXAoKSBmb3IgayBpbiBrd19pbi5zcGxpdCgiLCIpIGlmIGsuc3RyaXAoKV0KICAgICAgICAgICAgICAgIGlmIGtsaXN0IGFuZCByZWdfaW4uc3RyaXAoKToKICAgICAgICAgICAgICAgICAgICBzdG9yZV9rZXl3b3JkcyhrbGlzdCwgcmVnX2luLnN0cmlwKCksICJjbGllbnQiLCBjbGllbnRfaWQsIHR5cF9pbiBpZiB0eXBfaW4gZWxzZSBOb25lKQogICAgICAgICAgICAgICAgICAgIHN0LnN1Y2Nlc3MoZiJBZGRlZCB7bGVuKGtsaXN0KX0ga2V5d29yZHMuIikKICAgICAgICAgICAgICAgICAgICBzdC5yZXJ1bigpCgogICAgIyBUYWJsZQogICAgaWYga3dzOgogICAgICAgIGltcG9ydCBwYW5kYXMgYXMgcGQKICAgICAgICBkZiA9IHBkLkRhdGFGcmFtZShbewogICAgICAgICAgICAiS2V5d29yZCI6IGsua2V5d29yZCwKICAgICAgICAgICAgIlR5cGUiOiBrLmtleXdvcmRfdHlwZSBvciAi4oCUIiwKICAgICAgICAgICAgIlJlZ2lvbiI6IGsucmVnaW9uLAogICAgICAgICAgICAiRnJlcXVlbmN5Ijogay5mcmVxdWVuY3ksCiAgICAgICAgICAgICJTdGF0dXMiOiAiVXNlZCIgaWYgay5rZXl3b3JkX3R5cGUgZWxzZSAiTm90IHVzZWQiLAogICAgICAgIH0gZm9yIGsgaW4ga3dzWzoxMDBdXSkKICAgICAgICBzdC5kYXRhZnJhbWUoZGYsIHVzZV9jb250YWluZXJfd2lkdGg9VHJ1ZSwgaGlkZV9pbmRleD1UcnVlKQoKICAgICMgUmVnaW9uYWwgaW5zaWdodHMgKHNpbXBsaWZpZWQpCiAgICBpZiBrd3M6CiAgICAgICAgc3QubWFya2Rvd24oIi0tLSIpCiAgICAgICAgc3QubWFya2Rvd24oIioqUmVnaW9uYWwgbGFuZ3VhZ2UqKiIpCiAgICAgICAgaGlnaF9mcmVxID0gW2sgZm9yIGsgaW4ga3dzIGlmIGsuZnJlcXVlbmN5ID49IDNdCiAgICAgICAgaWYgaGlnaF9mcmVxOgogICAgICAgICAgICB0b3AgPSBoaWdoX2ZyZXFbMF0KICAgICAgICAgICAgc3QuaW5mbyhmIid7dG9wLmtleXdvcmR9JyBhcHBlYXJzIG9mdGVuIGluIHt0b3AucmVnaW9ufSDigJQgY29uc2lkZXIgZW1waGFzaXppbmcgaXQuIikKCgpkZWYgX2dldF9yZWdpb25zKGNsaWVudCwgZGIsIGNsaWVudF9pZCk6CiAgICByZWdpb25zID0gW2Muc3RyaXAoKSBmb3IgYyBpbiAoY2xpZW50LmNpdGllc19zZXJ2ZWQgb3IgW10pIGlmIGMgYW5kIHN0cihjKS5zdHJpcCgpXQogICAgZm9yIHMgaW4gZGIucXVlcnkoTWFya2V0U25hcHNob3QpLmZpbHRlcihNYXJrZXRTbmFwc2hvdC5jbGllbnRfaWQgPT0gY2xpZW50X2lkKS5hbGwoKToKICAgICAgICBpZiBzLmNpdHkgYW5kIHMuY2l0eS5zdHJpcCgpIGFuZCBzLmNpdHkuc3RyaXAoKSBub3QgaW4gcmVnaW9uczoKICAgICAgICAgICAgcmVnaW9ucy5hcHBlbmQocy5jaXR5LnN0cmlwKCkpCiAgICByZXR1cm4gcmVnaW9ucwoKCmRlZiBfZ2V0X2tleXdvcmRzKGRiLCBjbGllbnRfaWQsIHJlZ2lvbnMpOgogICAgcSA9IGRiLnF1ZXJ5KEtleXdvcmRJbnRlbGxpZ2VuY2UpCiAgICBpZiByZWdpb25zOgogICAgICAgIHEgPSBxLmZpbHRlcihvcl8oS2V5d29yZEludGVsbGlnZW5jZS5jbGllbnRfaWQgPT0gY2xpZW50X2lkLCBLZXl3b3JkSW50ZWxsaWdlbmNlLnJlZ2lvbi5pbl8ocmVnaW9ucykpKQogICAgZWxzZToKICAgICAgICBxID0gcS5maWx0ZXIoS2V5d29yZEludGVsbGlnZW5jZS5jbGllbnRfaWQgPT0gY2xpZW50X2lkKQogICAgcmV0dXJuIHEub3JkZXJfYnkoS2V5d29yZEludGVsbGlnZW5jZS5mcmVxdWVuY3kuZGVzYygpKS5hbGwoKQoKCiMg4pSA4pSA4pSAIFNldHRpbmdzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgAoKZGVmIHBhZ2Vfc2V0dGluZ3MoY2xpZW50X2lkLCBjbGllbnQsIGRiKToKICAgICIiIkJ1c2luZXNzIGluZm8sIHNlcnZpY2VzLCBicmFuZCB2b2ljZS4iIiIKICAgIGNpdHkgPSAoY2xpZW50LmNpdGllc19zZXJ2ZWQgb3IgWyIiXSlbMF0gaWYgY2xpZW50LmNpdGllc19zZXJ2ZWQgZWxzZSAi4oCUIgogICAgcmVuZGVyX3N0YXR1c19yaWJib24oY2xpZW50LCBjaXR5KQoKICAgIHN0LnN1YmhlYWRlcigiU2V0dGluZ3MiKQogICAgd2l0aCBzdC5mb3JtKCJzZXR0aW5ncyIpOgogICAgICAgIGJ1c2luZXNzX25hbWUgPSBzdC50ZXh0X2lucHV0KCJCdXNpbmVzcyBOYW1lIiwgdmFsdWU9Y2xpZW50LmJ1c2luZXNzX25hbWUgb3IgIiIpCiAgICAgICAgd2Vic2l0ZV91cmwgPSBzdC50ZXh0X2lucHV0KCJXZWJzaXRlIFVSTCIsIHZhbHVlPWNsaWVudC53ZWJzaXRlX3VybCBvciAiIikKICAgICAgICBwaG9uZSA9IHN0LnRleHRfaW5wdXQoIlBob25lIiwgdmFsdWU9Y2xpZW50LnBob25lX251bWJlciBvciAiIikKICAgICAgICBjaXRpZXMgPSBzdC50ZXh0X2lucHV0KCJDaXRpZXMgc2VydmVkIChjb21tYS1zZXBhcmF0ZWQpIiwgdmFsdWU9IiwgIi5qb2luKGNsaWVudC5jaXRpZXNfc2VydmVkIG9yIFtdKSwgcGxhY2Vob2xkZXI9IlBob2VuaXgsIFNjb3R0c2RhbGUiKQogICAgICAgIHNlcnZpY2VzID0gc3QudGV4dF9pbnB1dCgiU2VydmljZXMgKGNvbW1hLXNlcGFyYXRlZCkiLCB2YWx1ZT0iLCAiLmpvaW4oY2xpZW50LnNlcnZpY2VzX29mZmVyZWQgb3IgW10pLCBwbGFjZWhvbGRlcj0iSnVuayByZW1vdmFsLCBFc3RhdGUgY2xlYW5vdXQiKQogICAgICAgIHRvbmVfb3B0cyA9IFsiZnJpZW5kbHkiLCAibm8tQlMiLCAicHJlbWl1bSIsICJwcm9mZXNzaW9uYWwiXQogICAgICAgIHRvbmVfaWR4ID0gdG9uZV9vcHRzLmluZGV4KGNsaWVudC5icmFuZF90b25lKSBpZiBjbGllbnQuYnJhbmRfdG9uZSBpbiB0b25lX29wdHMgZWxzZSAwCiAgICAgICAgdG9uZSA9IHN0LnNlbGVjdGJveCgiQnJhbmQgdm9pY2UiLCB0b25lX29wdHMsIGluZGV4PXRvbmVfaWR4KQogICAgICAgIGlmIHN0LmZvcm1fc3VibWl0X2J1dHRvbigiU2F2ZSIpOgogICAgICAgICAgICBjbGllbnQuYnVzaW5lc3NfbmFtZSA9IGJ1c2luZXNzX25hbWUKICAgICAgICAgICAgY2xpZW50LndlYnNpdGVfdXJsID0gd2Vic2l0ZV91cmwgb3IgTm9uZQogICAgICAgICAgICBjbGllbnQucGhvbmVfbnVtYmVyID0gcGhvbmUgb3IgTm9uZQogICAgICAgICAgICBjbGllbnQuY2l0aWVzX3NlcnZlZCA9IFtjLnN0cmlwKCkgZm9yIGMgaW4gY2l0aWVzLnNwbGl0KCIsIikgaWYgYy5zdHJpcCgpXQogICAgICAgICAgICBjbGllbnQuc2VydmljZXNfb2ZmZXJlZCA9IFtzLnN0cmlwKCkgZm9yIHMgaW4gc2VydmljZXMuc3BsaXQoIiwiKSBpZiBzLnN0cmlwKCldCiAgICAgICAgICAgIGNsaWVudC5icmFuZF90b25lID0gdG9uZQogICAgICAgICAgICBkYi5jb21taXQoKQogICAgICAgICAgICBzdC5zdWNjZXNzKCJTZXR0aW5ncyBzYXZlZC4iKQoKICAgIHN0LmRpdmlkZXIoKQogICAgc3QubWFya2Rvd24oIioqUmVmcmVzaCBkYXRhKioiKQogICAgY2l0eV9pbiA9IHN0LnRleHRfaW5wdXQoIkNpdHkgZm9yIHJlc2VhcmNoIiwgdmFsdWU9Y2l0eSwgcGxhY2Vob2xkZXI9IlBob2VuaXggQVoiLCBrZXk9ZiJzZXR0aW5nc19jaXR5X3tjbGllbnRfaWR9IikKICAgIGNvbDEsIGNvbDIsIF8gPSBzdC5jb2x1bW5zKFsxLCAxLCA0XSkKICAgIHdpdGggY29sMToKICAgICAgICBpZiBzdC5idXR0b24oIlJlZnJlc2ggbWFya2V0IGRhdGEiKToKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZVsicnVuX3Jlc2VhcmNoZXIiXSA9IChjbGllbnRfaWQsIGNpdHlfaW4gb3IgY2l0eSkKICAgICAgICAgICAgc3QucmVydW4oKQogICAgd2l0aCBjb2wyOgogICAgICAgIGlmIHN0LmJ1dHRvbigiRmluZCBvcHBvcnR1bml0aWVzIik6CiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGVbInJ1bl9zdHJhdGVnaXN0Il0gPSBjbGllbnRfaWQKICAgICAgICAgICAgc3QucmVydW4oKQoKCiMg4pSA4pSA4pSAIEFkZCBDbGllbnQg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgpkZWYgcGFnZV9hZGRfY2xpZW50KGRiKToKICAgIHN0LnN1YmhlYWRlcigiQWRkIENsaWVudCIpCiAgICBpZiBzdC5idXR0b24oIuKGkCBCYWNrIHRvIGRhc2hib2FyZCIpOgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUucG9wKCJuYXZfYWRkX2NsaWVudCIsIE5vbmUpCiAgICAgICAgc3QucmVydW4oKQogICAgc3QuZGl2aWRlcigpCiAgICB3aXRoIHN0LmZvcm0oIm9uYm9hcmRpbmciKToKICAgICAgICBjbGllbnRfaWQgPSBzdC50ZXh0X2lucHV0KCJDbGllbnQgSUQgKHNsdWcpIiwgcGxhY2Vob2xkZXI9Imp1bmstYXdheS1waG9lbml4IikKICAgICAgICBidXNpbmVzc19uYW1lID0gc3QudGV4dF9pbnB1dCgiQnVzaW5lc3MgTmFtZSIsIHBsYWNlaG9sZGVyPSJKdW5rIEF3YXkgUGhvZW5peCIpCiAgICAgICAgd2Vic2l0ZV91cmwgPSBzdC50ZXh0X2lucHV0KCJXZWJzaXRlIFVSTCIpCiAgICAgICAgcGhvbmUgPSBzdC50ZXh0X2lucHV0KCJQaG9uZSIpCiAgICAgICAgY2l0aWVzID0gc3QudGV4dF9pbnB1dCgiQ2l0aWVzIChjb21tYS1zZXBhcmF0ZWQpIiwgcGxhY2Vob2xkZXI9IlBob2VuaXgsIFNjb3R0c2RhbGUsIFRlbXBlIikKICAgICAgICBzZXJ2aWNlcyA9IHN0LnRleHRfaW5wdXQoIlNlcnZpY2VzIChjb21tYS1zZXBhcmF0ZWQpIiwgcGxhY2Vob2xkZXI9Ikp1bmsgcmVtb3ZhbCwgRXN0YXRlIGNsZWFub3V0IikKICAgICAgICB0b25lID0gc3Quc2VsZWN0Ym94KCJCcmFuZCB2b2ljZSIsIFsiZnJpZW5kbHkiLCAibm8tQlMiLCAicHJlbWl1bSIsICJwcm9mZXNzaW9uYWwiXSkKICAgICAgICBpZiBzdC5mb3JtX3N1Ym1pdF9idXR0b24oIlNhdmUgQ2xpZW50Iik6CiAgICAgICAgICAgIGlmIGNsaWVudF9pZCBhbmQgYnVzaW5lc3NfbmFtZToKICAgICAgICAgICAgICAgIGlmIGRiLnF1ZXJ5KENsaWVudCkuZmlsdGVyKENsaWVudC5jbGllbnRfaWQgPT0gY2xpZW50X2lkKS5maXJzdCgpOgogICAgICAgICAgICAgICAgICAgIHN0Lndhcm5pbmcoIkNsaWVudCBJRCBhbHJlYWR5IGV4aXN0cy4iKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBjbGllbnQgPSBDbGllbnQoCiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudF9pZD1jbGllbnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1c2luZXNzX25hbWU9YnVzaW5lc3NfbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgd2Vic2l0ZV91cmw9d2Vic2l0ZV91cmwgb3IgTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmVfbnVtYmVyPXBob25lIG9yIE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgIGNpdGllc19zZXJ2ZWQ9W2Muc3RyaXAoKSBmb3IgYyBpbiBjaXRpZXMuc3BsaXQoIiwiKSBpZiBjLnN0cmlwKCldLAogICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlc19vZmZlcmVkPVtzLnN0cmlwKCkgZm9yIHMgaW4gc2VydmljZXMuc3BsaXQoIiwiKSBpZiBzLnN0cmlwKCldLAogICAgICAgICAgICAgICAgICAgICAgICBicmFuZF90b25lPXRvbmUsCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGRiLmFkZChjbGllbnQpCiAgICAgICAgICAgICAgICAgICAgZGIuY29tbWl0KCkKICAgICAgICAgICAgICAgICAgICBjaXR5ID0gKGNsaWVudC5jaXRpZXNfc2VydmVkIG9yIFsiIl0pWzBdLnN0cmlwKCkgaWYgY2xpZW50LmNpdGllc19zZXJ2ZWQgZWxzZSBOb25lCiAgICAgICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5wb3AoIm5hdl9hZGRfY2xpZW50IiwgTm9uZSkKICAgICAgICAgICAgICAgICAgICBpZiBjaXR5OgogICAgICAgICAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlWyJydW5fcmVzZWFyY2hlcl9uZXciXSA9IChjbGllbnRfaWQsIGNpdHkpCiAgICAgICAgICAgICAgICAgICAgICAgIHN0LnN1Y2Nlc3MoZiJDbGllbnQgYWRkZWQuIFJlZnJlc2hpbmcgbWFya2V0IGRhdGHigKYiKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHN0LnN1Y2Nlc3MoZiJDbGllbnQgYWRkZWQuIEdvIHRvIE92ZXJ2aWV3IGFuZCBydW4gcmVzZWFyY2ggd2l0aCBhIGNpdHkuIikKICAgICAgICAgICAgICAgICAgICBzdC5yZXJ1bigpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzdC5lcnJvcigiQ2xpZW50IElEIGFuZCBCdXNpbmVzcyBOYW1lIHJlcXVpcmVkLiIpCgoKIyDilIDilIDilIAgTWFpbiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKCmRlZiBtYWluKCk6CiAgICBzdC5zaWRlYmFyLnRpdGxlKCJBZ2VuY3kgQUkiKQogICAgc3Quc2lkZWJhci5jYXB0aW9uKCJPdXRjb21lcyBvdmVyIGFjdGl2aXR5LiIpCgogICAgZGIgPSBTZXNzaW9uTG9jYWwoKQogICAgdHJ5OgogICAgICAgIGNsaWVudHMgPSBkYi5xdWVyeShDbGllbnQpLmFsbCgpCgogICAgICAgICMgUnVuIFJlc2VhcmNoZXIgKGZyb20gU2V0dGluZ3Mgb3IgbmV3IGNsaWVudCkKICAgICAgICBpZiBzdC5zZXNzaW9uX3N0YXRlLmdldCgicnVuX3Jlc2VhcmNoZXIiKToKICAgICAgICAgICAgY2lkLCBjaXR5ID0gc3Quc2Vzc2lvbl9zdGF0ZS5wb3AoInJ1bl9yZXNlYXJjaGVyIikKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZVsiY2xpZW50X3NlbGVjdCJdID0gY2lkICAjIFN0YXkgb24gdGhpcyBjbGllbnQgYWZ0ZXIgcnVuCiAgICAgICAgICAgIHdpdGggc3Quc3RhdHVzKCJSZWZyZXNoaW5nIG1hcmtldCBkYXRh4oCmIik6CiAgICAgICAgICAgICAgICBvaywgXyA9IHJ1bl9yZXNlYXJjaGVyKGNpZCwgY2l0eSkKICAgICAgICAgICAgICAgIGlmIG9rOgogICAgICAgICAgICAgICAgICAgIHN0LnN1Y2Nlc3MoIkRvbmUuIikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc3QuZXJyb3IoIkZhaWxlZC4iKQogICAgICAgICAgICBzdC5yZXJ1bigpCiAgICAgICAgaWYgc3Quc2Vzc2lvbl9zdGF0ZS5nZXQoInJ1bl9yZXNlYXJjaGVyX25ldyIpOgogICAgICAgICAgICBjaWQsIGNpdHkgPSBzdC5zZXNzaW9uX3N0YXRlLnBvcCgicnVuX3Jlc2VhcmNoZXJfbmV3IikKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZVsiY2xpZW50X3NlbGVjdCJdID0gY2lkICAjIFN0YXkgb24gbmV3IGNsaWVudCBhZnRlciBydW4KICAgICAgICAgICAgd2l0aCBzdC5zdGF0dXMoIlJlZnJlc2hpbmcgbWFya2V0IGRhdGHigKYiKToKICAgICAgICAgICAgICAgIHJ1bl9yZXNlYXJjaGVyKGNpZCwgY2l0eSkKICAgICAgICAgICAgc3QucmVydW4oKQoKICAgICAgICAjIFJ1biBTdHJhdGVnaXN0CiAgICAgICAgaWYgc3Quc2Vzc2lvbl9zdGF0ZS5nZXQoInJ1bl9zdHJhdGVnaXN0Iik6CiAgICAgICAgICAgIGNpZCA9IHN0LnNlc3Npb25fc3RhdGUucG9wKCJydW5fc3RyYXRlZ2lzdCIpCiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGVbImNsaWVudF9zZWxlY3QiXSA9IGNpZCAgIyBTdGF5IG9uIHRoaXMgY2xpZW50IGFmdGVyIHJ1bgogICAgICAgICAgICB3aXRoIHN0LnN0YXR1cygiRmluZGluZyBvcHBvcnR1bml0aWVz4oCmIik6CiAgICAgICAgICAgICAgICBvaywgXyA9IHJ1bl9zdHJhdGVnaXN0KGNpZCkKICAgICAgICAgICAgICAgIGlmIG9rOgogICAgICAgICAgICAgICAgICAgIHN0LnN1Y2Nlc3MoIkRvbmUuIikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc3QuZXJyb3IoIkZhaWxlZC4iKQogICAgICAgICAgICBzdC5yZXJ1bigpCgogICAgICAgIGlmIG5vdCBjbGllbnRzOgogICAgICAgICAgICBwYWdlX2FkZF9jbGllbnQoZGIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBjbGllbnRfaWQsIGNsaWVudCA9IGdldF9jbGllbnRfY29udGV4dChjbGllbnRzKQogICAgICAgIGlmIG5vdCBjbGllbnQ6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzdC5zaWRlYmFyLmRpdmlkZXIoKQogICAgICAgIGlmIHN0LnNpZGViYXIuYnV0dG9uKCLinpUgQWRkIE5ldyBDbGllbnQiLCB1c2VfY29udGFpbmVyX3dpZHRoPVRydWUpOgogICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlWyJuYXZfYWRkX2NsaWVudCJdID0gVHJ1ZQogICAgICAgICAgICBzdC5yZXJ1bigpCgogICAgICAgIG5hdiA9IHN0LnNpZGViYXIucmFkaW8oCiAgICAgICAgICAgICJQYWdlIiwKICAgICAgICAgICAgWyLwn4+gIE92ZXJ2aWV3IiwgIvCflI0gTWFya2V0IEludGVsbGlnZW5jZSIsICLwn46vIE9wcG9ydHVuaXRpZXMiLCAi4pyN77iPIENvbnRlbnQgU3R1ZGlvIiwgIvCfk40gU0VPICYgS2V5d29yZHMiLCAi8J+TiiBQZXJmb3JtYW5jZSIsICLimpnvuI8gU2V0dGluZ3MiXSwKICAgICAgICAgICAgbGFiZWxfdmlzaWJpbGl0eT0iY29sbGFwc2VkIiwKICAgICAgICApCgogICAgICAgIGlmIHN0LnNlc3Npb25fc3RhdGUuZ2V0KCJuYXZfYWRkX2NsaWVudCIpOgogICAgICAgICAgICBwYWdlX2FkZF9jbGllbnQoZGIpCiAgICAgICAgZWxpZiBuYXYgPT0gIvCfj6AgT3ZlcnZpZXciOgogICAgICAgICAgICBwYWdlX292ZXJ2aWV3KGNsaWVudF9pZCwgY2xpZW50LCBkYikKICAgICAgICBlbGlmIG5hdiA9PSAi8J+UjSBNYXJrZXQgSW50ZWxsaWdlbmNlIjoKICAgICAgICAgICAgcGFnZV9tYXJrZXRfaW50ZWxsaWdlbmNlKGNsaWVudF9pZCwgY2xpZW50LCBkYikKICAgICAgICBlbGlmIG5hdiA9PSAi8J+OryBPcHBvcnR1bml0aWVzIjoKICAgICAgICAgICAgcGFnZV9vcHBvcnR1bml0aWVzKGNsaWVudF9pZCwgY2xpZW50LCBkYikKICAgICAgICBlbGlmIG5hdiA9PSAi4pyN77iPIENvbnRlbnQgU3R1ZGlvIjoKICAgICAgICAgICAgcGFnZV9jb250ZW50X3N0dWRpbyhjbGllbnRfaWQsIGNsaWVudCwgZGIpCiAgICAgICAgZWxpZiBuYXYgPT0gIvCfk40gU0VPICYgS2V5d29yZHMiOgogICAgICAgICAgICBwYWdlX3Nlb19rZXl3b3JkcyhjbGllbnRfaWQsIGNsaWVudCwgZGIpCiAgICAgICAgZWxpZiBuYXYgPT0gIvCfk4ogUGVyZm9ybWFuY2UiOgogICAgICAgICAgICBzdC5pbmZvKCJQZXJmb3JtYW5jZSB0cmFja2luZyDigJQgY29taW5nIGluIFBoYXNlIDIuIikKICAgICAgICBlbHNlOiAgIyBTZXR0aW5ncwogICAgICAgICAgICBwYWdlX3NldHRpbmdzKGNsaWVudF9pZCwgY2xpZW50LCBkYikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBzdC5lcnJvcihzdHIoZSkpCiAgICAgICAgcmFpc2UKCiAgICBmaW5hbGx5OgogICAgICAgIGRiLmNsb3NlKCkKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg==',
    "agents/__init__.py": 'IyBQaXBlbGluZSBhZ2VudHMg4oCUIFJlc2VhcmNoZXIsIFN0cmF0ZWdpc3QK',
    "agents/tavily_client.py": 'IiIiClRhdmlseSBjbGllbnQg4oCUIGNvbXBldGl0b3IgZGlzY292ZXJ5IGFuZCByZXZpZXctYmFzZWQgZmFsbGJhY2suCgpHdWFyZHM6IG1heF9yZXN1bHRzPTUsIHNlYXJjaF9kZXB0aD1iYXNpYyAobm8gbG9vcHMsIG5vIGFkdmFuY2VkIG9uIG1haW4pLgoiIiIKCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBMaXN0Cgpmcm9tIGNvbmZpZyBpbXBvcnQgKAogICAgREVGQVVMVF9OSUNIRSwKICAgIFRBVklMWV9BUElfS0VZLAogICAgVEFWSUxZX01BWF9SRVNVTFRTLAogICAgVEFWSUxZX1JFVklFV1NfTUFYX1JFU1VMVFMsCiAgICBUQVZJTFlfU0VBUkNIX0RFUFRILAopCgojIFVSTHMgd2hlcmUgd2Ugc2hvdWxkIE5PVCB1c2UgRmlyZWNyYXdsIOKAlCB1c2UgcmV2aWV3cyBpbnN0ZWFkCk5PTl9XRUJTSVRFX0RPTUFJTlMgPSAoCiAgICAiZmFjZWJvb2suY29tIiwgImZiLmNvbSIsICJpbnN0YWdyYW0uY29tIiwgImxpbmtlZGluLmNvbSIsCiAgICAieWVscC5jb20iLCAieW91dHViZS5jb20iLCAidHJpcGFkdmlzb3IuY29tIiwKICAgICJnb29nbGUuY29tL21hcHMiLCAibWFwcy5nb29nbGUuY29tIiwgImdvby5nbC9tYXBzIiwKICAgICJiaW5nLmNvbS9tYXBzIiwgInllbGxvd3BhZ2VzLmNvbSIsICJhbmdpZXNsaXN0LmNvbSIsCiAgICAiaG9tZWFkdmlzb3IuY29tIiwgIm5leHRkb29yLmNvbSIsICJ0aHVtYnRhY2suY29tIiwKKQoKCmRlZiBoYXNfcmVhbF93ZWJzaXRlKHVybDogc3RyKSAtPiBib29sOgogICAgIiIiVHJ1ZSBpZiBVUkwgaXMgYSBzY3JhcGFibGUgYnVzaW5lc3Mgc2l0ZS4gRmFsc2UgZm9yIGxpc3RpbmdzL3Jldmlld3MuIiIiCiAgICBpZiBub3QgdXJsIG9yIGxlbih1cmwpIDwgMTA6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICByZXR1cm4gbm90IGFueShkIGluIHVybC5sb3dlcigpIGZvciBkIGluIE5PTl9XRUJTSVRFX0RPTUFJTlMpCgoKZGVmIGZpbmRfbG9jYWxfY29tcGV0aXRvcnMoCiAgICBidXNpbmVzc190eXBlOiBzdHIsCiAgICBjaXR5OiBzdHIsCiAgICBtYXhfcmVzdWx0czogaW50ID0gTm9uZSwKKSAtPiBMaXN0W0RpY3RdOgogICAgIiIiCiAgICBUYXZpbHkgc2VhcmNoIGZvciBsb2NhbCBjb21wZXRpdG9ycy4KICAgIFJldHVybnMgbGlzdCBvZiB7bmFtZSwgdXJsLCBjb250ZW50fSBkaWN0cy4KICAgIEd1YXJkOiBtYXhfcmVzdWx0cz01LCBzZWFyY2hfZGVwdGg9YmFzaWMuCiAgICAiIiIKICAgIG1heF9yZXN1bHRzID0gbWluKG1heF9yZXN1bHRzIG9yIFRBVklMWV9NQVhfUkVTVUxUUywgVEFWSUxZX01BWF9SRVNVTFRTKQogICAgdHJ5OgogICAgICAgIGZyb20gdGF2aWx5IGltcG9ydCBUYXZpbHlDbGllbnQKICAgICAgICBjbGllbnQgPSBUYXZpbHlDbGllbnQoYXBpX2tleT1UQVZJTFlfQVBJX0tFWSkKICAgICAgICBxdWVyeSA9IGYie2J1c2luZXNzX3R5cGV9IHtjaXR5fSIKICAgICAgICByZXNwb25zZSA9IGNsaWVudC5zZWFyY2goCiAgICAgICAgICAgIHF1ZXJ5LAogICAgICAgICAgICBtYXhfcmVzdWx0cz1tYXhfcmVzdWx0cywKICAgICAgICAgICAgc2VhcmNoX2RlcHRoPVRBVklMWV9TRUFSQ0hfREVQVEgsCiAgICAgICAgKQogICAgICAgIHJlc3VsdHMgPSBbXQogICAgICAgIGlmIGlzaW5zdGFuY2UocmVzcG9uc2UsIGRpY3QpOgogICAgICAgICAgICByZXN1bHRzID0gcmVzcG9uc2UuZ2V0KCJyZXN1bHRzIiwgW10pCiAgICAgICAgZWxpZiBoYXNhdHRyKHJlc3BvbnNlLCAicmVzdWx0cyIpOgogICAgICAgICAgICByZXN1bHRzID0gZ2V0YXR0cihyZXNwb25zZSwgInJlc3VsdHMiLCBOb25lKSBvciBbXQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHJlc3VsdHMsIGxpc3QpOgogICAgICAgICAgICByZXR1cm4gW10KCiAgICAgICAgY29tcGV0aXRvcnMgPSBbXQogICAgICAgIHNlZW4gPSBzZXQoKQogICAgICAgIGZvciByIGluIHJlc3VsdHM6CiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHIsIGRpY3QpOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgbmFtZSA9IChyLmdldCgidGl0bGUiKSBvciByLmdldCgibmFtZSIpIG9yICIiKS5zdHJpcCgpCiAgICAgICAgICAgIHVybCA9IChyLmdldCgidXJsIikgb3Igci5nZXQoImxpbmsiKSBvciAiIikuc3RyaXAoKQogICAgICAgICAgICBjb250ZW50ID0gKHIuZ2V0KCJjb250ZW50Iikgb3Igci5nZXQoInNuaXBwZXQiKSBvciAiIikuc3RyaXAoKQogICAgICAgICAgICBpZiBuYW1lIGFuZCBuYW1lIG5vdCBpbiBzZWVuOgogICAgICAgICAgICAgICAgc2Vlbi5hZGQobmFtZSkKICAgICAgICAgICAgICAgIGNvbXBldGl0b3JzLmFwcGVuZCh7Im5hbWUiOiBuYW1lLCAidXJsIjogdXJsLCAiY29udGVudCI6IGNvbnRlbnR9KQogICAgICAgIHJldHVybiBjb21wZXRpdG9ycwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHJldHVybiBbXQoKCmRlZiBnZXRfc2VydmljZXNfZnJvbV9yZXZpZXdzKGNvbXBldGl0b3JfbmFtZTogc3RyLCBjaXR5OiBzdHIsIG5pY2hlOiBzdHIgPSBOb25lKSAtPiBzdHI6CiAgICAiIiIKICAgIFRhdmlseSBzZWFyY2ggZm9yIHJldmlld3Mgd2hlbiBjb21wZXRpdG9yIGhhcyBubyBzY3JhcGFibGUgd2Vic2l0ZS4KICAgIFJldHVybnMgcmF3IHRleHQgZnJvbSByZXZpZXcgc25pcHBldHMuCiAgICBHdWFyZDogbWF4X3Jlc3VsdHM9Miwgc2VhcmNoX2RlcHRoPWJhc2ljIChmYWxsYmFjayBvbmx5KS4KICAgICIiIgogICAgdHJ5OgogICAgICAgIGZyb20gdGF2aWx5IGltcG9ydCBUYXZpbHlDbGllbnQKICAgICAgICBjbGllbnQgPSBUYXZpbHlDbGllbnQoYXBpX2tleT1UQVZJTFlfQVBJX0tFWSkKICAgICAgICBuaWNoZSA9IG5pY2hlIG9yIERFRkFVTFRfTklDSEUKICAgICAgICBxdWVyeSA9IGYnIntjb21wZXRpdG9yX25hbWV9IiB7bmljaGV9IHJldmlld3MnCiAgICAgICAgcmVzcG9uc2UgPSBjbGllbnQuc2VhcmNoKAogICAgICAgICAgICBxdWVyeSwKICAgICAgICAgICAgbWF4X3Jlc3VsdHM9VEFWSUxZX1JFVklFV1NfTUFYX1JFU1VMVFMsCiAgICAgICAgICAgIHNlYXJjaF9kZXB0aD1UQVZJTFlfU0VBUkNIX0RFUFRILAogICAgICAgICkKICAgICAgICByZXN1bHRzID0gW10KICAgICAgICBpZiBpc2luc3RhbmNlKHJlc3BvbnNlLCBkaWN0KToKICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmdldCgicmVzdWx0cyIsIFtdKQogICAgICAgIGVsaWYgaGFzYXR0cihyZXNwb25zZSwgInJlc3VsdHMiKToKICAgICAgICAgICAgcmVzdWx0cyA9IGdldGF0dHIocmVzcG9uc2UsICJyZXN1bHRzIiwgTm9uZSkgb3IgW10KICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShyZXN1bHRzLCBsaXN0KToKICAgICAgICAgICAgcmV0dXJuICIiCgogICAgICAgIHBhcnRzID0gW10KICAgICAgICBmb3IgciBpbiByZXN1bHRzOgogICAgICAgICAgICBjID0gci5nZXQoImNvbnRlbnQiLCByLmdldCgic25pcHBldCIsICIiKSkKICAgICAgICAgICAgaWYgYzoKICAgICAgICAgICAgICAgIHBhcnRzLmFwcGVuZChzdHIoYykpCiAgICAgICAgcmV0dXJuICIgIi5qb2luKHBhcnRzKS5zdHJpcCgpIGlmIHBhcnRzIGVsc2UgIiIKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICByZXR1cm4gIiIK',
    "agents/firecrawl_client.py": 'IiIiCkZpcmVjcmF3bCBjbGllbnQg4oCUIHNjcmFwZSBvbmx5LiBOZXZlciB1c2VkIGZvciBGYWNlYm9vaywgR29vZ2xlIE1hcHMsIFllbHAsIGV0Yy4KCkd1YXJkczogb25seU1haW5Db250ZW50PVRydWUsIHRpbWVvdXQ9MzBzLCBza2lwIHNvY2lhbC9tYXBzIFVSTHMuCiIiIgoKaW1wb3J0IHJlcXVlc3RzCgpmcm9tIGNvbmZpZyBpbXBvcnQgRklSRUNSQVdMX0FQSV9LRVksIEZJUkVDUkFXTF9USU1FT1VUCgpGSVJFQ1JBV0xfQkFTRV9VUkwgPSAiaHR0cHM6Ly9hcGkuZmlyZWNyYXdsLmRldi92MS9zY3JhcGUiCgpIRUFERVJTID0gewogICAgIkF1dGhvcml6YXRpb24iOiBmIkJlYXJlciB7RklSRUNSQVdMX0FQSV9LRVl9IiwKICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCn0KCiMgQmxvY2sgYmFkIFVSTHMgZWFybHkg4oCUIEZpcmVjcmF3bCBzaG91bGQgbmV2ZXIgdG91Y2ggbGlzdGluZ3MvcmV2aWV3cwpCTE9DS0VEX0RPTUFJTlMgPSBbCiAgICAiZmFjZWJvb2suY29tIiwgImZiLmNvbSIsICJpbnN0YWdyYW0uY29tIiwgInllbHAuY29tIiwKICAgICJnb29nbGUuY29tL21hcHMiLCAibWFwcy5nb29nbGUuY29tIiwgImdvby5nbC9tYXBzIiwKICAgICJsaW5rZWRpbi5jb20iLCAieW91dHViZS5jb20iLCAidHJpcGFkdmlzb3IuY29tIiwKICAgICJiaW5nLmNvbS9tYXBzIiwgInllbGxvd3BhZ2VzLmNvbSIsICJhbmdpZXNsaXN0LmNvbSIsCiAgICAiaG9tZWFkdmlzb3IuY29tIiwgIm5leHRkb29yLmNvbSIsICJ0aHVtYnRhY2suY29tIiwKXQoKCmRlZiBpc19zdXBwb3J0ZWRfdXJsKHVybDogc3RyKSAtPiBib29sOgogICAgIiIiVHJ1ZSBpZiBVUkwgaXMgYSBzY3JhcGFibGUgYnVzaW5lc3Mgc2l0ZS4gRmFsc2UgZm9yIGxpc3RpbmdzL3Jldmlld3MuIiIiCiAgICBpZiBub3QgdXJsIG9yIGxlbih1cmwpIDwgMTA6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICByZXR1cm4gbm90IGFueShkb21haW4gaW4gdXJsLmxvd2VyKCkgZm9yIGRvbWFpbiBpbiBCTE9DS0VEX0RPTUFJTlMpCgoKZGVmIGZpcmVjcmF3bF9zY3JhcGUodXJsOiBzdHIsIHRpbWVvdXQ6IGludCA9IE5vbmUpIC0+IGRpY3Q6CiAgICAiIiIKICAgIFNjcmFwZXMgYSBzaW5nbGUgYnVzaW5lc3Mgd2Vic2l0ZSB1c2luZyBGaXJlY3Jhd2wuCiAgICBSZXR1cm5zIGRpY3Qgd2l0aDoKICAgICAgLSBzdWNjZXNzIChib29sKQogICAgICAtIGNvbnRlbnQgKG1hcmtkb3duIHRleHQgb3IgZXJyb3IgcmVhc29uKQogICAgICAtIHNvdXJjZSAoZmlyZWNyYXdsKQogICAgIiIiCiAgICBpZiBub3QgdXJsIG9yIG5vdCBpc19zdXBwb3J0ZWRfdXJsKHVybCk6CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgInN1Y2Nlc3MiOiBGYWxzZSwKICAgICAgICAgICAgImNvbnRlbnQiOiAiVW5zdXBwb3J0ZWQgb3IgbWlzc2luZyB3ZWJzaXRlIFVSTCIsCiAgICAgICAgICAgICJzb3VyY2UiOiAiZmlyZWNyYXdsIiwKICAgICAgICB9CgogICAgcGF5bG9hZCA9IHsKICAgICAgICAidXJsIjogdXJsLAogICAgICAgICJmb3JtYXRzIjogWyJtYXJrZG93biJdLAogICAgICAgICJvbmx5TWFpbkNvbnRlbnQiOiBUcnVlLCAgIyBHdWFyZDogcmVkdWNlIHBheWxvYWQsIG5vIGZ1bGwgSFRNTAogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoCiAgICAgICAgICAgIEZJUkVDUkFXTF9CQVNFX1VSTCwKICAgICAgICAgICAgaGVhZGVycz1IRUFERVJTLAogICAgICAgICAgICBqc29uPXBheWxvYWQsCiAgICAgICAgICAgIHRpbWVvdXQ9dGltZW91dCBvciBGSVJFQ1JBV0xfVElNRU9VVCwKICAgICAgICApCgogICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlICE9IDIwMDoKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICJzdWNjZXNzIjogRmFsc2UsCiAgICAgICAgICAgICAgICAiY29udGVudCI6IGYiRmlyZWNyYXdsIGVycm9yOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9IiwKICAgICAgICAgICAgICAgICJzb3VyY2UiOiAiZmlyZWNyYXdsIiwKICAgICAgICAgICAgfQoKICAgICAgICBkYXRhID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAgbWFya2Rvd24gPSBkYXRhLmdldCgiZGF0YSIsIHt9KS5nZXQoIm1hcmtkb3duIiwgIiIpLnN0cmlwKCkKCiAgICAgICAgaWYgbm90IG1hcmtkb3duOgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBGYWxzZSwKICAgICAgICAgICAgICAgICJjb250ZW50IjogIkVtcHR5IHNjcmFwZSByZXN1bHQiLAogICAgICAgICAgICAgICAgInNvdXJjZSI6ICJmaXJlY3Jhd2wiLAogICAgICAgICAgICB9CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJzdWNjZXNzIjogVHJ1ZSwKICAgICAgICAgICAgImNvbnRlbnQiOiBtYXJrZG93biwKICAgICAgICAgICAgInNvdXJjZSI6ICJmaXJlY3Jhd2wiLAogICAgICAgIH0KCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5UaW1lb3V0OgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJzdWNjZXNzIjogRmFsc2UsCiAgICAgICAgICAgICJjb250ZW50IjogIkZpcmVjcmF3bCB0aW1lb3V0IiwKICAgICAgICAgICAgInNvdXJjZSI6ICJmaXJlY3Jhd2wiLAogICAgICAgIH0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAic3VjY2VzcyI6IEZhbHNlLAogICAgICAgICAgICAiY29udGVudCI6IGYiRmlyZWNyYXdsIGV4Y2VwdGlvbjoge3N0cihlKX0iLAogICAgICAgICAgICAic291cmNlIjogImZpcmVjcmF3bCIsCiAgICAgICAgfQo=',
    "agents/ollama_client.py": 'IiIiCk9sbGFtYSBTdW1tYXJpemVyIOKAlCBmYWN0dWFsIGV4dHJhY3Rpb24gb25seS4gTm8gZ3Vlc3NpbmcuCgpHdWFyZHM6IHNpbmdsZS1wYXNzLCB0aW1lb3V0PTQ1cywgbm8gc3RyZWFtaW5nLCBubyByZXRyaWVzIChmYWlsIGZhc3QpLgoiIiIKCmltcG9ydCByZQppbXBvcnQgcmVxdWVzdHMKCmZyb20gY29uZmlnIGltcG9ydCBPTExBTUFfTU9ERUwsIE9MTEFNQV9VUkwsIE9MTEFNQV9USU1FT1VULCBPTExBTUFfU1RSRUFNCgpPTExBTUFfR0VORVJBVEVfVVJMID0gZiJ7T0xMQU1BX1VSTC5yc3RyaXAoJy8nKX0vYXBpL2dlbmVyYXRlIgoKCmRlZiBzdW1tYXJpemVfc2VydmljZXMocmF3X3RleHQ6IHN0ciwgY29tcGV0aXRvcl9uYW1lOiBzdHIpIC0+IHN0cjoKICAgICIiIgogICAgU2VuZHMgY29tcGV0aXRvciB0ZXh0IHRvIGxvY2FsIE9sbGFtYSBhbmQgZXh0cmFjdHMgc2VydmljZXMgKyBwb3NpdGlvbmluZy4KICAgIFJldHVybnMgc3RydWN0dXJlZCBidWxsZXQgb3V0cHV0LiBFeHRyYWN0IG9ubHkgd2hhdCBpcyBleHBsaWNpdGx5IHN0YXRlZC4KICAgICIiIgoKICAgIHByb21wdCA9IGYiIiIKWW91IGFyZSBhIGZhY3R1YWwgbWFya2V0IHJlc2VhcmNoIGFuYWx5c3QuCgpZb3VyIHRhc2s6CkV4dHJhY3QgT05MWSB3aGF0IGlzIGV4cGxpY2l0bHkgc3RhdGVkIGluIHRoZSB0ZXh0IGJlbG93LgpETyBOT1QgZ3Vlc3MuCkRPIE5PVCBpbnZlbnQgc2VydmljZXMuCkRPIE5PVCBhc3N1bWUgcHJpY2luZy4KCk91dHB1dCBmb3JtYXQgKGV4YWN0bHkpOgoKQ09NUEVUSVRPUjoge2NvbXBldGl0b3JfbmFtZX0KClNFUlZJQ0VTIE9GRkVSRUQ6Ci0gQnVsbGV0IGxpc3Qgb2Ygc2VydmljZXMKClBSSUNJTkcgTUVOVElPTlM6Ci0gQnVsbGV0IGxpc3QgKG9yICJOb3QgbWVudGlvbmVkIikKClBPU0lUSU9OSU5HIC8gQ0xBSU1TOgotIEJ1bGxldCBsaXN0IChzcGVlZCwgc2FtZS1kYXksIGVjby1mcmllbmRseSwgZXRjLikKCkNPTVBMQUlOVFMgLyBHQVBTIChmcm9tIHJldmlld3Mgb3Igd2VhayBhcmVhcyk6Ci0gQnVsbGV0IGxpc3QgKG9yICJOb25lIGZvdW5kIikKCk5PVEVTOgotIElmIGRhdGEgaXMgd2VhayBvciB1bmNsZWFyLCBzYXkgd2h5LgoKVEVYVCBUTyBBTkFMWVpFOgpcIlwiXCIKe3Jhd190ZXh0Wzo0MDAwXX0KXCJcIlwiCiIiIgoKICAgIHBheWxvYWQgPSB7CiAgICAgICAgIm1vZGVsIjogT0xMQU1BX01PREVMLAogICAgICAgICJwcm9tcHQiOiBwcm9tcHQsCiAgICAgICAgInN0cmVhbSI6IE9MTEFNQV9TVFJFQU0sICAjIEd1YXJkOiBubyBzdHJlYW1pbmcKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KAogICAgICAgICAgICBPTExBTUFfR0VORVJBVEVfVVJMLAogICAgICAgICAgICBqc29uPXBheWxvYWQsCiAgICAgICAgICAgIHRpbWVvdXQ9T0xMQU1BX1RJTUVPVVQsICAjIEd1YXJkOiA0NXMgaGFyZCBsaW1pdAogICAgICAgICkKICAgICAgICByZXNwb25zZS5yYWlzZV9mb3Jfc3RhdHVzKCkKICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpLmdldCgicmVzcG9uc2UiLCAiIikuc3RyaXAoKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHJldHVybiBmIk9sbGFtYSBzdW1tYXJpemF0aW9uIGZhaWxlZDoge3N0cihlKX0iCgoKZGVmIHBhcnNlX3N1bW1hcnlfdG9fZmllbGRzKHN1bW1hcnk6IHN0cikgLT4gZGljdDoKICAgICIiIgogICAgUGFyc2VzIHN1bW1hcml6ZV9zZXJ2aWNlcyBvdXRwdXQgaW50byBSZXNlYXJjaExvZyBmaWVsZHMuCiAgICBSZXR1cm5zIHtleHRyYWN0ZWRfc2VydmljZXMsIHByaWNpbmdfbWVudGlvbnMsIGNvbXBsYWludHMsIG1pc3NlZF9vcHBvcnR1bml0aWVzfS4KICAgICIiIgoKICAgIGRlZiBleHRyYWN0X2J1bGxldHModGV4dDogc3RyLCBzZWN0aW9uOiBzdHIpIC0+IGxpc3Q6CiAgICAgICAgIiIiRXh0cmFjdCBidWxsZXQgaXRlbXMgZnJvbSBhIHNlY3Rpb24uIiIiCiAgICAgICAgcGF0dGVybiA9IHJmIntyZS5lc2NhcGUoc2VjdGlvbil9OlxzKlxuKC4qPykoPz1cbltBLVpdW0EtWmEtei8gXSs6fFxaKSIKICAgICAgICBtID0gcmUuc2VhcmNoKHBhdHRlcm4sIHRleHQsIHJlLkRPVEFMTCB8IHJlLklHTk9SRUNBU0UpCiAgICAgICAgaWYgbm90IG06CiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIGJsb2NrID0gbS5ncm91cCgxKS5zdHJpcCgpCiAgICAgICAgaXRlbXMgPSBbXQogICAgICAgIGZvciBsaW5lIGluIGJsb2NrLnNwbGl0KCJcbiIpOgogICAgICAgICAgICBsaW5lID0gbGluZS5zdHJpcCgpCiAgICAgICAgICAgIGlmIGxpbmUuc3RhcnRzd2l0aCgiLSIpOgogICAgICAgICAgICAgICAgaXRlbSA9IGxpbmVbMTpdLnN0cmlwKCkKICAgICAgICAgICAgICAgIGlmIGl0ZW0gYW5kIGl0ZW0ubG93ZXIoKSBub3QgaW4gKCJub3QgbWVudGlvbmVkIiwgIm5vbmUgZm91bmQiLCAibi9hIik6CiAgICAgICAgICAgICAgICAgICAgaXRlbXMuYXBwZW5kKGl0ZW0pCiAgICAgICAgcmV0dXJuIGl0ZW1zCgogICAgc2VydmljZXMgPSBleHRyYWN0X2J1bGxldHMoc3VtbWFyeSwgIlNFUlZJQ0VTIE9GRkVSRUQiKQogICAgcHJpY2luZyA9IGV4dHJhY3RfYnVsbGV0cyhzdW1tYXJ5LCAiUFJJQ0lORyBNRU5USU9OUyIpCiAgICBjb21wbGFpbnRzID0gZXh0cmFjdF9idWxsZXRzKHN1bW1hcnksICJDT01QTEFJTlRTIC8gR0FQUyIpCiAgICBtaXNzZWQgPSBjb21wbGFpbnRzICAjIEdhcHMgPSBtaXNzZWQgb3Bwb3J0dW5pdGllcyBmb3Igb3VyIGNsaWVudAoKICAgIHJldHVybiB7CiAgICAgICAgImV4dHJhY3RlZF9zZXJ2aWNlcyI6IHNlcnZpY2VzLAogICAgICAgICJwcmljaW5nX21lbnRpb25zIjogcHJpY2luZywKICAgICAgICAiY29tcGxhaW50cyI6IGNvbXBsYWludHMsCiAgICAgICAgIm1pc3NlZF9vcHBvcnR1bml0aWVzIjogbWlzc2VkLAogICAgfQo=',
    "agents/keyword_extractor.py": 'IiIiCktleXdvcmQgRXh0cmFjdG9yIOKAlCBsaWdodHdlaWdodCBleHRyYWN0aW9uIGZyb20gdGV4dC4KUnVucyBhZnRlciBGaXJlY3Jhd2wgKyBPbGxhbWEgc3VtbWFyaXphdGlvbi4KRXh0cmFjdHMga2V5d29yZHMsIHN0b3JlcyBpbiBrZXl3b3JkX2ludGVsbGlnZW5jZS4gTm8gZW1iZWRkaW5ncy4gU3RydWN0dXJlZCBvbmx5LgoiIiIKCmltcG9ydCByZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdCwgT3B0aW9uYWwKCmZyb20gZGF0YWJhc2UgaW1wb3J0IEtleXdvcmRJbnRlbGxpZ2VuY2UsIFNlc3Npb25Mb2NhbAoKU1RPUFdPUkRTID0gZnJvemVuc2V0KFsKICAgICJ0aGUiLCAiYW5kIiwgImZvciIsICJ3aXRoIiwgInRoYXQiLCAidGhpcyIsICJmcm9tIiwgInlvdXIiLAogICAgImFyZSIsICJ3YXMiLCAiaGF2ZSIsICJoYXMiLCAieW91IiwgIm5vdCIsICJidXQiLCAidGhleSIsCiAgICAiYWxsIiwgImNhbiIsICJoZXIiLCAiaGlzIiwgImJlZW4iLCAiaGFzIiwgImhhZCIsICJpdHMiLAogICAgIm91ciIsICJvdXQiLCAid2hvIiwgImhvdyIsICJ3aHkiLCAid2hhdCIsICJ3aGVuIiwgIndoZXJlIiwKXSkKCgpkZWYgZXh0cmFjdF9rZXl3b3Jkcyh0ZXh0X2Jsb2I6IHN0cikgLT4gTGlzdFtzdHJdOgogICAgIiIiRXh0cmFjdCBhbHBoYW51bWVyaWMgd29yZHMgMysgY2hhcnMsIGxvd2VyY2FzZSwgZXhjbHVkaW5nIHN0b3B3b3Jkcy4iIiIKICAgIGlmIG5vdCB0ZXh0X2Jsb2Igb3Igbm90IGlzaW5zdGFuY2UodGV4dF9ibG9iLCBzdHIpOgogICAgICAgIHJldHVybiBbXQogICAgd29yZHMgPSByZS5maW5kYWxsKHIiXGJbYS16QS1aXXszLH1cYiIsIHRleHRfYmxvYi5sb3dlcigpKQogICAgcmV0dXJuIFt3IGZvciB3IGluIHdvcmRzIGlmIHcgbm90IGluIFNUT1BXT1JEU10KCgpkZWYgc3RvcmVfa2V5d29yZHMoCiAgICBrZXl3b3JkczogTGlzdFtzdHJdLAogICAgcmVnaW9uOiBzdHIsCiAgICBzb3VyY2U6IHN0ciwKICAgIGNsaWVudF9pZDogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICBrZXl3b3JkX3R5cGU6IE9wdGlvbmFsW3N0cl0gPSBOb25lLAopIC0+IGludDoKICAgICIiIgogICAgVXBzZXJ0IGtleXdvcmRzIGludG8ga2V5d29yZF9pbnRlbGxpZ2VuY2UuCiAgICBPbiAoa2V5d29yZCwgcmVnaW9uKSBjb25mbGljdDogaW5jcmVtZW50IGZyZXF1ZW5jeSwgdXBkYXRlIGxhc3Rfc2Vlbi4KICAgIFJldHVybnMgY291bnQgb2Yga2V5d29yZHMgcHJvY2Vzc2VkLgogICAgIiIiCiAgICBpZiBub3Qga2V5d29yZHMgb3Igbm90IHJlZ2lvbiBvciBub3Qgc291cmNlOgogICAgICAgIHJldHVybiAwCgogICAgIyBEZWR1cGUgdG8gYXZvaWQgdW5pcXVlIGNvbnN0cmFpbnQgd2hlbiBzYW1lIGtleXdvcmQgYXBwZWFycyBtdWx0aXBsZSB0aW1lcyBpbiBiYXRjaAogICAgdW5pcXVlX2tleXdvcmRzID0gbGlzdChkaWN0LmZyb21rZXlzKGtleXdvcmRzKSkKCiAgICBkYiA9IFNlc3Npb25Mb2NhbCgpCiAgICB0cnk6CiAgICAgICAgY291bnQgPSAwCiAgICAgICAgZm9yIGt3IGluIHVuaXF1ZV9rZXl3b3JkczoKICAgICAgICAgICAgZXhpc3RpbmcgPSBkYi5xdWVyeShLZXl3b3JkSW50ZWxsaWdlbmNlKS5maWx0ZXIoCiAgICAgICAgICAgICAgICBLZXl3b3JkSW50ZWxsaWdlbmNlLmtleXdvcmQgPT0ga3csCiAgICAgICAgICAgICAgICBLZXl3b3JkSW50ZWxsaWdlbmNlLnJlZ2lvbiA9PSByZWdpb24sCiAgICAgICAgICAgICkuZmlyc3QoKQoKICAgICAgICAgICAgbm93ID0gZGF0ZXRpbWUudXRjbm93KCkKICAgICAgICAgICAgaWYgZXhpc3Rpbmc6CiAgICAgICAgICAgICAgICBleGlzdGluZy5mcmVxdWVuY3kgKz0gMQogICAgICAgICAgICAgICAgZXhpc3RpbmcubGFzdF9zZWVuID0gbm93CiAgICAgICAgICAgICAgICBpZiBrZXl3b3JkX3R5cGU6CiAgICAgICAgICAgICAgICAgICAgZXhpc3Rpbmcua2V5d29yZF90eXBlID0ga2V5d29yZF90eXBlCiAgICAgICAgICAgICAgICBpZiBjbGllbnRfaWQ6CiAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmcuY2xpZW50X2lkID0gY2xpZW50X2lkCiAgICAgICAgICAgICAgICBleGlzdGluZy5zb3VyY2UgPSBzb3VyY2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGRiLmFkZChLZXl3b3JkSW50ZWxsaWdlbmNlKAogICAgICAgICAgICAgICAgICAgIGtleXdvcmQ9a3csCiAgICAgICAgICAgICAgICAgICAga2V5d29yZF90eXBlPWtleXdvcmRfdHlwZSwKICAgICAgICAgICAgICAgICAgICByZWdpb249cmVnaW9uLAogICAgICAgICAgICAgICAgICAgIHNvdXJjZT1zb3VyY2UsCiAgICAgICAgICAgICAgICAgICAgY2xpZW50X2lkPWNsaWVudF9pZCwKICAgICAgICAgICAgICAgICAgICBmcmVxdWVuY3k9MSwKICAgICAgICAgICAgICAgICAgICBmaXJzdF9zZWVuPW5vdywKICAgICAgICAgICAgICAgICAgICBsYXN0X3NlZW49bm93LAogICAgICAgICAgICAgICAgKSkKICAgICAgICAgICAgY291bnQgKz0gMQogICAgICAgIGRiLmNvbW1pdCgpCiAgICAgICAgcmV0dXJuIGNvdW50CiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIGRiLnJvbGxiYWNrKCkKICAgICAgICByYWlzZQogICAgZmluYWxseToKICAgICAgICBkYi5jbG9zZSgpCgoKZGVmIGV4dHJhY3RfYW5kX3N0b3JlKAogICAgdGV4dF9ibG9iOiBzdHIsCiAgICByZWdpb246IHN0ciwKICAgIHNvdXJjZTogc3RyLAogICAgY2xpZW50X2lkOiBPcHRpb25hbFtzdHJdID0gTm9uZSwKICAgIGtleXdvcmRfdHlwZTogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCikgLT4gaW50OgogICAgIiIiRXh0cmFjdCBrZXl3b3JkcyBmcm9tIHRleHQgYW5kIHN0b3JlLiBSZXR1cm5zIGNvdW50IHN0b3JlZC4iIiIKICAgIGtleXdvcmRzID0gZXh0cmFjdF9rZXl3b3Jkcyh0ZXh0X2Jsb2IpCiAgICByZXR1cm4gc3RvcmVfa2V5d29yZHMoa2V5d29yZHMsIHJlZ2lvbiwgc291cmNlLCBjbGllbnRfaWQsIGtleXdvcmRfdHlwZSkK',
    "agents/keyword_classifier.py": 'IiIiCktleXdvcmQgQ2xhc3NpZmllciDigJQgTExNLWJhc2VkIGNsYXNzaWZpY2F0aW9uIG9mIGtleXdvcmRzLgpSdW5zIG9uY2UgcGVyIHJlc2VhcmNoIGJhdGNoLCBwZXIgY2l0eSwgcGVyIHdlZWssIG9yIG1hbnVhbGx5LgpDbGFzc2lmaWVzIGludG86IHNlcnZpY2UgfCBnZW8gfCBtb2RpZmllciB8IGxvbmdfdGFpbCB8IGJyYW5kClVzZXMgT2xsYW1hIGZpcnN0IChmcmVlKSwgQ2xhdWRlIGZhbGxiYWNrLgoiIiIKCmltcG9ydCBqc29uCmltcG9ydCBsb2dnaW5nCmltcG9ydCByZQppbXBvcnQgcmVxdWVzdHMKZnJvbSB0eXBpbmcgaW1wb3J0IENhbGxhYmxlLCBEaWN0LCBMaXN0LCBPcHRpb25hbAoKZnJvbSBjb25maWcgaW1wb3J0ICgKICAgIEFOVEhST1BJQ19BUElfS0VZLAogICAgQU5USFJPUElDX01PREVMLAogICAgQU5USFJPUElDX1VSTCwKICAgIEtFWVdPUkRfQ0xBU1NJRklFUl9MT0csCiAgICBPTExBTUFfTU9ERUwsCiAgICBPTExBTUFfVVJMLAopCmZyb20gZGF0YWJhc2UgaW1wb3J0IEtleXdvcmRJbnRlbGxpZ2VuY2UsIFNlc3Npb25Mb2NhbAoKVkFMSURfVFlQRVMgPSBmcm96ZW5zZXQoeyJzZXJ2aWNlIiwgImdlbyIsICJtb2RpZmllciIsICJsb25nX3RhaWwiLCAiYnJhbmQifSkKQkFUQ0hfU0laRSA9IDQwICAjIEtleXdvcmRzIHBlciBMTE0gY2FsbAoKbG9nZ2luZy5iYXNpY0NvbmZpZygKICAgIGxldmVsPWxvZ2dpbmcuSU5GTywKICAgIGZvcm1hdD0iJShhc2N0aW1lKXMgWyUobGV2ZWxuYW1lKXNdICUobWVzc2FnZSlzIiwKICAgIGhhbmRsZXJzPVtsb2dnaW5nLkZpbGVIYW5kbGVyKEtFWVdPUkRfQ0xBU1NJRklFUl9MT0cpLCBsb2dnaW5nLlN0cmVhbUhhbmRsZXIoKV0sCikKbG9nID0gbG9nZ2luZy5nZXRMb2dnZXIoX19uYW1lX18pCgoKZGVmIF9jYWxsX29sbGFtYShwcm9tcHQ6IHN0cikgLT4gc3RyOgogICAgIiIiQ2FsbCBsb2NhbCBPbGxhbWEuIFJldHVybnMgZW1wdHkgc3RyaW5nIG9uIGZhaWx1cmUuIiIiCiAgICB0cnk6CiAgICAgICAgbG9nLmluZm8oIktleXdvcmQgY2xhc3NpZmllcjogdHJ5aW5nIE9sbGFtYSAobG9jYWwsIG5vIGNvc3QpIikKICAgICAgICByZXNwID0gcmVxdWVzdHMucG9zdCgKICAgICAgICAgICAgZiJ7T0xMQU1BX1VSTH0vYXBpL2dlbmVyYXRlIiwKICAgICAgICAgICAganNvbj17Im1vZGVsIjogT0xMQU1BX01PREVMLCAicHJvbXB0IjogcHJvbXB0LCAic3RyZWFtIjogRmFsc2V9LAogICAgICAgICAgICB0aW1lb3V0PTkwLAogICAgICAgICkKICAgICAgICByZXNwLnJhaXNlX2Zvcl9zdGF0dXMoKQogICAgICAgIHJldHVybiByZXNwLmpzb24oKS5nZXQoInJlc3BvbnNlIiwgIiIpLnN0cmlwKCkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2cud2FybmluZyhmIk9sbGFtYSBmYWlsZWQ6IHtlfSIpCiAgICAgICAgcmV0dXJuICIiCgoKZGVmIF9jYWxsX2NsYXVkZShwcm9tcHQ6IHN0cikgLT4gc3RyOgogICAgIiIiQ2FsbCBDbGF1ZGUgdmlhIEFudGhyb3BpYyBBUEkuIiIiCiAgICBsb2cuaW5mbygiS2V5d29yZCBjbGFzc2lmaWVyOiBmYWxsaW5nIGJhY2sgdG8gQ2xhdWRlIikKICAgIHJlc3AgPSByZXF1ZXN0cy5wb3N0KAogICAgICAgIEFOVEhST1BJQ19VUkwsCiAgICAgICAgaGVhZGVycz17CiAgICAgICAgICAgICJ4LWFwaS1rZXkiOiBBTlRIUk9QSUNfQVBJX0tFWSwKICAgICAgICAgICAgImFudGhyb3BpYy12ZXJzaW9uIjogIjIwMjMtMDYtMDEiLAogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgIH0sCiAgICAgICAganNvbj17CiAgICAgICAgICAgICJtb2RlbCI6IEFOVEhST1BJQ19NT0RFTCwKICAgICAgICAgICAgIm1heF90b2tlbnMiOiAxMDI0LAogICAgICAgICAgICAibWVzc2FnZXMiOiBbeyJyb2xlIjogInVzZXIiLCAiY29udGVudCI6IHByb21wdH1dLAogICAgICAgIH0sCiAgICAgICAgdGltZW91dD02MCwKICAgICkKICAgIHJlc3AucmFpc2VfZm9yX3N0YXR1cygpCiAgICBibG9ja3MgPSByZXNwLmpzb24oKS5nZXQoImNvbnRlbnQiLCBbXSkKICAgIHJldHVybiAiIi5qb2luKGIuZ2V0KCJ0ZXh0IiwgIiIpIGZvciBiIGluIGJsb2NrcyBpZiBiLmdldCgidHlwZSIpID09ICJ0ZXh0Iikuc3RyaXAoKQoKCmRlZiBfbGxtKHByb21wdDogc3RyKSAtPiBzdHI6CiAgICAiIiJUcnkgT2xsYW1hIGZpcnN0LCB0aGVuIENsYXVkZS4iIiIKICAgIG91dCA9IF9jYWxsX29sbGFtYShwcm9tcHQpCiAgICBpZiBub3Qgb3V0IG9yIGxlbihvdXQpIDwgMTA6CiAgICAgICAgb3V0ID0gX2NhbGxfY2xhdWRlKHByb21wdCkKICAgIHJldHVybiBvdXQKCgpkZWYgX3BhcnNlX2pzb25fcmVzcG9uc2UodGV4dDogc3RyKSAtPiBEaWN0W3N0ciwgc3RyXToKICAgICIiIkV4dHJhY3QgSlNPTiBmcm9tIExMTSByZXNwb25zZS4gSGFuZGxlcyBtYXJrZG93biBjb2RlIGJsb2Nrcy4iIiIKICAgIHRleHQgPSB0ZXh0LnN0cmlwKCkKICAgIGlmICJgYGAiIGluIHRleHQ6CiAgICAgICAgbSA9IHJlLnNlYXJjaChyImBgYCg/Ompzb24pP1xzKihce1teYF0qXH0pXHMqYGBgIiwgdGV4dCwgcmUuRE9UQUxMKQogICAgICAgIGlmIG06CiAgICAgICAgICAgIHRleHQgPSBtLmdyb3VwKDEpCiAgICBtYXRjaCA9IHJlLnNlYXJjaChyIlx7W157fV0qXH0iLCB0ZXh0LCByZS5ET1RBTEwpCiAgICBpZiBub3QgbWF0Y2g6CiAgICAgICAgcmV0dXJuIHt9CiAgICB0cnk6CiAgICAgICAgcmF3ID0ganNvbi5sb2FkcyhtYXRjaC5ncm91cCgpKQogICAgICAgIHJldHVybiB7c3RyKGspLmxvd2VyKCkuc3RyaXAoKTogc3RyKHYpLmxvd2VyKCkuc3RyaXAoKSBmb3IgaywgdiBpbiByYXcuaXRlbXMoKX0KICAgIGV4Y2VwdCBqc29uLkpTT05EZWNvZGVFcnJvcjoKICAgICAgICByZXR1cm4ge30KCgpkZWYgY2xhc3NpZnlfa2V5d29yZHMoa2V5d29yZHM6IExpc3Rbc3RyXSwgbGxtOiBPcHRpb25hbFtDYWxsYWJsZVtbc3RyXSwgc3RyXV0gPSBOb25lKSAtPiBEaWN0W3N0ciwgc3RyXToKICAgICIiIgogICAgQ2xhc3NpZnkga2V5d29yZHMgaW50bzogc2VydmljZSB8IGdlbyB8IG1vZGlmaWVyIHwgbG9uZ190YWlsIHwgYnJhbmQuCiAgICBVc2VzIE9sbGFtYSBmaXJzdCwgQ2xhdWRlIGZhbGxiYWNrIGlmIGxsbSBub3QgcHJvdmlkZWQuCiAgICAiIiIKICAgIGlmIG5vdCBrZXl3b3JkczoKICAgICAgICByZXR1cm4ge30KCiAgICBsbG0gPSBsbG0gb3IgX2xsbQogICAgYWxsX2NsYXNzaWZpY2F0aW9uczogRGljdFtzdHIsIHN0cl0gPSB7fQoKICAgIGZvciBpIGluIHJhbmdlKDAsIGxlbihrZXl3b3JkcyksIEJBVENIX1NJWkUpOgogICAgICAgIGJhdGNoID0ga2V5d29yZHNbaSA6IGkgKyBCQVRDSF9TSVpFXQogICAgICAgIHByb21wdCA9IGYiIiJZb3UgYXJlIGNsYXNzaWZ5aW5nIGtleXdvcmRzIGZvciBhIGp1bmsgcmVtb3ZhbCBidXNpbmVzcy4KCkdyb3VwIGVhY2gga2V5d29yZCBpbnRvIGV4YWN0bHkgb25lIG9mOgotIHNlcnZpY2UgKGUuZy4gcmVtb3ZhbCwgaGF1bGluZywgY2xlYW5vdXQpCi0gZ2VvIChlLmcuIHBob2VuaXgsIHNjb3R0c2RhbGUsIGFyaXpvbmEpCi0gbW9kaWZpZXIgKGUuZy4gc2FtZS1kYXksIGNoZWFwLCBlbWVyZ2VuY3ksIGZhc3QpCi0gbG9uZ190YWlsIChlLmcuIGVzdGF0ZSBzYWxlIGNsZWFudXAsIGhvYXJkZXIgY2xlYW51cCkKLSBicmFuZCAoY29tcGV0aXRvciBvciBicmFuZCBuYW1lcykKCktleXdvcmRzOgp7JywgJy5qb2luKGJhdGNoKX0KClJldHVybiBPTkxZIHZhbGlkIEpTT046IHt7ICJrZXl3b3JkIjogInR5cGUiLCAia2V5d29yZDIiOiAidHlwZTIiIH19ClVzZSBsb3dlcmNhc2UgZm9yIGJvdGgga2V5d29yZCBhbmQgdHlwZS4gTm8gZXhwbGFuYXRpb24uIiIiCgogICAgICAgIHJlc3BvbnNlID0gbGxtKHByb21wdCkKICAgICAgICBwYXJzZWQgPSBfcGFyc2VfanNvbl9yZXNwb25zZShyZXNwb25zZSkKICAgICAgICBmb3Iga3csIHQgaW4gcGFyc2VkLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIHQgaW4gVkFMSURfVFlQRVM6CiAgICAgICAgICAgICAgICBhbGxfY2xhc3NpZmljYXRpb25zW2t3XSA9IHQKCiAgICByZXR1cm4gYWxsX2NsYXNzaWZpY2F0aW9ucwoKCmRlZiBjbGFzc2lmeV9yZWdpb24ocmVnaW9uOiBzdHIsIGNsaWVudF9pZDogT3B0aW9uYWxbc3RyXSA9IE5vbmUpIC0+IGludDoKICAgICIiIgogICAgQ2xhc3NpZnkgYWxsIHVuY2xhc3NpZmllZCBrZXl3b3JkcyBmb3IgYSByZWdpb24uIFVwZGF0ZXMgREIuCiAgICBSZXR1cm5zIGNvdW50IG9mIGtleXdvcmRzIGNsYXNzaWZpZWQuCiAgICAiIiIKICAgIGRiID0gU2Vzc2lvbkxvY2FsKCkKICAgIHRyeToKICAgICAgICBxID0gZGIucXVlcnkoS2V5d29yZEludGVsbGlnZW5jZSkuZmlsdGVyKAogICAgICAgICAgICBLZXl3b3JkSW50ZWxsaWdlbmNlLnJlZ2lvbiA9PSByZWdpb24sCiAgICAgICAgICAgIChLZXl3b3JkSW50ZWxsaWdlbmNlLmtleXdvcmRfdHlwZS5pc18oTm9uZSkpIHwgKEtleXdvcmRJbnRlbGxpZ2VuY2Uua2V5d29yZF90eXBlID09ICIiKSwKICAgICAgICApCiAgICAgICAgaWYgY2xpZW50X2lkOgogICAgICAgICAgICBxID0gcS5maWx0ZXIoS2V5d29yZEludGVsbGlnZW5jZS5jbGllbnRfaWQgPT0gY2xpZW50X2lkKQogICAgICAgIGtleXdvcmRzID0gbGlzdCh7ci5rZXl3b3JkIGZvciByIGluIHEuYWxsKCl9KQogICAgICAgIGlmIG5vdCBrZXl3b3JkczoKICAgICAgICAgICAgbG9nLmluZm8oZiJObyB1bmNsYXNzaWZpZWQga2V5d29yZHMgZm9yIHJlZ2lvbj17cmVnaW9ufSIpCiAgICAgICAgICAgIHJldHVybiAwCgogICAgICAgIGxvZy5pbmZvKGYiQ2xhc3NpZnlpbmcge2xlbihrZXl3b3Jkcyl9IGtleXdvcmRzIGZvciByZWdpb249e3JlZ2lvbn0iKQogICAgICAgIGNsYXNzaWZpY2F0aW9ucyA9IGNsYXNzaWZ5X2tleXdvcmRzKGtleXdvcmRzKQoKICAgICAgICBjb3VudCA9IDAKICAgICAgICBmb3Igcm93IGluIGRiLnF1ZXJ5KEtleXdvcmRJbnRlbGxpZ2VuY2UpLmZpbHRlcigKICAgICAgICAgICAgS2V5d29yZEludGVsbGlnZW5jZS5yZWdpb24gPT0gcmVnaW9uLAogICAgICAgICk6CiAgICAgICAgICAgIGlmIHJvdy5rZXl3b3JkIGluIGNsYXNzaWZpY2F0aW9uczoKICAgICAgICAgICAgICAgIHJvdy5rZXl3b3JkX3R5cGUgPSBjbGFzc2lmaWNhdGlvbnNbcm93LmtleXdvcmRdCiAgICAgICAgICAgICAgICBjb3VudCArPSAxCiAgICAgICAgZGIuY29tbWl0KCkKICAgICAgICBsb2cuaW5mbyhmIkFwcGxpZWQge2xlbihjbGFzc2lmaWNhdGlvbnMpfSBjbGFzc2lmaWNhdGlvbnMsIHVwZGF0ZWQge2NvdW50fSByb3dzIikKICAgICAgICByZXR1cm4gY291bnQKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgZGIucm9sbGJhY2soKQogICAgICAgIHJhaXNlCiAgICBmaW5hbGx5OgogICAgICAgIGRiLmNsb3NlKCkKCgpkZWYgcnVuX2NsYXNzaWZpZXIocmVnaW9uOiBzdHIsIGNsaWVudF9pZDogT3B0aW9uYWxbc3RyXSA9IE5vbmUpIC0+IHR1cGxlW2Jvb2wsIHN0cl06CiAgICAiIiIKICAgIFJ1biBjbGFzc2lmaWNhdGlvbiBmb3IgYSByZWdpb24uIEZvciBtYW51YWwgb3IgYmF0Y2ggdXNlLgogICAgUmV0dXJucyAoc3VjY2VzcywgbWVzc2FnZSkuCiAgICAiIiIKICAgIHRyeToKICAgICAgICBjb3VudCA9IGNsYXNzaWZ5X3JlZ2lvbihyZWdpb24sIGNsaWVudF9pZCkKICAgICAgICByZXR1cm4gVHJ1ZSwgZiJDbGFzc2lmaWVkIHtjb3VudH0ga2V5d29yZHMgZm9yIHtyZWdpb259LiIKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2cuZXhjZXB0aW9uKHN0cihlKSkKICAgICAgICByZXR1cm4gRmFsc2UsIHN0cihlKQo=',
    "agents/opportunity_scorer.py": 'IiIiCk9wcG9ydHVuaXR5IFNjb3JpbmcgQWdlbnQg4oCUIGVhc3kgd2lucyByYW5raW5nLgoKVHVybnMgcmF3IGNvbXBldGl0b3IgcmVzZWFyY2ggaW50byBwcmlvcml0aXplZCwgbG93LWVmZm9ydCAvIGhpZ2gtaW1wYWN0IGNvbnRlbnQKb3Bwb3J0dW5pdGllcy4gQW5zd2VyczogIldoYXQgc2hvdWxkIHRoaXMgYnVzaW5lc3MgcG9zdCBGSVJTVCB0byBnZXQgdHJhY3Rpb24gZmFzdGVzdD8iCgpTY29yaW5nOiBjb21wZXRpdG9yIGdhcCArIHNlcnZpY2UgaW50ZW50ICsgbG9jYWwgZml0LiBUcmFuc3BhcmVudCBmb3IgY2xpZW50IHRydXN0LgoiIiIKCmltcG9ydCBkYXRldGltZQppbXBvcnQgbG9nZ2luZwpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdCwgT3B0aW9uYWwKCmZyb20gZGF0YWJhc2UgaW1wb3J0IE1hcmtldFNuYXBzaG90LCBPcHBvcnR1bml0eVNjb3JlLCBSZXNlYXJjaExvZywgU2Vzc2lvbkxvY2FsCgpmcm9tIGNvbmZpZyBpbXBvcnQgT1BQT1JUVU5JVFlfTE9HCgpsb2dnaW5nLmJhc2ljQ29uZmlnKAogICAgbGV2ZWw9bG9nZ2luZy5JTkZPLAogICAgZm9ybWF0PSIlKGFzY3RpbWUpcyBbJShsZXZlbG5hbWUpc10gJShtZXNzYWdlKXMiLAogICAgaGFuZGxlcnM9W2xvZ2dpbmcuRmlsZUhhbmRsZXIoT1BQT1JUVU5JVFlfTE9HKSwgbG9nZ2luZy5TdHJlYW1IYW5kbGVyKCldLAopCmxvZyA9IGxvZ2dpbmcuZ2V0TG9nZ2VyKF9fbmFtZV9fKQoKSU5URU5UX0tFWVdPUkRTID0gWwogICAgInJlbW92YWwiLCAicGlja3VwIiwgImhhdWwiLCAiaGF1bGluZyIsICJjbGVhbm91dCIsICJkaXNwb3NlIiwKXQoKTE9XX0NPTVBFVElUSU9OX1NFUlZJQ0VTID0gWwogICAgImhvdCB0dWIgcmVtb3ZhbCIsCiAgICAiYXBwbGlhbmNlIHJlbW92YWwiLAogICAgInNoZWQgcmVtb3ZhbCIsCiAgICAiZXN0YXRlIGNsZWFub3V0IiwKICAgICJnYXJhZ2UgY2xlYW5vdXQiLAogICAgImNvbnN0cnVjdGlvbiBkZWJyaXMiLApdCgoKZGVmIHNjb3JlX29wcG9ydHVuaXRpZXMoY2xpZW50X2lkOiBzdHIpIC0+IExpc3RbZGljdF06CiAgICAiIiIKICAgIEFuYWx5emUgcmVzZWFyY2ggbG9ncyBhbmQgcHJvZHVjZSByYW5rZWQgb3Bwb3J0dW5pdGllcy4KICAgIFJldHVybnMgbGlzdCBvZiB7c2VydmljZSwgY29tcGV0aXRvcl9tZW50aW9ucywgc2NvcmV9LgogICAgIiIiCiAgICBsb2cuaW5mbyhmIk9wcG9ydHVuaXR5IHNjb3JlciBzdGFydGluZyBmb3IgY2xpZW50X2lkPXtjbGllbnRfaWR9IikKICAgIGRiID0gU2Vzc2lvbkxvY2FsKCkKICAgIHRyeToKICAgICAgICBsb2dzID0gKAogICAgICAgICAgICBkYi5xdWVyeShSZXNlYXJjaExvZykKICAgICAgICAgICAgLmZpbHRlcihSZXNlYXJjaExvZy5jbGllbnRfaWQgPT0gY2xpZW50X2lkKQogICAgICAgICAgICAuYWxsKCkKICAgICAgICApCgogICAgICAgIGlmIG5vdCBsb2dzOgogICAgICAgICAgICBsb2cud2FybmluZygiTm8gcmVzZWFyY2ggbG9ncyB0byBzY29yZSIpCiAgICAgICAgICAgIHJldHVybiBbXQoKICAgICAgICAjIEJ1aWxkIHRleHQgYmxvYiBmcm9tIHJlc2VhcmNoIChleHRyYWN0ZWRfc2VydmljZXMsIG1pc3NlZF9vcHBvcnR1bml0aWVzLCByYXdfdGV4dCkKICAgICAgICB0ZXh0X3BhcnRzID0gW10KICAgICAgICBmb3IgcmwgaW4gbG9nczoKICAgICAgICAgICAgZm9yIHMgaW4gcmwuZXh0cmFjdGVkX3NlcnZpY2VzIG9yIFtdOgogICAgICAgICAgICAgICAgdGV4dF9wYXJ0cy5hcHBlbmQoc3RyKHMpLmxvd2VyKCkpCiAgICAgICAgICAgIGZvciBtIGluIHJsLm1pc3NlZF9vcHBvcnR1bml0aWVzIG9yIFtdOgogICAgICAgICAgICAgICAgdGV4dF9wYXJ0cy5hcHBlbmQoc3RyKG0pLmxvd2VyKCkpCiAgICAgICAgICAgIHRleHRfcGFydHMuYXBwZW5kKChybC5yYXdfdGV4dCBvciAiIilbOjEwMDBdLmxvd2VyKCkpCiAgICAgICAgdGV4dF9ibG9iID0gIiAiLmpvaW4odGV4dF9wYXJ0cykKCiAgICAgICAgc2VydmljZV9mcmVxdWVuY3kgPSB7fQogICAgICAgIGZvciBzZXJ2aWNlIGluIExPV19DT01QRVRJVElPTl9TRVJWSUNFUzoKICAgICAgICAgICAgc2VydmljZV9mcmVxdWVuY3lbc2VydmljZV0gPSB0ZXh0X2Jsb2IuY291bnQoc2VydmljZSkKCiAgICAgICAgb3Bwb3J0dW5pdGllcyA9IFtdCiAgICAgICAgZm9yIHNlcnZpY2UgaW4gTE9XX0NPTVBFVElUSU9OX1NFUlZJQ0VTOgogICAgICAgICAgICBjb21wZXRpdG9yX2NvdW50ID0gc2VydmljZV9mcmVxdWVuY3kuZ2V0KHNlcnZpY2UsIDApCgogICAgICAgICAgICBzY29yZSA9IDEwMAogICAgICAgICAgICBzY29yZSAtPSBjb21wZXRpdG9yX2NvdW50ICogMTUgICMgZmV3ZXIgY29tcGV0aXRvcnMgPSBoaWdoZXIgc2NvcmUKICAgICAgICAgICAgaWYgYW55KGsgaW4gc2VydmljZSBmb3IgayBpbiBJTlRFTlRfS0VZV09SRFMpOgogICAgICAgICAgICAgICAgc2NvcmUgKz0gMTAKCiAgICAgICAgICAgIG9wcG9ydHVuaXRpZXMuYXBwZW5kKHsKICAgICAgICAgICAgICAgICJzZXJ2aWNlIjogc2VydmljZSwKICAgICAgICAgICAgICAgICJjb21wZXRpdG9yX21lbnRpb25zIjogY29tcGV0aXRvcl9jb3VudCwKICAgICAgICAgICAgICAgICJzY29yZSI6IG1heChzY29yZSwgMCksCiAgICAgICAgICAgIH0pCgogICAgICAgIG9wcG9ydHVuaXRpZXMuc29ydChrZXk9bGFtYmRhIHg6IHhbInNjb3JlIl0sIHJldmVyc2U9VHJ1ZSkKICAgICAgICBzYXZlX29wcG9ydHVuaXRpZXMoZGIsIGNsaWVudF9pZCwgb3Bwb3J0dW5pdGllcykKICAgICAgICBsb2cuaW5mbyhmIlNhdmVkIHtsZW4ob3Bwb3J0dW5pdGllcyl9IHJhbmtlZCBvcHBvcnR1bml0aWVzIikKICAgICAgICByZXR1cm4gb3Bwb3J0dW5pdGllcwogICAgZmluYWxseToKICAgICAgICBkYi5jbG9zZSgpCgoKZGVmIHNhdmVfb3Bwb3J0dW5pdGllcyhkYiwgY2xpZW50X2lkOiBzdHIsIG9wcG9ydHVuaXRpZXM6IExpc3RbZGljdF0pIC0+IE5vbmU6CiAgICAiIiJTYXZlIHJhbmtlZCBvcHBvcnR1bml0aWVzIHRvIE9wcG9ydHVuaXR5U2NvcmUgKHRpZXJfMSwgdGllcl8yLCB0aWVyXzMpLiIiIgogICAgaWYgbm90IG9wcG9ydHVuaXRpZXM6CiAgICAgICAgcmV0dXJuCgogICAgdGllcl8xID0gW29bInNlcnZpY2UiXSBmb3IgbyBpbiBvcHBvcnR1bml0aWVzWzozXSBpZiBvWyJzY29yZSJdID49IDcwXQogICAgdGllcl8yID0gW29bInNlcnZpY2UiXSBmb3IgbyBpbiBvcHBvcnR1bml0aWVzWzM6Nl0gaWYgb1sic2NvcmUiXSA+PSA0MF0KICAgIHRpZXJfMyA9IFtvWyJzZXJ2aWNlIl0gZm9yIG8gaW4gb3Bwb3J0dW5pdGllc1s2Ol1dCgogICAgbGF0ZXN0ID0gZGIucXVlcnkoTWFya2V0U25hcHNob3QpLmZpbHRlcihNYXJrZXRTbmFwc2hvdC5jbGllbnRfaWQgPT0gY2xpZW50X2lkKS5vcmRlcl9ieShNYXJrZXRTbmFwc2hvdC5jcmVhdGVkX2F0LmRlc2MoKSkuZmlyc3QoKQogICAgc25hcHNob3RfaWQgPSBsYXRlc3Quc25hcHNob3RfaWQgaWYgbGF0ZXN0IGVsc2UgZiJ7Y2xpZW50X2lkfS1zY29yZWQiCiAgICByZXN1bHRfaWQgPSBmIntjbGllbnRfaWR9LW9wcC17ZGF0ZXRpbWUuZGF0ZXRpbWUudXRjbm93KCkuc3RyZnRpbWUoJyVZJW0lZCVIJU0nKX0iCgogICAgb3BwID0gT3Bwb3J0dW5pdHlTY29yZSgKICAgICAgICBjbGllbnRfaWQ9Y2xpZW50X2lkLAogICAgICAgIHNuYXBzaG90X2lkPXNuYXBzaG90X2lkLAogICAgICAgIGN1cnJlbnRfc2Vhc29uPWRhdGV0aW1lLmRhdGV0aW1lLnV0Y25vdygpLnN0cmZ0aW1lKCIlQiAlWSIpLAogICAgICAgIHJlc3VsdF9pZD1yZXN1bHRfaWQsCiAgICAgICAgdGllcl8xX3RvcGljcz10aWVyXzEgb3IgW29wcG9ydHVuaXRpZXNbMF1bInNlcnZpY2UiXV0sCiAgICAgICAgdGllcl8yX3RvcGljcz10aWVyXzIsCiAgICAgICAgdGllcl8zX3RvcGljcz10aWVyXzMsCiAgICApCiAgICBkYi5hZGQob3BwKQogICAgZGIuY29tbWl0KCkK',
    "agents/researcher.py": 'IiIiClJlc2VhcmNoZXIg4oCUIEZVTEwgT1JDSEVTVFJBVElPTi4KCkNsaWVudCDihpIgVGF2aWx5IOKGkiBGaXJlY3Jhd2wvUmV2aWV3cyDihpIgT2xsYW1hIOKGkiBEYXRhYmFzZQoKR3VhcmRzOiBUYXZpbHkgbWF4X3Jlc3VsdHM9NSwgRmlyZWNyYXdsIDMwcyB0aW1lb3V0LCBPbGxhbWEgNDVzIG5vLXJldHJ5LCBzbGVlcCgyKSBiZXR3ZWVuLgoiIiIKCmltcG9ydCBsb2dnaW5nCmltcG9ydCB0aW1lCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmZyb20gdHlwaW5nIGltcG9ydCBPcHRpb25hbAoKZnJvbSBjb25maWcgaW1wb3J0ICgKICAgIERFRkFVTFRfTklDSEUsCiAgICBSRVNFQVJDSEVSX0xPRywKICAgIFNMRUVQX0JFVFdFRU5fQ09NUEVUSVRPUlMsCiAgICBUQVZJTFlfTUFYX1JFU1VMVFMsCikKZnJvbSBzcWxhbGNoZW15IGltcG9ydCBmdW5jCgpmcm9tIGRhdGFiYXNlIGltcG9ydCBDbGllbnQsIE1hcmtldFNuYXBzaG90LCBSZXNlYXJjaExvZywgU2Vzc2lvbkxvY2FsCgpmcm9tIC5maXJlY3Jhd2xfY2xpZW50IGltcG9ydCBmaXJlY3Jhd2xfc2NyYXBlCmZyb20gLmtleXdvcmRfY2xhc3NpZmllciBpbXBvcnQgcnVuX2NsYXNzaWZpZXIgYXMgcnVuX2tleXdvcmRfY2xhc3NpZmllcgpmcm9tIC5rZXl3b3JkX2V4dHJhY3RvciBpbXBvcnQgZXh0cmFjdF9rZXl3b3Jkcywgc3RvcmVfa2V5d29yZHMKZnJvbSAub2xsYW1hX2NsaWVudCBpbXBvcnQgcGFyc2Vfc3VtbWFyeV90b19maWVsZHMsIHN1bW1hcml6ZV9zZXJ2aWNlcwpmcm9tIC50YXZpbHlfY2xpZW50IGltcG9ydCBmaW5kX2xvY2FsX2NvbXBldGl0b3JzLCBnZXRfc2VydmljZXNfZnJvbV9yZXZpZXdzLCBoYXNfcmVhbF93ZWJzaXRlCgpsb2dnaW5nLmJhc2ljQ29uZmlnKAogICAgbGV2ZWw9bG9nZ2luZy5JTkZPLAogICAgZm9ybWF0PSIlKGFzY3RpbWUpcyBbJShsZXZlbG5hbWUpc10gJShtZXNzYWdlKXMiLAogICAgaGFuZGxlcnM9W2xvZ2dpbmcuRmlsZUhhbmRsZXIoUkVTRUFSQ0hFUl9MT0cpLCBsb2dnaW5nLlN0cmVhbUhhbmRsZXIoKV0sCikKbG9nID0gbG9nZ2luZy5nZXRMb2dnZXIoX19uYW1lX18pCgoKZGVmIGdhdGhlcl9pbnRlbGxpZ2VuY2UoY2xpZW50X2lkOiBzdHIsIGNpdHk6IE9wdGlvbmFsW3N0cl0gPSBOb25lKSAtPiBzdHI6CiAgICAiIiIKICAgIEVuZC10by1lbmQgY29tcGV0aXRvciByZXNlYXJjaCBmb3IgYSBzaW5nbGUgY2xpZW50LgogICAgQ2xpZW50IOKGkiBUYXZpbHkg4oaSIEZpcmVjcmF3bC9SZXZpZXdzIOKGkiBPbGxhbWEg4oaSIERhdGFiYXNlCiAgICAiIiIKICAgIGxvZy5pbmZvKGYiUmVzZWFyY2hlciBzdGFydGluZyBmb3IgY2xpZW50X2lkPXtjbGllbnRfaWR9IikKICAgIGRiID0gU2Vzc2lvbkxvY2FsKCkKICAgIHRyeToKICAgICAgICAjIENhc2UtaW5zZW5zaXRpdmUgY2xpZW50IGxvb2t1cCAoQ0xJIG1heSBwYXNzICJDVEMiIGJ1dCBEQiBoYXMgImN0YyIpCiAgICAgICAgY2xpZW50ID0gZGIucXVlcnkoQ2xpZW50KS5maWx0ZXIoZnVuYy5sb3dlcihDbGllbnQuY2xpZW50X2lkKSA9PSBjbGllbnRfaWQubG93ZXIoKSkuZmlyc3QoKQogICAgICAgIGlmIG5vdCBjbGllbnQ6CiAgICAgICAgICAgIGxvZy5lcnJvcihmIkNsaWVudCB7Y2xpZW50X2lkfSBub3QgZm91bmQiKQogICAgICAgICAgICByZXR1cm4gIiIKCiAgICAgICAgY2xpZW50X2lkID0gY2xpZW50LmNsaWVudF9pZCAgIyBVc2UgYWN0dWFsIHN0b3JlZCB2YWx1ZSBmb3IgREIgd3JpdGVzCiAgICAgICAgY2l0eSA9IGNpdHkgb3IgKGNsaWVudC5jaXRpZXNfc2VydmVkWzBdIGlmIGNsaWVudC5jaXRpZXNfc2VydmVkIGVsc2UgIlVua25vd24iKQogICAgICAgIG5pY2hlID0gREVGQVVMVF9OSUNIRQogICAgICAgIHF1ZXJ5ID0gZiJ7bmljaGV9IHtjaXR5fSIgaWYgY2l0eSAhPSAiVW5rbm93biIgZWxzZSBuaWNoZQogICAgICAgIGxvZy5pbmZvKGYiU3RlcCAxOiBMb2FkIGNsaWVudCDigJQgY2l0eT17Y2l0eX0sIG5pY2hlPXtuaWNoZX0iKQoKICAgICAgICAjIDIuIFRhdmlseSDigJQgZmluZCBsb2NhbCBjb21wZXRpdG9ycyAoZ3VhcmQ6IG1heF9yZXN1bHRzPTUpCiAgICAgICAgY29tcGV0aXRvcnMgPSBmaW5kX2xvY2FsX2NvbXBldGl0b3JzKAogICAgICAgICAgICBidXNpbmVzc190eXBlPW5pY2hlLAogICAgICAgICAgICBjaXR5PWNpdHksCiAgICAgICAgICAgIG1heF9yZXN1bHRzPVRBVklMWV9NQVhfUkVTVUxUUywKICAgICAgICApCgogICAgICAgIGlmIG5vdCBjb21wZXRpdG9yczoKICAgICAgICAgICAgbG9nLndhcm5pbmcoIk5vIGNvbXBldGl0b3JzIGZvdW5kIGZyb20gVGF2aWx5IikKICAgICAgICAgICAgcnVuX2lkID0gZiJ7Y2l0eS5sb3dlcigpLnJlcGxhY2UoJyAnLCAnLScpfS17ZGF0ZXRpbWUudXRjbm93KCkuc3RyZnRpbWUoJyVZLSVtJyl9IgogICAgICAgICAgICByZXR1cm4gcnVuX2lkCgogICAgICAgIHJ1bl9pZCA9IGYie2NpdHkubG93ZXIoKS5yZXBsYWNlKCcgJywgJy0nKX0te2RhdGV0aW1lLnV0Y25vdygpLnN0cmZ0aW1lKCclWS0lbScpfSIKICAgICAgICBzZWVuX25hbWVzID0gc2V0KCkKICAgICAgICBhbGxfbWlzc2VkID0gW10KICAgICAgICBhbGxfc2VydmljZXMgPSBbXQoKICAgICAgICBmb3IgY29tcCBpbiBjb21wZXRpdG9yczoKICAgICAgICAgICAgbmFtZSA9IGNvbXAuZ2V0KCJuYW1lIiwgIiIpLnN0cmlwKCkKICAgICAgICAgICAgdXJsID0gY29tcC5nZXQoInVybCIsICIiKS5zdHJpcCgpCiAgICAgICAgICAgIGNvbnRlbnQgPSBjb21wLmdldCgiY29udGVudCIsICIiKS5zdHJpcCgpCgogICAgICAgICAgICBpZiBub3QgbmFtZSBvciBuYW1lIGluIHNlZW5fbmFtZXM6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBzZWVuX25hbWVzLmFkZChuYW1lKQogICAgICAgICAgICBsb2cuaW5mbyhmIlN0ZXAgMjogUHJvY2Vzc2luZyDigJQge25hbWV9IikKCiAgICAgICAgICAgICMgMy4gRmlyZWNyYXdsIG9yIFJldmlld3MKICAgICAgICAgICAgaWYgaGFzX3JlYWxfd2Vic2l0ZSh1cmwpOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gZmlyZWNyYXdsX3NjcmFwZSh1cmwpCiAgICAgICAgICAgICAgICBpZiByZXN1bHRbInN1Y2Nlc3MiXToKICAgICAgICAgICAgICAgICAgICByYXdfdGV4dCA9IHJlc3VsdFsiY29udGVudCJdCiAgICAgICAgICAgICAgICAgICAgc291cmNlX3R5cGUgPSAid2Vic2l0ZSIKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbG9nLndhcm5pbmcoZiJGaXJlY3Jhd2wgZmFpbGVkIGZvciB7dXJsfToge3Jlc3VsdFsnY29udGVudCddfSIpCiAgICAgICAgICAgICAgICAgICAgcmF3X3RleHQgPSBjb250ZW50CiAgICAgICAgICAgICAgICAgICAgc291cmNlX3R5cGUgPSAid2Vic2l0ZSIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhd190ZXh0ID0gZ2V0X3NlcnZpY2VzX2Zyb21fcmV2aWV3cyhuYW1lLCBjaXR5LCBuaWNoZSkKICAgICAgICAgICAgICAgIGlmIG5vdCByYXdfdGV4dDoKICAgICAgICAgICAgICAgICAgICByYXdfdGV4dCA9IGNvbnRlbnQKICAgICAgICAgICAgICAgIHNvdXJjZV90eXBlID0gInJldmlld3MiCgogICAgICAgICAgICBpZiBsZW4ocmF3X3RleHQuc3RyaXAoKSkgPCAzMDoKICAgICAgICAgICAgICAgIGxvZy53YXJuaW5nKGYiU2tpcHBpbmcge25hbWV9OiBpbnN1ZmZpY2llbnQgdGV4dCIpCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgIyA0LiBPbGxhbWEg4oCUIHN1bW1hcml6ZQogICAgICAgICAgICBzdW1tYXJ5ID0gc3VtbWFyaXplX3NlcnZpY2VzKHJhd190ZXh0LCBuYW1lKQogICAgICAgICAgICBpZiBzdW1tYXJ5LnN0YXJ0c3dpdGgoIk9sbGFtYSBzdW1tYXJpemF0aW9uIGZhaWxlZCIpOgogICAgICAgICAgICAgICAgbG9nLndhcm5pbmcoc3VtbWFyeSkKICAgICAgICAgICAgICAgIHBhcnNlZCA9IHsiZXh0cmFjdGVkX3NlcnZpY2VzIjogW10sICJwcmljaW5nX21lbnRpb25zIjogW10sICJjb21wbGFpbnRzIjogW10sICJtaXNzZWRfb3Bwb3J0dW5pdGllcyI6IFtdfQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcGFyc2VkID0gcGFyc2Vfc3VtbWFyeV90b19maWVsZHMoc3VtbWFyeSkKCiAgICAgICAgICAgIHNlcnZpY2VzID0gcGFyc2VkLmdldCgiZXh0cmFjdGVkX3NlcnZpY2VzIiwgW10pCiAgICAgICAgICAgIHByaWNpbmcgPSBwYXJzZWQuZ2V0KCJwcmljaW5nX21lbnRpb25zIiwgW10pCiAgICAgICAgICAgIGNvbXBsYWludHMgPSBwYXJzZWQuZ2V0KCJjb21wbGFpbnRzIiwgW10pCiAgICAgICAgICAgIG1pc3NlZCA9IHBhcnNlZC5nZXQoIm1pc3NlZF9vcHBvcnR1bml0aWVzIiwgW10pCiAgICAgICAgICAgIGNvbmYgPSA3MCBpZiAoc2VydmljZXMgb3IgbGVuKHJhd190ZXh0KSA+IDIwMCkgZWxzZSA1MAoKICAgICAgICAgICAgYWxsX21pc3NlZC5leHRlbmQobWlzc2VkIG9yIFtdKQogICAgICAgICAgICBhbGxfc2VydmljZXMuZXh0ZW5kKHNlcnZpY2VzIG9yIFtdKQoKICAgICAgICAgICAgIyA0Yi4gS2V5d29yZCBleHRyYWN0aW9uIOKAlCBzdG9yZSBmcm9tIHN1bW1hcnksIGZhbGxiYWNrIHRvIHJhd190ZXh0IGlmIE9sbGFtYSBmYWlsZWQKICAgICAgICAgICAgdGV4dF9mb3Jfa2V5d29yZHMgPSBzdW1tYXJ5IGlmIG5vdCBzdW1tYXJ5LnN0YXJ0c3dpdGgoIk9sbGFtYSBzdW1tYXJpemF0aW9uIGZhaWxlZCIpIGVsc2UgcmF3X3RleHQKICAgICAgICAgICAga2V5d29yZHMgPSBleHRyYWN0X2tleXdvcmRzKHRleHRfZm9yX2tleXdvcmRzKQogICAgICAgICAgICBpZiBrZXl3b3JkczoKICAgICAgICAgICAgICAgIHN0b3JlZCA9IHN0b3JlX2tleXdvcmRzKAogICAgICAgICAgICAgICAgICAgIGtleXdvcmRzPWtleXdvcmRzLAogICAgICAgICAgICAgICAgICAgIHJlZ2lvbj1jaXR5LAogICAgICAgICAgICAgICAgICAgIHNvdXJjZT0iY29tcGV0aXRvcl9zaXRlIiwKICAgICAgICAgICAgICAgICAgICBjbGllbnRfaWQ9Y2xpZW50X2lkLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgaWYgc3RvcmVkOgogICAgICAgICAgICAgICAgICAgIGxvZy5pbmZvKGYiU3RvcmVkIHtzdG9yZWR9IGtleXdvcmRzIGZyb20ge25hbWV9IikKCiAgICAgICAgICAgICMgNS4gRGF0YWJhc2Ug4oCUIHNhdmUKICAgICAgICAgICAgZGIuYWRkKFJlc2VhcmNoTG9nKAogICAgICAgICAgICAgICAgY2xpZW50X2lkPWNsaWVudF9pZCwKICAgICAgICAgICAgICAgIGNvbXBldGl0b3JfbmFtZT1uYW1lLAogICAgICAgICAgICAgICAgc291cmNlX3R5cGU9c291cmNlX3R5cGUsCiAgICAgICAgICAgICAgICByYXdfdGV4dD1yYXdfdGV4dFs6MTAwMDBdLAogICAgICAgICAgICAgICAgZXh0cmFjdGVkX3NlcnZpY2VzPXNlcnZpY2VzLAogICAgICAgICAgICAgICAgcHJpY2luZ19tZW50aW9ucz1wcmljaW5nLAogICAgICAgICAgICAgICAgY29tcGxhaW50cz1jb21wbGFpbnRzLAogICAgICAgICAgICAgICAgbWlzc2VkX29wcG9ydHVuaXRpZXM9bWlzc2VkLAogICAgICAgICAgICAgICAgY29uZmlkZW5jZV9zY29yZT1jb25mLAogICAgICAgICAgICAgICAgY2l0eT1jaXR5LAogICAgICAgICAgICApKQoKICAgICAgICAgICAgdGltZS5zbGVlcChTTEVFUF9CRVRXRUVOX0NPTVBFVElUT1JTKSAgIyBHdWFyZDogY2hlYXAgKyBwb2xpdGUKCiAgICAgICAgZGIuY29tbWl0KCkKCiAgICAgICAgIyA2LiBNYXJrZXRTbmFwc2hvdAogICAgICAgIGlmIHNlZW5fbmFtZXM6CiAgICAgICAgICAgIHNuYXBzaG90ID0gTWFya2V0U25hcHNob3QoCiAgICAgICAgICAgICAgICBjbGllbnRfaWQ9Y2xpZW50X2lkLAogICAgICAgICAgICAgICAgc25hcHNob3RfaWQ9cnVuX2lkLAogICAgICAgICAgICAgICAgY2l0eT1jaXR5LAogICAgICAgICAgICAgICAgcHJpbWFyeV9zZXJ2aWNlPW5pY2hlLmxvd2VyKCksCiAgICAgICAgICAgICAgICBzdHJvbmdfY29tcGV0aXRvcnM9bGlzdChzZWVuX25hbWVzKSwKICAgICAgICAgICAgICAgIGNvbnRlbnRfZ2Fwcz1saXN0KGRpY3QuZnJvbWtleXMoYWxsX21pc3NlZCkpWzoxMF0sCiAgICAgICAgICAgICAgICBjb21tb25fbWVzc2FnaW5nX3RoZW1lcz1saXN0KGRpY3QuZnJvbWtleXMoYWxsX3NlcnZpY2VzKSlbOjEwXSwKICAgICAgICAgICAgICAgIHNuYXBzaG90X2RhdGU9ZGF0ZXRpbWUudXRjbm93KCkuc3RyZnRpbWUoIiVZLSVtLSVkIiksCiAgICAgICAgICAgICkKICAgICAgICAgICAgZGIuYWRkKHNuYXBzaG90KQogICAgICAgICAgICBkYi5jb21taXQoKQoKICAgICAgICAjIDcuIEtleXdvcmQgY2xhc3NpZmljYXRpb24g4oCUIG9uY2UgcGVyIGJhdGNoIChvcHRpb25hbCwgbGlnaHR3ZWlnaHQpCiAgICAgICAgaWYgc2Vlbl9uYW1lczoKICAgICAgICAgICAgb2ssIF8gPSBydW5fa2V5d29yZF9jbGFzc2lmaWVyKGNpdHksIGNsaWVudF9pZCkKICAgICAgICAgICAgaWYgb2s6CiAgICAgICAgICAgICAgICBsb2cuaW5mbygiS2V5d29yZCBjbGFzc2lmaWNhdGlvbiBjb21wbGV0ZSIpCgogICAgICAgIGxvZy5pbmZvKGYiUmVzZWFyY2hlciBkb25lLiBTYXZlZCB7bGVuKHNlZW5fbmFtZXMpfSBlbnRyaWVzLiIpCiAgICAgICAgcmV0dXJuIHJ1bl9pZAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGRiLnJvbGxiYWNrKCkKICAgICAgICBsb2cuZXhjZXB0aW9uKHN0cihlKSkKICAgICAgICByYWlzZQogICAgZmluYWxseToKICAgICAgICBkYi5jbG9zZSgpCgoKZGVmIHJ1bl9yZXNlYXJjaGVyKGNsaWVudF9pZDogc3RyLCBjaXR5OiBPcHRpb25hbFtzdHJdID0gTm9uZSkgLT4gc3RyOgogICAgIiIiQWxpYXMgZm9yIGdhdGhlcl9pbnRlbGxpZ2VuY2UuIiIiCiAgICByZXR1cm4gZ2F0aGVyX2ludGVsbGlnZW5jZShjbGllbnRfaWQsIGNpdHkpCg==',
    "agents/strategist.py": 'IiIiClN0cmF0ZWdpc3Qg4oCUIGNvbnRlbnQgJiBwb3NpdGlvbmluZy4KTmV2ZXIgYnJvd3NlcyB0aGUgd2ViLiBPbmx5IHJlYWRzIHJlc2VhcmNoLCB0aGlua3MsIHdyaXRlcyBkcmFmdHMuClRyaWVzIE9sbGFtYSBmaXJzdCAobG9jYWwsIGZyZWUpLiBGYWxscyBiYWNrIHRvIENsYXVkZSBvbmx5IHdoZW4gb3V0cHV0IGlzIGluc3VmZmljaWVudC4KIiIiCgppbXBvcnQganNvbgppbXBvcnQgbG9nZ2luZwppbXBvcnQgcmUKaW1wb3J0IHJlcXVlc3RzCmZyb20gdHlwaW5nIGltcG9ydCBMaXN0LCBPcHRpb25hbAoKZnJvbSBjb25maWcgaW1wb3J0ICgKICAgIEFOVEhST1BJQ19BUElfS0VZLAogICAgQU5USFJPUElDX01PREVMLAogICAgQU5USFJPUElDX1VSTCwKICAgIE1JTl9DT05GSURFTkNFX0ZPUl9TVFJBVEVHSVNULAogICAgT0xMQU1BX01PREVMLAogICAgT0xMQU1BX1VSTCwKICAgIFNUUkFURUdJU1RfTE9HLAopCmZyb20gc3FsYWxjaGVteSBpbXBvcnQgZnVuYwoKZnJvbSBkYXRhYmFzZSBpbXBvcnQgQ2xpZW50LCBDb250ZW50RHJhZnQsIENvbnRlbnRTdHJhdGVneSwgUmVzZWFyY2hMb2csIFNlc3Npb25Mb2NhbAoKZnJvbSAub3Bwb3J0dW5pdHlfc2NvcmVyIGltcG9ydCBzY29yZV9vcHBvcnR1bml0aWVzCgpsb2dnaW5nLmJhc2ljQ29uZmlnKAogICAgbGV2ZWw9bG9nZ2luZy5JTkZPLAogICAgZm9ybWF0PSIlKGFzY3RpbWUpcyBbJShsZXZlbG5hbWUpc10gJShtZXNzYWdlKXMiLAogICAgaGFuZGxlcnM9W2xvZ2dpbmcuRmlsZUhhbmRsZXIoU1RSQVRFR0lTVF9MT0cpLCBsb2dnaW5nLlN0cmVhbUhhbmRsZXIoKV0sCikKbG9nID0gbG9nZ2luZy5nZXRMb2dnZXIoX19uYW1lX18pCgoKZGVmIF9jYWxsX29sbGFtYShwcm9tcHQ6IHN0cikgLT4gc3RyOgogICAgIiIiQ2FsbCBsb2NhbCBPbGxhbWEuIFJldHVybnMgZW1wdHkgc3RyaW5nIG9uIGZhaWx1cmUuIiIiCiAgICB0cnk6CiAgICAgICAgbG9nLmluZm8oIlRyeWluZyBPbGxhbWEgZmlyc3QgKGxvY2FsLCBubyBjb3N0KSIpCiAgICAgICAgcmVzcCA9IHJlcXVlc3RzLnBvc3QoCiAgICAgICAgICAgIGYie09MTEFNQV9VUkx9L2FwaS9nZW5lcmF0ZSIsCiAgICAgICAgICAgIGpzb249eyJtb2RlbCI6IE9MTEFNQV9NT0RFTCwgInByb21wdCI6IHByb21wdCwgInN0cmVhbSI6IEZhbHNlfSwKICAgICAgICAgICAgdGltZW91dD0xMjAsCiAgICAgICAgKQogICAgICAgIHJlc3AucmFpc2VfZm9yX3N0YXR1cygpCiAgICAgICAgcmV0dXJuIHJlc3AuanNvbigpLmdldCgicmVzcG9uc2UiLCAiIikuc3RyaXAoKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZy53YXJuaW5nKGYiT2xsYW1hIGZhaWxlZDoge2V9IikKICAgICAgICByZXR1cm4gIiIKCgpkZWYgX2NhbGxfY2xhdWRlKHByb21wdDogc3RyKSAtPiBzdHI6CiAgICAiIiJDYWxsIENsYXVkZSB2aWEgQW50aHJvcGljIEFQSS4gVXNlIG9ubHkgd2hlbiBPbGxhbWEgaXMgaW5zdWZmaWNpZW50LiIiIgogICAgbG9nLmluZm8oIkZhbGxpbmcgYmFjayB0byBDbGF1ZGUgKEFQSSBjb3N0KSIpCiAgICByZXNwID0gcmVxdWVzdHMucG9zdCgKICAgICAgICBBTlRIUk9QSUNfVVJMLAogICAgICAgIGhlYWRlcnM9ewogICAgICAgICAgICAieC1hcGkta2V5IjogQU5USFJPUElDX0FQSV9LRVksCiAgICAgICAgICAgICJhbnRocm9waWMtdmVyc2lvbiI6ICIyMDIzLTA2LTAxIiwKICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICB9LAogICAgICAgIGpzb249ewogICAgICAgICAgICAibW9kZWwiOiBBTlRIUk9QSUNfTU9ERUwsCiAgICAgICAgICAgICJtYXhfdG9rZW5zIjogMTAyNCwKICAgICAgICAgICAgIm1lc3NhZ2VzIjogW3sicm9sZSI6ICJ1c2VyIiwgImNvbnRlbnQiOiBwcm9tcHR9XSwKICAgICAgICB9LAogICAgICAgIHRpbWVvdXQ9NjAsCiAgICApCiAgICByZXNwLnJhaXNlX2Zvcl9zdGF0dXMoKQogICAgZGF0YSA9IHJlc3AuanNvbigpCiAgICAjIEFudGhyb3BpYyByZXR1cm5zIGNvbnRlbnQgYXMgYXJyYXkgb2YgYmxvY2tzOyB0ZXh0IGlzIGluIGNvbnRlbnRbMF0udGV4dAogICAgYmxvY2tzID0gZGF0YS5nZXQoImNvbnRlbnQiLCBbXSkKICAgIHRleHQgPSAiIgogICAgZm9yIGIgaW4gYmxvY2tzOgogICAgICAgIGlmIGIuZ2V0KCJ0eXBlIikgPT0gInRleHQiOgogICAgICAgICAgICB0ZXh0ICs9IGIuZ2V0KCJ0ZXh0IiwgIiIpCiAgICByZXR1cm4gdGV4dC5zdHJpcCgpCgoKZGVmIF9zYXZlX3N0cmF0ZWd5KGRiLCBjbGllbnRfaWQ6IHN0ciwgY2l0eTogc3RyLCBvcHBvcnR1bml0aWVzOiBMaXN0W2RpY3RdKSAtPiBOb25lOgogICAgIiIiQ29udmVydCBvcHBvcnR1bml0aWVzIGludG8gY2xlYXIgYWN0aW9uIHBsYW5zLiBDbGllbnQtZmFjaW5nLiIiIgogICAgZGIucXVlcnkoQ29udGVudFN0cmF0ZWd5KS5maWx0ZXIoQ29udGVudFN0cmF0ZWd5LmNsaWVudF9pZCA9PSBjbGllbnRfaWQpLmRlbGV0ZSgpCiAgICBmb3Igb3BwIGluIG9wcG9ydHVuaXRpZXM6CiAgICAgICAgdG9waWMgPSBvcHBbInNlcnZpY2UiXQogICAgICAgIHNjb3JlID0gb3BwWyJzY29yZSJdCiAgICAgICAgYWN0aW9ucyA9IFsKICAgICAgICAgICAgZiJHb29nbGUgQnVzaW5lc3MgUHJvZmlsZSBwb3N0IHRhcmdldGluZyAne3RvcGljfSBpbiB7Y2l0eX0nIiBpZiBjaXR5IGVsc2UgZiJHb29nbGUgQnVzaW5lc3MgUHJvZmlsZSBwb3N0IGZvciAne3RvcGljfSciLAogICAgICAgICAgICBmIlNFTyBibG9nIHBhZ2UgZm9yICd7dG9waWN9JyIsCiAgICAgICAgICAgICJCZWZvcmUvYWZ0ZXIgcGhvdG8gcG9zdCBvbiBGYWNlYm9vayIsCiAgICAgICAgXQogICAgICAgIHN0cmF0ID0gQ29udGVudFN0cmF0ZWd5KAogICAgICAgICAgICBjbGllbnRfaWQ9Y2xpZW50X2lkLAogICAgICAgICAgICB0b3BpYz10b3BpYywKICAgICAgICAgICAgcmVjb21tZW5kZWRfYWN0aW9ucz1hY3Rpb25zLAogICAgICAgICAgICBwcmlvcml0eV9zY29yZT1zY29yZSwKICAgICAgICApCiAgICAgICAgZGIuYWRkKHN0cmF0KQogICAgZGIuY29tbWl0KCkKCgpkZWYgX2V4dHJhY3RfZHJhZnQodGV4dDogc3RyLCBsYWJlbDogc3RyKSAtPiBzdHI6CiAgICAiIiJFeHRyYWN0IGRyYWZ0IGNvbnRlbnQgZnJvbSBDbGF1ZGUgb3V0cHV0LCBoYW5kbGluZyBtYXJrZG93biBibG9ja3MuIiIiCiAgICAjIExvb2sgZm9yICMjIExhYmVsIG9yICoqTGFiZWwqKiBvciAiTGFiZWw6IgogICAgcGF0dGVybnMgPSBbCiAgICAgICAgcmYiIyNccyp7bGFiZWx9W15cbl0qXG4oLio/KSg/PSMjfCQpIiwKICAgICAgICByZiJcKlwqe2xhYmVsfVteXG5dKlwqXCpccypcbiguKj8pKD89XCpcKnwkKSIsCiAgICAgICAgcmYie2xhYmVsfTpccypcbiguKj8pKD89XG5cbnxcWikiLAogICAgICAgIHJmImBgYFxuKC4qPylgYGAiLAogICAgXQogICAgZm9yIHAgaW4gcGF0dGVybnM6CiAgICAgICAgbSA9IHJlLnNlYXJjaChwLCB0ZXh0LCByZS5ET1RBTEwgfCByZS5JR05PUkVDQVNFKQogICAgICAgIGlmIG06CiAgICAgICAgICAgIHJldHVybiBtLmdyb3VwKDEpLnN0cmlwKCkKICAgIHJldHVybiB0ZXh0LnN0cmlwKCkKCgpkZWYgZ2VuZXJhdGVfc3RyYXRlZ3koY2xpZW50X2lkOiBzdHIpIC0+IGRpY3Q6CiAgICAiIiIKICAgIExvYWQgcmVzZWFyY2hfbG9ncywgc2VuZCB0byBDbGF1ZGUsIHNhdmUgZHJhZnRzLgogICAgTmV2ZXIgYnJvd3NlcyB0aGUgd2ViLiBPbmx5IHJlYWRzIERCLCB0aGlua3MsIHdyaXRlcy4KICAgIFJldHVybnMge2RyYWZ0X2lkczogWy4uLl19LgogICAgIiIiCiAgICBsb2cuaW5mbyhmIlN0cmF0ZWdpc3Qgc3RhcnRpbmcgZm9yIGNsaWVudD17Y2xpZW50X2lkfSIpCiAgICBkYiA9IFNlc3Npb25Mb2NhbCgpCiAgICB0cnk6CiAgICAgICAgY2xpZW50ID0gZGIucXVlcnkoQ2xpZW50KS5maWx0ZXIoZnVuYy5sb3dlcihDbGllbnQuY2xpZW50X2lkKSA9PSBjbGllbnRfaWQubG93ZXIoKSkuZmlyc3QoKQogICAgICAgIGlmIG5vdCBjbGllbnQ6CiAgICAgICAgICAgIGxvZy5lcnJvcigiQ2xpZW50IG5vdCBmb3VuZCIpCiAgICAgICAgICAgIHJldHVybiB7fQoKICAgICAgICBjbGllbnRfaWQgPSBjbGllbnQuY2xpZW50X2lkICAjIFVzZSBhY3R1YWwgc3RvcmVkIHZhbHVlIGZvciBEQiB3cml0ZXMKCiAgICAgICAgIyBMb2FkIHJlc2VhcmNoX2xvZ3MsIGlnbm9yZSBsb3cgY29uZmlkZW5jZQogICAgICAgIGxvZ3MgPSAoCiAgICAgICAgICAgIGRiLnF1ZXJ5KFJlc2VhcmNoTG9nKQogICAgICAgICAgICAuZmlsdGVyKAogICAgICAgICAgICAgICAgUmVzZWFyY2hMb2cuY2xpZW50X2lkID09IGNsaWVudF9pZCwKICAgICAgICAgICAgICAgIFJlc2VhcmNoTG9nLmNvbmZpZGVuY2Vfc2NvcmUgPj0gTUlOX0NPTkZJREVOQ0VfRk9SX1NUUkFURUdJU1QsCiAgICAgICAgICAgICkKICAgICAgICAgICAgLm9yZGVyX2J5KFJlc2VhcmNoTG9nLmNvbmZpZGVuY2Vfc2NvcmUuZGVzYygpKQogICAgICAgICAgICAuYWxsKCkKICAgICAgICApCiAgICAgICAgaWYgbm90IGxvZ3M6CiAgICAgICAgICAgIGxvZy53YXJuaW5nKCJObyByZXNlYXJjaF9sb2dzIGFib3ZlIGNvbmZpZGVuY2UgdGhyZXNob2xkIikKICAgICAgICAgICAgcmV0dXJuIHt9CgogICAgICAgIGxvZy5pbmZvKGYiTG9hZGVkIHtsZW4obG9ncyl9IHJlc2VhcmNoIGVudHJpZXMiKQoKICAgICAgICAjIE9wcG9ydHVuaXR5IHNjb3JlciDigJQgcmFua2VkIGVhc3kgd2lucyAoc2F2ZXMgdG8gT3Bwb3J0dW5pdHlTY29yZSkKICAgICAgICBvcHBvcnR1bml0aWVzID0gc2NvcmVfb3Bwb3J0dW5pdGllcyhjbGllbnRfaWQpCiAgICAgICAgc2VydmljZV9mb2N1cyA9IG9wcG9ydHVuaXRpZXNbMF1bInNlcnZpY2UiXSBpZiBvcHBvcnR1bml0aWVzIGVsc2UgImp1bmsgcmVtb3ZhbCIKICAgICAgICBsb2cuaW5mbyhmIlRvcCBvcHBvcnR1bml0eToge3NlcnZpY2VfZm9jdXN9IikKCiAgICAgICAgIyBCdWlsZCBjbGllbnQtZmFjaW5nIGFjdGlvbiBwbGFuIChzdHJhdGVnaWVzIHRhYmxlKQogICAgICAgIGNpdHkgPSAoY2xpZW50LmNpdGllc19zZXJ2ZWQgb3IgWyIiXSlbMF0gaWYgY2xpZW50LmNpdGllc19zZXJ2ZWQgZWxzZSAiIgogICAgICAgIF9zYXZlX3N0cmF0ZWd5KGRiLCBjbGllbnRfaWQsIGNpdHksIG9wcG9ydHVuaXRpZXNbOjVdKQoKICAgICAgICByZXNlYXJjaF9zdW1tYXJ5ID0gW10KICAgICAgICBmb3IgcmwgaW4gbG9nc1s6MTBdOgogICAgICAgICAgICBzID0gcmwuZXh0cmFjdGVkX3NlcnZpY2VzIG9yIFtdCiAgICAgICAgICAgIHAgPSBybC5wcmljaW5nX21lbnRpb25zIG9yIFtdCiAgICAgICAgICAgIGMgPSBybC5jb21wbGFpbnRzIG9yIFtdCiAgICAgICAgICAgIG0gPSBybC5taXNzZWRfb3Bwb3J0dW5pdGllcyBvciBbXQogICAgICAgICAgICByZXNlYXJjaF9zdW1tYXJ5LmFwcGVuZCgKICAgICAgICAgICAgICAgIGYie3JsLmNvbXBldGl0b3JfbmFtZX0gKHtybC5zb3VyY2VfdHlwZX0pOiBzZXJ2aWNlcz17c30sIHByaWNpbmc9e3B9LCBjb21wbGFpbnRzPXtjfSwgZ2Fwcz17bX0iCiAgICAgICAgICAgICkKICAgICAgICByZXNlYXJjaF90ZXh0ID0gIlxuIi5qb2luKHJlc2VhcmNoX3N1bW1hcnkpCgogICAgICAgIHByb21wdCA9IGYiIiJZb3UgYXJlIGEgbWFya2V0aW5nIGNvcHl3cml0ZXIgZm9yIGEgbG9jYWwge2NsaWVudC5idXNpbmVzc19uYW1lfSBidXNpbmVzcy4KClJlc2VhcmNoIG9uIGNvbXBldGl0b3JzIGluIHRoZSBhcmVhOgp7cmVzZWFyY2hfdGV4dH0KCkZvY3VzIG9uIE9ORSB1bmRlcnNlcnZlZCBzZXJ2aWNlIG9yIGdhcDoge3NlcnZpY2VfZm9jdXN9CgpXcml0ZSBleGFjdGx5IDIgcG9zdHM6CjEuICoqR29vZ2xlIEJ1c2luZXNzIFByb2ZpbGUqKjogMTUwLTMwMCB3b3JkcywgbG9jYWwgU0VPIGZyaWVuZGx5LCBpbmNsdWRlIGEgY2xlYXIgQ1RBCjIuICoqRmFjZWJvb2sqKjogODAtMTUwIHdvcmRzLCBlbmdhZ2luZywgc2hhcmVhYmxlCgpUb25lOiB7Y2xpZW50LmJyYW5kX3RvbmV9CkRpZmZlcmVudGlhdG9ycyB0byBlbXBoYXNpemU6IHtjbGllbnQuZGlmZmVyZW50aWF0b3JzIG9yIFsncmVsaWFibGUnLCAnbG9jYWwnLCAndHJhbnNwYXJlbnQnXX0KCkZvcm1hdCB5b3VyIHJlc3BvbnNlIGFzOgojIyBHb29nbGUgQnVzaW5lc3MgUHJvZmlsZQpbeW91ciBwb3N0IGhlcmVdCgojIyBGYWNlYm9vawpbeW91ciBwb3N0IGhlcmVdCiIiIgoKICAgICAgICBNSU5fV09SRFMgPSA1MCAgIyBVc2UgQ2xhdWRlIG9ubHkgaWYgT2xsYW1hIG91dHB1dCBpcyBiZWxvdyB0aGlzCgogICAgICAgICMgMS4gVHJ5IE9sbGFtYSBmaXJzdCAobG9jYWwsIG5vIEFQSSBjb3N0KQogICAgICAgIG91dHB1dCA9IF9jYWxsX29sbGFtYShwcm9tcHQpCiAgICAgICAgZ2JwID0gX2V4dHJhY3RfZHJhZnQob3V0cHV0LCAiR29vZ2xlIEJ1c2luZXNzIFByb2ZpbGUiKSBpZiBvdXRwdXQgZWxzZSAiIgogICAgICAgIGZiID0gX2V4dHJhY3RfZHJhZnQob3V0cHV0LCAiRmFjZWJvb2siKSBpZiBvdXRwdXQgZWxzZSAiIgoKICAgICAgICAjIDIuIEZhbGwgYmFjayB0byBDbGF1ZGUgb25seSBpZiBPbGxhbWEgZmFpbGVkIG9yIG91dHB1dCBpbnN1ZmZpY2llbnQKICAgICAgICBpZiBsZW4oZ2JwLnNwbGl0KCkpIDwgTUlOX1dPUkRTIG9yIGxlbihmYi5zcGxpdCgpKSA8IE1JTl9XT1JEUzoKICAgICAgICAgICAgbG9nLmluZm8oIk9sbGFtYSBvdXRwdXQgaW5zdWZmaWNpZW50IOKAlCB1c2luZyBDbGF1ZGUiKQogICAgICAgICAgICBvdXRwdXQgPSBfY2FsbF9jbGF1ZGUocHJvbXB0KQogICAgICAgICAgICBnYnAgPSBfZXh0cmFjdF9kcmFmdChvdXRwdXQsICJHb29nbGUgQnVzaW5lc3MgUHJvZmlsZSIpIG9yIGdicAogICAgICAgICAgICBmYiA9IF9leHRyYWN0X2RyYWZ0KG91dHB1dCwgIkZhY2Vib29rIikgb3IgZmIKCiAgICAgICAgICAgICMgUmV0cnkgQ2xhdWRlIG9uY2UgaWYgc3RpbGwgdG9vIHNob3J0CiAgICAgICAgICAgIGlmIGxlbihnYnAuc3BsaXQoKSkgPCBNSU5fV09SRFMgb3IgbGVuKGZiLnNwbGl0KCkpIDwgTUlOX1dPUkRTOgogICAgICAgICAgICAgICAgbG9nLndhcm5pbmcoIkNsYXVkZSBvdXRwdXQgPCA1MCB3b3JkcywgcmV0cnlpbmcgb25jZSIpCiAgICAgICAgICAgICAgICBvdXRwdXQgPSBfY2FsbF9jbGF1ZGUocHJvbXB0KQogICAgICAgICAgICAgICAgZ2JwID0gX2V4dHJhY3RfZHJhZnQob3V0cHV0LCAiR29vZ2xlIEJ1c2luZXNzIFByb2ZpbGUiKSBvciBnYnAKICAgICAgICAgICAgICAgIGZiID0gX2V4dHJhY3RfZHJhZnQob3V0cHV0LCAiRmFjZWJvb2siKSBvciBmYgoKICAgICAgICBpZiBsZW4oZ2JwLnNwbGl0KCkpIDwgMjAgb3IgbGVuKGZiLnNwbGl0KCkpIDwgMjA6CiAgICAgICAgICAgIGxvZy5lcnJvcigiQm90aCBPbGxhbWEgYW5kIENsYXVkZSBwcm9kdWNlZCBpbnN1ZmZpY2llbnQgb3V0cHV0LiBObyBkcmFmdHMgc2F2ZWQuIikKICAgICAgICAgICAgcmV0dXJuIHt9CgogICAgICAgIGRyYWZ0X2lkcyA9IFtdCgogICAgICAgIGZvciBwbGF0Zm9ybSwgYm9keSwgY3R5cGUgaW4gWwogICAgICAgICAgICAoImdvb2dsZV9idXNpbmVzcyIsIGdicCwgImdvb2dsZV9idXNpbmVzcyIpLAogICAgICAgICAgICAoImZhY2Vib29rIiwgZmIsICJzb2NpYWwiKSwKICAgICAgICBdOgogICAgICAgICAgICBkcmFmdCA9IENvbnRlbnREcmFmdCgKICAgICAgICAgICAgICAgIGNsaWVudF9pZD1jbGllbnRfaWQsCiAgICAgICAgICAgICAgICB0b3BpYz1zZXJ2aWNlX2ZvY3VzLAogICAgICAgICAgICAgICAgY29udGVudF90eXBlPWN0eXBlLAogICAgICAgICAgICAgICAgcGxhdGZvcm09cGxhdGZvcm0sCiAgICAgICAgICAgICAgICB0aXRsZT1Ob25lLAogICAgICAgICAgICAgICAgYm9keT1ib2R5LAogICAgICAgICAgICAgICAgYm9keV9yZWZpbmVkPWJvZHksCiAgICAgICAgICAgICAgICB3b3JkX2NvdW50PWxlbihib2R5LnNwbGl0KCkpLAogICAgICAgICAgICAgICAgY2hhbmdlX25vdGVzPVtdLAogICAgICAgICAgICAgICAgc3RhdHVzPSJQRU5ESU5HIiwKICAgICAgICAgICAgKQogICAgICAgICAgICBkYi5hZGQoZHJhZnQpCiAgICAgICAgICAgIGRiLmNvbW1pdCgpCiAgICAgICAgICAgIGRyYWZ0X2lkcy5hcHBlbmQoZHJhZnQuaWQpCiAgICAgICAgICAgIGxvZy5pbmZvKGYiU2F2ZWQge3BsYXRmb3JtfSBkcmFmdCAoaWQ9e2RyYWZ0LmlkfSkiKQoKICAgICAgICBsb2cuaW5mbyhmIlN0cmF0ZWdpc3QgZG9uZS4ge2xlbihkcmFmdF9pZHMpfSBkcmFmdHMgc2F2ZWQuIikKICAgICAgICByZXR1cm4geyJkcmFmdF9pZHMiOiBkcmFmdF9pZHN9CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgZGIucm9sbGJhY2soKQogICAgICAgIGxvZy5leGNlcHRpb24oc3RyKGUpKQogICAgICAgIHJhaXNlCiAgICBmaW5hbGx5OgogICAgICAgIGRiLmNsb3NlKCkKCgpkZWYgcnVuX3N0cmF0ZWdpc3QoY2xpZW50X2lkOiBzdHIpIC0+IGRpY3Q6CiAgICAiIiJBbGlhcyBmb3IgZ2VuZXJhdGVfc3RyYXRlZ3kuIiIiCiAgICByZXR1cm4gZ2VuZXJhdGVfc3RyYXRlZ3koY2xpZW50X2lkKQo=',
}

def extract(target: Path):
    for rel, b64 in BUNDLE.items():
        content = base64.b64decode(b64).decode("utf-8") if isinstance(b64, str) else b64
        dst = target / rel
        dst.parent.mkdir(parents=True, exist_ok=True)
        dst.write_text(content, encoding="utf-8")
    (target / "requirements.txt").write_text(
        "python-dotenv>=1.0.0\nsqlalchemy>=2.0.0\nstreamlit>=1.28.0\n"
        "tavily-python>=0.5.0\nfirecrawl-py>=1.0.0\nrequests>=2.28.0\n",
        encoding="utf-8"
    )
    print(f"Extracted to {target}")

def main():
    out = Path.cwd() / "agency_ai_extracted"
    args = sys.argv[1:]
    if args and args[0] == "extract":
        extract(out)
        return 0
    if not (out / "main.py").exists():
        extract(out)
    os.chdir(out)
    sys.path.insert(0, str(out))
    if not args or args[0] in ("run", "start"):
        return subprocess.call([sys.executable, "-m", "streamlit", "run", "app.py"] + (args[1:] or []))
    return subprocess.call([sys.executable, "main.py"] + args)

if __name__ == "__main__":
    sys.exit(main() or 0)
